import{a as Zv,b as Xd,c as Jd,d as Ju,e as Uo,f as ef,g as ec,h as tc,i as Xv,j as nc,k as ue,l as bn,m as Jt,n as rc,o as $r,p as ic,q as sc,r as oc,s as ac,t as Jv,u as Nt,v as ht}from"./chunk-JMZBWWL2.js";import{$ as L,$a as Ku,A as Ge,Aa as bv,B as Dn,Ba as gt,Bb as Zu,Cb as Gv,D as Fd,Da as Gd,Db as Xu,E as Mi,Ea as Cv,Eb as Hv,F as gv,Fa as Hd,Fb as Li,G as Lr,Ga as Sv,Gb as Br,H as Yt,Ha as xo,Hb as Wv,I as Od,Ia as Rv,Ib as Kv,J as mv,Ja as Pv,Jb as Qv,K as $u,Ka as Hu,Kb as jr,L as Ni,La as Oi,Lb as Xt,M as Vd,Ma as Wd,Mb as Ui,N as ki,Na as Mv,Nb as Yv,O as Te,Oa as Yn,P as Ld,Pa as ie,Q as yv,Qa as Nv,R as tt,Ra as Fo,S as re,Sa as kv,T as Wn,Ta as Wu,U as No,Ua as Vi,V as K,Va as Ue,W as Le,Wa as Be,X as _v,Xa as Zn,Y as Q,Ya as xv,Z as Ud,Za as Fv,_ as O,_a as Ov,a as av,aa as vv,ab as Qu,b as uv,ba as Bd,bb as Kd,c as Rt,ca as wv,cb as Oo,d as Nd,da as nt,db as Qd,e as kd,ea as rt,eb as Vv,f as ct,fa as Ev,fb as Lv,g as Pt,ga as Zt,gb as Yu,h as Bu,ha as Tv,hb as Yd,i as cv,ia as Dv,j as Tn,ja as zu,jb as Zd,k as Hn,ka as qu,kb as Ot,l as Or,la as xi,lb as In,m as de,ma as jd,mb as Ur,n as W,na as Kn,nb as Uv,o as Vr,oa as $d,ob as An,p as lv,pb as Bv,q as hv,qa as ko,r as J,ra as Gu,rb as jv,s as ju,sa as Mt,sb as $v,t as pt,ta as De,tb as zv,u as Mo,ua as zd,ub as Vo,v as dv,va as Iv,vb as qv,w as xd,wa as Qn,x as fv,xa as Fi,y as pv,ya as Av,yb as Lo,z as lt,za as qd}from"./chunk-LWLVBJCI.js";import{a as $,b as he,e as Md,f as R}from"./chunk-KT3CPUTC.js";var ke=new Q("");var nw=null;function Et(){return nw}function tf(n){nw??=n}var Bo=class{},jo=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>L(rw),providedIn:"platform"})}return n})(),nf=new Q(""),rw=(()=>{class n extends jo{_location;_history;_doc=L(ke);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Et().getBaseHref(this._doc)}onPopState(t){let r=Et().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Et().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function uc(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function ew(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function Vt(n){return n&&n[0]!=="?"?`?${n}`:n}var Lt=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>L(lc),providedIn:"root"})}return n})(),cc=new Q(""),lc=(()=>{class n extends Lt{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??L(ke).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return uc(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Vt(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+Vt(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+Vt(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(O(jo),O(cc,8))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Xn=(()=>{class n{_subject=new ct;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=Zb(ew(tw(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Vt(r))}normalize(t){return n.stripTrailingSlash(Yb(this._basePath,tw(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Vt(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Vt(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Vt;static joinWithSlash=uc;static stripTrailingSlash=ew;static \u0275fac=function(r){return new(r||n)(O(Lt))};static \u0275prov=K({token:n,factory:()=>Qb(),providedIn:"root"})}return n})();function Qb(){return new Xn(O(Lt))}function Yb(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function tw(n){return n.replace(/\/index.html$/,"")}function Zb(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var rf=(()=>{class n extends Lt{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=uc(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+Vt(s))||this._platformLocation.pathname;this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+Vt(s))||this._platformLocation.pathname;this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(O(jo),O(cc,8))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();var hc=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},fc=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new hc(i.item,this._ngForOf,-1,-1),o===null?void 0:o);else if(o==null)r.remove(s===null?void 0:s);else if(s!==null){let u=r.get(s);r.move(u,o),iw(u,i)}});for(let i=0,s=r.length;i<s;i++){let u=r.get(i).context;u.index=i,u.count=s,u.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let s=r.get(i.currentIndex);iw(s,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(ie(Fo),ie(Wd),ie(Wv))};static \u0275dir=Be({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function iw(n,e){n.context.$implicit=e.item}var Xb=(()=>{class n{_viewContainer;_context=new dc;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){sw(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){sw(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(ie(Fo),ie(Wd))};static \u0275dir=Be({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),dc=class{$implicit=null;ngIf=null};function sw(n,e){if(n&&!n.createEmbeddedView)throw new re(2020,!1)}var $o=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Ue({type:n});static \u0275inj=Le({})}return n})();function zo(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var sf="browser",ow="server";function Jn(n){return n===ow}var zr=class{};var aw=(()=>{class n{static \u0275prov=K({token:n,providedIn:"root",factory:()=>new of(L(ke),window)})}return n})(),of=class{document;window;offset=()=>[0,0];constructor(e,t){this.document=e,this.window=t}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=Jb(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function Jb(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var mc=new Q(""),lf=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new re(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(O(mc),O(De))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),qo=class{_doc;constructor(e){this._doc=e}manager},pc="ng-app-id";function cw(n){for(let e of n)e.remove()}function lw(n,e){let t=e.createElement("style");return t.textContent=n,t}function eC(n,e,t,r){let i=n.head?.querySelectorAll(`style[${pc}="${e}"],link[${pc}="${e}"]`);if(i)for(let s of i)s.removeAttribute(pc),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function uf(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var hf=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=Jn(s),eC(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,lw);r?.forEach(i=>this.addUsage(i,this.external,uf))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(cw(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])cw(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,lw(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,uf(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(pc,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(O(ke),O(qd),O(Gd,8),O(gt))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),af={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},df=/%COMP%/g;var dw="%COMP%",tC=`_nghost-${dw}`,nC=`_ngcontent-${dw}`,rC=!0,iC=new Q("",{providedIn:"root",factory:()=>rC});function sC(n){return nC.replace(df,n)}function oC(n){return tC.replace(df,n)}function fw(n,e){return e.map(t=>t.replace(df,n))}var ff=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,o,u,c,l=null,f=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=u,this.ngZone=c,this.nonce=l,this.tracingService=f,this.platformIsServer=Jn(u),this.defaultRenderer=new Go(t,o,c,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===xo.ShadowDom&&(r=he($({},r),{encapsulation:xo.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof gc?i.applyToHost(t):i instanceof Ho&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,p=this.platformIsServer,m=this.tracingService;switch(r.encapsulation){case xo.Emulated:s=new gc(c,l,r,this.appId,f,o,u,p,m);break;case xo.ShadowDom:return new cf(c,l,t,r,o,u,this.nonce,p,m);default:s=new Ho(c,l,r,f,o,u,p,m);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(O(lf),O(hf),O(qd),O(iC),O(ke),O(gt),O(De),O(Gd),O(Cv,8))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),Go=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,s){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(af[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(hw(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(hw(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new re(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=af[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=af[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Oi.DashCase|Oi.Important)?e.style.setProperty(t,r,i&Oi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Oi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Et().getGlobalEventTarget(this.doc,e),!e))throw new re(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function hw(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var cf=class extends Go{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,s,o,u,c,l){super(e,s,o,c,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let f=i.styles;f=fw(i.id,f);for(let m of f){let w=document.createElement("style");u&&w.setAttribute("nonce",u),w.textContent=m,this.shadowRoot.appendChild(w)}let p=i.getExternalStyles?.();if(p)for(let m of p){let w=uf(m,s);u&&w.setAttribute("nonce",u),this.shadowRoot.appendChild(w)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ho=class extends Go{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,u,c,l){super(e,s,o,u,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let f=r.styles;this.styles=l?fw(l,f):f,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},gc=class extends Ho{contentAttr;hostAttr;constructor(e,t,r,i,s,o,u,c,l){let f=i+"-"+r.id;super(e,t,r,s,o,u,c,l,f),this.contentAttr=sC(f),this.hostAttr=oC(f)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var yc=class n extends Bo{supportsDOMEvents=!0;static makeCurrent(){tf(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=aC();return t==null?null:uC(t)}resetBaseElement(){Wo=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return zo(document.cookie,e)}},Wo=null;function aC(){return Wo=Wo||document.querySelector("base"),Wo?Wo.getAttribute("href"):null}function uC(n){return new URL(n,document.baseURI).pathname}var _c=class{addToWindow(e){Wn.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new re(5103,!1);return s},Wn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Wn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=Wn.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(u=>{u.whenStable(o)})};Wn.frameworkStabilizers||(Wn.frameworkStabilizers=[]),Wn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?Et().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},cC=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),gw=(()=>{class n extends qo{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(O(ke))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),pw=["alt","control","meta","shift"],lC={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},hC={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},mw=(()=>{class n extends qo{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),u=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Et().onAndCancel(t,o.domEventName,u,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",u=r.indexOf("code");if(u>-1&&(r.splice(u,1),o="code."),pw.forEach(l=>{let f=r.indexOf(l);f>-1&&(r.splice(f,1),o+=l+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=lC[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),pw.forEach(o=>{if(o!==i){let u=hC[o];u(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(O(ke))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();function dC(){yc.makeCurrent()}function fC(){return new zd}function pC(){return Av(document),document}var gC=[{provide:gt,useValue:sf},{provide:bv,useValue:dC,multi:!0},{provide:ke,useFactory:pC}],mC=Hv(Kv,"browser",gC);var yC=[{provide:Ku,useClass:_c},{provide:Ov,useClass:Qu,deps:[De,Kd,Ku]},{provide:Qu,useClass:Qu,deps:[De,Kd,Ku]}],_C=[{provide:wv,useValue:"root"},{provide:zd,useFactory:fC},{provide:mc,useClass:gw,multi:!0,deps:[ke]},{provide:mc,useClass:mw,multi:!0,deps:[ke]},ff,hf,lf,{provide:Mv,useExisting:ff},{provide:zr,useClass:cC},[]],vC=(()=>{class n{constructor(){}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Ue({type:n});static \u0275inj=Le({providers:[..._C,...yC],imports:[$o,Qv]})}return n})();var ji=class{},Ko=class{},Ut=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=t.slice(r+1).trim();this.addHeaderEntry(i,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(u=>s.indexOf(u)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var wc=class{encodeKey(e){return yw(e)}encodeValue(e){return yw(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function wC(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,u]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(u),t.set(o,c)}),t}var EC=/%(\d[a-f0-9])/gi,TC={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function yw(n){return encodeURIComponent(n).replace(EC,(e,t)=>TC[t]??e)}function vc(n){return`${n}`}var Cn=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new wc,e.fromString){if(e.fromObject)throw new re(2805,!1);this.map=wC(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(vc):[vc(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(vc(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(vc(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Ec=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function DC(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function _w(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function vw(n){return typeof Blob<"u"&&n instanceof Blob}function ww(n){return typeof FormData<"u"&&n instanceof FormData}function IC(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Ew="Content-Type",Tw="Accept",Iw="X-Request-URL",Aw="text/plain",bw="application/json",AC=`${bw}, ${Aw}, */*`,Bi=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,t,r,i){this.url=t,this.method=e.toUpperCase();let s;if(DC(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Ut,this.context??=new Ec,!this.params)this.params=new Cn,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let u=t.indexOf("?"),c=u===-1?"?":u<t.length-1?"&":"";this.urlWithParams=t+c+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||_w(this.body)||vw(this.body)||ww(this.body)||IC(this.body)?this.body:this.body instanceof Cn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||ww(this.body)?null:vw(this.body)?this.body.type||null:_w(this.body)?null:typeof this.body=="string"?Aw:this.body instanceof Cn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?bw:null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,u=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,f=e.params||this.params,p=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((m,w)=>m.set(w,e.setHeaders[w]),l)),e.setParams&&(f=Object.keys(e.setParams).reduce((m,w)=>m.set(w,e.setParams[w]),f)),new n(t,r,o,{params:f,headers:l,context:p,reportProgress:c,responseType:i,withCredentials:u,transferCache:s})}},qr=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(qr||{}),$i=class{headers;status;statusText;url;ok;type;constructor(e,t=200,r="OK"){this.headers=e.headers||new Ut,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Tc=class n extends $i{constructor(e={}){super(e)}type=qr.ResponseHeader;clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Qo=class n extends $i{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=qr.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Yo=class extends $i{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},bC=200,CC=204;function pf(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var zi=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof Bi)s=t;else{let c;i.headers instanceof Ut?c=i.headers:c=new Ut(i.headers);let l;i.params&&(i.params instanceof Cn?l=i.params:l=new Cn({fromObject:i.params})),s=new Bi(t,r,i.body!==void 0?i.body:null,{headers:c,context:i.context,params:l,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let o=W(s).pipe(Dn(c=>this.handler.handle(c)));if(t instanceof Bi||i.observe==="events")return o;let u=o.pipe(lt(c=>c instanceof Qo));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return u.pipe(J(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new re(2806,!1);return c.body}));case"blob":return u.pipe(J(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new re(2807,!1);return c.body}));case"text":return u.pipe(J(c=>{if(c.body!==null&&typeof c.body!="string")throw new re(2808,!1);return c.body}));case"json":default:return u.pipe(J(c=>c.body))}case"response":return u;default:throw new re(2809,!1)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new Cn().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,pf(i,r))}post(t,r,i={}){return this.request("POST",t,pf(i,r))}put(t,r,i={}){return this.request("PUT",t,pf(i,r))}static \u0275fac=function(r){return new(r||n)(O(ji))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();var SC=new Q("");function Cw(n,e){return e(n)}function RC(n,e){return(t,r)=>e.intercept(t,{handle:i=>n(i,r)})}function PC(n,e,t){return(r,i)=>rt(t,()=>e(r,s=>n(s,i)))}var Sw=new Q(""),mf=new Q(""),Rw=new Q(""),yf=new Q("",{providedIn:"root",factory:()=>!0});function MC(){let n=null;return(e,t)=>{n===null&&(n=(L(Sw,{optional:!0})??[]).reduceRight(RC,Cw));let r=L(ko);if(L(yf)){let s=r.add();return n(e,t).pipe(Lr(()=>r.remove(s)))}else return n(e,t)}}var Dc=(()=>{class n extends ji{backend;injector;chain=null;pendingTasks=L(ko);contributeToStability=L(yf);constructor(t,r){super(),this.backend=t,this.injector=r}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(mf),...this.injector.get(Rw,[])]));this.chain=r.reduceRight((i,s)=>PC(i,s,this.injector),Cw)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(Lr(()=>this.pendingTasks.remove(r)))}else return this.chain(t,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||n)(O(Ko),O(nt))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();var NC=/^\)\]\}',?\n/,kC=RegExp(`^${Iw}:`,"m");function xC(n){return"responseURL"in n&&n.responseURL?n.responseURL:kC.test(n.getAllResponseHeaders())?n.getResponseHeader(Iw):null}var gf=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new re(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?de(r.\u0275loadImpl()):W(null)).pipe(Te(()=>new Rt(s=>{let o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((S,A)=>o.setRequestHeader(S,A.join(","))),t.headers.has(Tw)||o.setRequestHeader(Tw,AC),!t.headers.has(Ew)){let S=t.detectContentTypeHeader();S!==null&&o.setRequestHeader(Ew,S)}if(t.responseType){let S=t.responseType.toLowerCase();o.responseType=S!=="json"?S:"text"}let u=t.serializeBody(),c=null,l=()=>{if(c!==null)return c;let S=o.statusText||"OK",A=new Ut(o.getAllResponseHeaders()),j=xC(o)||t.url;return c=new Tc({headers:A,status:o.status,statusText:S,url:j}),c},f=()=>{let{headers:S,status:A,statusText:j,url:G}=l(),k=null;A!==CC&&(k=typeof o.response>"u"?o.responseText:o.response),A===0&&(A=k?bC:0);let z=A>=200&&A<300;if(t.responseType==="json"&&typeof k=="string"){let Z=k;k=k.replace(NC,"");try{k=k!==""?JSON.parse(k):null}catch(X){k=Z,z&&(z=!1,k={error:X,text:k})}}z?(s.next(new Qo({body:k,headers:S,status:A,statusText:j,url:G||void 0})),s.complete()):s.error(new Yo({error:k,headers:S,status:A,statusText:j,url:G||void 0}))},p=S=>{let{url:A}=l(),j=new Yo({error:S,status:o.status||0,statusText:o.statusText||"Unknown Error",url:A||void 0});s.error(j)},m=!1,w=S=>{m||(s.next(l()),m=!0);let A={type:qr.DownloadProgress,loaded:S.loaded};S.lengthComputable&&(A.total=S.total),t.responseType==="text"&&o.responseText&&(A.partialText=o.responseText),s.next(A)},P=S=>{let A={type:qr.UploadProgress,loaded:S.loaded};S.lengthComputable&&(A.total=S.total),s.next(A)};return o.addEventListener("load",f),o.addEventListener("error",p),o.addEventListener("timeout",p),o.addEventListener("abort",p),t.reportProgress&&(o.addEventListener("progress",w),u!==null&&o.upload&&o.upload.addEventListener("progress",P)),o.send(u),s.next({type:qr.Sent}),()=>{o.removeEventListener("error",p),o.removeEventListener("abort",p),o.removeEventListener("load",f),o.removeEventListener("timeout",p),t.reportProgress&&(o.removeEventListener("progress",w),u!==null&&o.upload&&o.upload.removeEventListener("progress",P)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(r){return new(r||n)(O(zr))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})(),Pw=new Q(""),FC="XSRF-TOKEN",OC=new Q("",{providedIn:"root",factory:()=>FC}),VC="X-XSRF-TOKEN",LC=new Q("",{providedIn:"root",factory:()=>VC}),Zo=class{},UC=(()=>{class n{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=zo(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(r){return new(r||n)(O(ke),O(gt),O(OC))};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();function BC(n,e){let t=n.url.toLowerCase();if(!L(Pw)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=L(Zo).getToken(),i=L(LC);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var _f=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(_f||{});function jC(n,e){return{\u0275kind:n,\u0275providers:e}}function $C(...n){let e=[zi,gf,Dc,{provide:ji,useExisting:Dc},{provide:Ko,useFactory:()=>L(SC,{optional:!0})??L(gf)},{provide:mf,useValue:BC,multi:!0},{provide:Pw,useValue:!0},{provide:Zo,useClass:UC}];for(let t of n)e.push(...t.\u0275providers);return Bd(e)}var Dw=new Q("");function zC(){return jC(_f.LegacyInterceptors,[{provide:Dw,useFactory:MC},{provide:mf,useExisting:Dw,multi:!0}])}var Nw=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(O(ke))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var $w=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(ie(Yn),ie(Qn))};static \u0275dir=Be({type:n})}return n})(),GC=(()=>{class n extends $w{static \u0275fac=(()=>{let t;return function(i){return(t||(t=xi(n)))(i||n)}})();static \u0275dir=Be({type:n,features:[Zn]})}return n})(),zw=new Q("");var HC={provide:zw,useExisting:No(()=>qw),multi:!0};function WC(){let n=Et()?Et().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var KC=new Q(""),qw=(()=>{class n extends $w{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!WC())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(ie(Yn),ie(Qn),ie(KC,8))};static \u0275dir=Be({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&An("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},standalone:!1,features:[Lo([HC]),Zn]})}return n})();function If(n){return n==null||Af(n)===0}function Af(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var bf=new Q(""),Gw=new Q(""),QC=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,kw=class{static min(e){return YC(e)}static max(e){return ZC(e)}static required(e){return Hw(e)}static requiredTrue(e){return XC(e)}static email(e){return JC(e)}static minLength(e){return eS(e)}static maxLength(e){return tS(e)}static pattern(e){return nS(e)}static nullValidator(e){return bc()}static compose(e){return Xw(e)}static composeAsync(e){return eE(e)}};function YC(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function ZC(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function Hw(n){return If(n.value)?{required:!0}:null}function XC(n){return n.value===!0?null:{required:!0}}function JC(n){return If(n.value)||QC.test(n.value)?null:{email:!0}}function eS(n){return e=>{let t=e.value?.length??Af(e.value);return t===null||t===0?null:t<n?{minlength:{requiredLength:n,actualLength:t}}:null}}function tS(n){return e=>{let t=e.value?.length??Af(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function nS(n){if(!n)return bc;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(If(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function bc(n){return null}function Ww(n){return n!=null}function Kw(n){return Oo(n)?de(n):n}function Qw(n){let e={};return n.forEach(t=>{e=t!=null?$($({},e),t):e}),Object.keys(e).length===0?null:e}function Yw(n,e){return e.map(t=>t(n))}function rS(n){return!n.validate}function Zw(n){return n.map(e=>rS(e)?e:t=>e.validate(t))}function Xw(n){if(!n)return null;let e=n.filter(Ww);return e.length==0?null:function(t){return Qw(Yw(t,e))}}function Jw(n){return n!=null?Xw(Zw(n)):null}function eE(n){if(!n)return null;let e=n.filter(Ww);return e.length==0?null:function(t){let r=Yw(t,e).map(Kw);return fv(r).pipe(J(Qw))}}function tE(n){return n!=null?eE(Zw(n)):null}function xw(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function nE(n){return n._rawValidators}function rE(n){return n._rawAsyncValidators}function vf(n){return n?Array.isArray(n)?n:[n]:[]}function Cc(n,e){return Array.isArray(n)?n.includes(e):n===e}function Fw(n,e){let t=vf(e);return vf(n).forEach(i=>{Cc(t,i)||t.push(i)}),t}function Ow(n,e){return vf(e).filter(t=>!Cc(n,t))}var Sc=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Jw(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=tE(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Hi=class extends Sc{name;get formDirective(){return null}get path(){return null}},na=class extends Sc{_parent=null;name=null;valueAccessor=null},Rc=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},iS={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},XO=he($({},iS),{"[class.ng-submitted]":"isSubmitted"}),JO=(()=>{class n extends Rc{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(ie(na,2))};static \u0275dir=Be({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Zd("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Zn]})}return n})(),eV=(()=>{class n extends Rc{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(ie(Hi,10))};static \u0275dir=Be({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Zd("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Zn]})}return n})();var Xo="VALID",Ic="INVALID",qi="PENDING",Jo="DISABLED",er=class{},Pc=class extends er{value;source;constructor(e,t){super(),this.value=e,this.source=t}},ea=class extends er{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},ta=class extends er{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Gi=class extends er{status;source;constructor(e,t){super(),this.status=e,this.source=t}},wf=class extends er{source;constructor(e){super(),this.source=e}},Ef=class extends er{source;constructor(e){super(),this.source=e}};function Cf(n){return(xc(n)?n.validators:n)||null}function sS(n){return Array.isArray(n)?Jw(n):n||null}function Sf(n,e){return(xc(e)?e.asyncValidators:n)||null}function oS(n){return Array.isArray(n)?tE(n):n||null}function xc(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function iE(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new re(1e3,"");if(!r[t])throw new re(1001,"")}function sE(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new re(1002,"")})}var Wi=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Xt(this.statusReactive)}set status(e){Xt(()=>this.statusReactive.set(e))}_status=Ui(()=>this.statusReactive());statusReactive=Fi(void 0);get valid(){return this.status===Xo}get invalid(){return this.status===Ic}get pending(){return this.status==qi}get disabled(){return this.status===Jo}get enabled(){return this.status!==Jo}errors;get pristine(){return Xt(this.pristineReactive)}set pristine(e){Xt(()=>this.pristineReactive.set(e))}_pristine=Ui(()=>this.pristineReactive());pristineReactive=Fi(!0);get dirty(){return!this.pristine}get touched(){return Xt(this.touchedReactive)}set touched(e){Xt(()=>this.touchedReactive.set(e))}_touched=Ui(()=>this.touchedReactive());touchedReactive=Fi(!1);get untouched(){return!this.touched}_events=new ct;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Fw(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Fw(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ow(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ow(e,this._rawAsyncValidators))}hasValidator(e){return Cc(this._rawValidators,e)}hasAsyncValidator(e){return Cc(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(he($({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new ta(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new ta(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(he($({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new ea(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new ea(!0,r))}markAsPending(e={}){this.status=qi;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Gi(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(he($({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Jo,this.errors=null,this._forEachChild(i=>{i.disable(he($({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Pc(this.value,r)),this._events.next(new Gi(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(he($({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Xo,this._forEachChild(r=>{r.enable(he($({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(he($({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Xo||this.status===qi)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Pc(this.value,t)),this._events.next(new Gi(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(he($({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Jo:Xo}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=qi,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=Kw(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Gi(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Mt,this.statusChanges=new Mt}_calculateStatus(){return this._allControlsDisabled()?Jo:this.errors?Ic:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(qi)?qi:this._anyControlsHaveStatus(Ic)?Ic:Xo}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new ea(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new ta(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){xc(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=sS(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=oS(this._rawAsyncValidators)}},Mc=class extends Wi{constructor(e,t,r){super(Cf(t),Sf(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){sE(this,!0,e),Object.keys(e).forEach(r=>{iE(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Tf=class extends Mc{};var oE=new Q("",{providedIn:"root",factory:()=>Rf}),Rf="always";function aS(n,e){return[...e.path,n]}function Vw(n,e,t=Rf){Pf(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),cS(n,e),hS(n,e),lS(n,e),uS(n,e)}function Lw(n,e,t=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),kc(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Nc(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function uS(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Pf(n,e){let t=nE(n);e.validator!==null?n.setValidators(xw(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=rE(n);e.asyncValidator!==null?n.setAsyncValidators(xw(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();Nc(e._rawValidators,i),Nc(e._rawAsyncValidators,i)}function kc(n,e){let t=!1;if(n!==null){if(e.validator!==null){let i=nE(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,n.setValidators(s))}}if(e.asyncValidator!==null){let i=rE(n);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,n.setAsyncValidators(s))}}}let r=()=>{};return Nc(e._rawValidators,r),Nc(e._rawAsyncValidators,r),t}function cS(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&aE(n,e)})}function lS(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&aE(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function aE(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function hS(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function dS(n,e){n==null,Pf(n,e)}function fS(n,e){return kc(n,e)}function pS(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function gS(n){return Object.getPrototypeOf(n.constructor)===GC}function mS(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function yS(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===qw?t=s:gS(s)?r=s:i=s}),i||r||t||null}function _S(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Uw(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Bw(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Ac=class extends Wi{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(Cf(t),Sf(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),xc(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Bw(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Uw(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Uw(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Bw(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var vS=n=>n instanceof Ac;var nV=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=Be({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var uE=new Q("");var wS={provide:Hi,useExisting:No(()=>ES)},ES=(()=>{class n extends Hi{callSetDisabledState;get submitted(){return Xt(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=Ui(()=>this._submittedReactive());_submittedReactive=Fi(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new Mt;constructor(t,r,i){super(),this.callSetDisabledState=i,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(kc(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return Vw(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){Lw(t.control||null,t,!1),_S(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),mS(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new wf(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new Ef(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(Lw(r||null,t),vS(i)&&(Vw(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);dS(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&fS(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Pf(this.form,this),this._oldForm&&kc(this._oldForm,this)}static \u0275fac=function(r){return new(r||n)(ie(bf,10),ie(Gw,10),ie(oE,8))};static \u0275dir=Be({type:n,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&An("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Lo([wS]),Zn,Zt]})}return n})();var TS={provide:na,useExisting:No(()=>DS)},DS=(()=>{class n extends na{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(t){}model;update=new Mt;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(t,r,i,s,o){super(),this._ngModelWarningConfig=o,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=yS(this,s)}ngOnChanges(t){this._added||this._setUpControl(),pS(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return aS(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(r){return new(r||n)(ie(Hi,13),ie(bf,10),ie(Gw,10),ie(zw,10),ie(uE,8))};static \u0275dir=Be({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Lo([TS]),Zn,Zt]})}return n})();var IS=(()=>{class n{_validator=bc;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):bc,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Be({type:n,features:[Zt]})}return n})();var AS={provide:bf,useExisting:No(()=>bS),multi:!0};var bS=(()=>{class n extends IS{required;inputName="required";normalizeInput=jr;createValidator=t=>Hw;enabled(t){return t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=xi(n)))(i||n)}})();static \u0275dir=Be({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&Yu("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Lo([AS]),Zn]})}return n})();var CS=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Ue({type:n});static \u0275inj=Le({})}return n})(),Df=class extends Wi{constructor(e,t,r){super(Cf(t),Sf(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){sE(this,!1,e),e.forEach((r,i)=>{iE(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function jw(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var rV=(()=>{class n{useNonNullable=!1;get nonNullable(){let t=new n;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),s={};return jw(r)?s=r:r!==null&&(s.validators=r.validator,s.asyncValidators=r.asyncValidator),new Mc(i,s)}record(t,r=null){let i=this._reduceControls(t);return new Tf(i,r)}control(t,r,i){let s={};return this.useNonNullable?(jw(r)?s=r:(s.validators=r,s.asyncValidators=i),new Ac(t,he($({},s),{nonNullable:!0}))):new Ac(t,r,i)}array(t,r,i){let s=t.map(o=>this._createControl(o));return new Df(s,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof Ac)return t;if(t instanceof Wi)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,s=t.length>2?t[2]:null;return this.control(r,i,s)}else return this.control(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var cE=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:uE,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:oE,useValue:t.callSetDisabledState??Rf}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Ue({type:n});static \u0275inj=Le({imports:[CS]})}return n})();var te="primary",ga=Symbol("RouteTitle"),Ff=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Wr(n){return new Ff(n)}function yE(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],u=n[s];if(o[0]===":")i[o.substring(1)]=u;else if(o!==u.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function SS(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!en(n[t],e[t]))return!1;return!0}function en(n,e){let t=n?Of(n):void 0,r=e?Of(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!_E(n[i],e[i]))return!1;return!0}function Of(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function _E(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function vE(n){return n.length>0?n[n.length-1]:null}function sr(n){return lv(n)?n:Oo(n)?de(Promise.resolve(n)):W(n)}var RS={exact:EE,subset:TE},wE={exact:PS,subset:MS,ignored:()=>!0};function lE(n,e,t){return RS[t.paths](n.root,e.root,t.matrixParams)&&wE[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function PS(n,e){return en(n,e)}function EE(n,e,t){if(!Gr(n.segments,e.segments)||!Vc(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!EE(n.children[r],e.children[r],t))return!1;return!0}function MS(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>_E(n[t],e[t]))}function TE(n,e,t){return DE(n,e,e.segments,t)}function DE(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Gr(i,t)||e.hasChildren()||!Vc(i,t,r))}else if(n.segments.length===t.length){if(!Gr(n.segments,t)||!Vc(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!TE(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Gr(n.segments,i)||!Vc(n.segments,i,r)||!n.children[te]?!1:DE(n.children[te],e,s,r)}}function Vc(n,e,t){return e.every((r,i)=>wE[t](n[i].parameters,r.parameters))}var nn=class{root;queryParams;fragment;_queryParamMap;constructor(e=new fe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Wr(this.queryParams),this._queryParamMap}toString(){return xS.serialize(this)}},fe=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Lc(this)}},tr=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Wr(this.parameters),this._parameterMap}toString(){return AE(this)}};function NS(n,e){return Gr(n,e)&&n.every((t,r)=>en(t.parameters,e[r].parameters))}function Gr(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function kS(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===te&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==te&&(t=t.concat(e(i,r)))}),t}var Kr=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>new nr,providedIn:"root"})}return n})(),nr=class{parse(e){let t=new Lf(e);return new nn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${ra(e.root,!0)}`,r=VS(e.queryParams),i=typeof e.fragment=="string"?`#${FS(e.fragment)}`:"";return`${t}${r}${i}`}},xS=new nr;function Lc(n){return n.segments.map(e=>AE(e)).join("/")}function ra(n,e){if(!n.hasChildren())return Lc(n);if(e){let t=n.children[te]?ra(n.children[te],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==te&&r.push(`${i}:${ra(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=kS(n,(r,i)=>i===te?[ra(n.children[te],!1)]:[`${i}:${ra(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[te]!=null?`${Lc(n)}/${t[0]}`:`${Lc(n)}/(${t.join("//")})`}}function IE(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Fc(n){return IE(n).replace(/%3B/gi,";")}function FS(n){return encodeURI(n)}function Vf(n){return IE(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Uc(n){return decodeURIComponent(n)}function hE(n){return Uc(n.replace(/\+/g,"%20"))}function AE(n){return`${Vf(n.path)}${OS(n.parameters)}`}function OS(n){return Object.entries(n).map(([e,t])=>`;${Vf(e)}=${Vf(t)}`).join("")}function VS(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Fc(t)}=${Fc(i)}`).join("&"):`${Fc(t)}=${Fc(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var LS=/^[^\/()?;#]+/;function Mf(n){let e=n.match(LS);return e?e[0]:""}var US=/^[^\/()?;=#]+/;function BS(n){let e=n.match(US);return e?e[0]:""}var jS=/^[^=?&#]+/;function $S(n){let e=n.match(jS);return e?e[0]:""}var zS=/^[^&#]+/;function qS(n){let e=n.match(zS);return e?e[0]:""}var Lf=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new fe([],{}):new fe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[te]=new fe(e,t)),r}parseSegment(){let e=Mf(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new re(4009,!1);return this.capture(e),new tr(Uc(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=BS(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Mf(this.remaining);i&&(r=i,this.capture(r))}e[Uc(t)]=Uc(r)}parseQueryParam(e){let t=$S(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=qS(this.remaining);o&&(r=o,this.capture(r))}let i=hE(t),s=hE(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Mf(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new re(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=te);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[te]:new fe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new re(4011,!1)}};function bE(n){return n.segments.length>0?new fe([],{[te]:n}):n}function CE(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=CE(i);if(r===te&&s.segments.length===0&&s.hasChildren())for(let[o,u]of Object.entries(s.children))e[o]=u;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new fe(n.segments,e);return GS(t)}function GS(n){if(n.numberOfChildren===1&&n.children[te]){let e=n.children[te];return new fe(n.segments.concat(e.segments),e.children)}return n}function rr(n){return n instanceof nn}function SE(n,e,t=null,r=null){let i=RE(n);return PE(i,e,t,r)}function RE(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let u=new fe(s.url,o);return s===n&&(e=u),u}let r=t(n.root),i=bE(r);return e??i}function PE(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Nf(i,i,i,t,r);let s=HS(e);if(s.toRoot())return Nf(i,i,new fe([],{}),t,r);let o=WS(s,i,n),u=o.processChildren?sa(o.segmentGroup,o.index,s.commands):NE(o.segmentGroup,o.index,s.commands);return Nf(i,o.segmentGroup,u,t,r)}function jc(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function aa(n){return typeof n=="object"&&n!=null&&n.outlets}function Nf(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`});let o;n===e?o=t:o=ME(n,e,t);let u=bE(CE(o));return new nn(u,s,i)}function ME(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=ME(s,e,t)}),new fe(n.segments,r)}var $c=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&jc(r[0]))throw new re(4003,!1);let i=r.find(aa);if(i&&i!==vE(r))throw new re(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function HS(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new $c(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let u={};return Object.entries(s.outlets).forEach(([c,l])=>{u[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:u}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((u,c)=>{c==0&&u==="."||(c==0&&u===""?t=!0:u===".."?e++:u!=""&&i.push(u))}),i):[...i,s]},[]);return new $c(t,e,r)}var Yi=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function WS(n,e,t){if(n.isAbsolute)return new Yi(e,!0,0);if(!t)return new Yi(e,!1,NaN);if(t.parent===null)return new Yi(t,!0,0);let r=jc(n.commands[0])?0:1,i=t.segments.length-1+r;return KS(t,i,n.numberOfDoubleDots)}function KS(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new re(4005,!1);i=r.segments.length}return new Yi(r,!1,i-s)}function QS(n){return aa(n[0])?n[0].outlets:{[te]:n}}function NE(n,e,t){if(n??=new fe([],{}),n.segments.length===0&&n.hasChildren())return sa(n,e,t);let r=YS(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new fe(n.segments.slice(0,r.pathIndex),{});return s.children[te]=new fe(n.segments.slice(r.pathIndex),n.children),sa(s,0,i)}else return r.match&&i.length===0?new fe(n.segments,{}):r.match&&!n.hasChildren()?Uf(n,e,t):r.match?sa(n,0,i):Uf(n,e,t)}function sa(n,e,t){if(t.length===0)return new fe(n.segments,{});{let r=QS(t),i={};if(Object.keys(r).some(s=>s!==te)&&n.children[te]&&n.numberOfChildren===1&&n.children[te].segments.length===0){let s=sa(n.children[te],e,t);return new fe(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=NE(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new fe(n.segments,i)}}function YS(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],u=t[r];if(aa(u))break;let c=`${u}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!fE(c,l,o))return s;r+=2}else{if(!fE(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Uf(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(aa(s)){let c=ZS(s.outlets);return new fe(r,c)}if(i===0&&jc(t[0])){let c=n.segments[e];r.push(new tr(c.path,dE(t[0]))),i++;continue}let o=aa(s)?s.outlets[te]:`${s}`,u=i<t.length-1?t[i+1]:null;o&&u&&jc(u)?(r.push(new tr(o,dE(u))),i+=2):(r.push(new tr(o,{})),i++)}return new fe(r,{})}function ZS(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Uf(new fe([],{}),0,r))}),e}function dE(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function fE(n,e,t){return n==t.path&&en(e,t.parameters)}var Bc="imperative",$e=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}($e||{}),Dt=class{id;url;constructor(e,t){this.id=e,this.url=t}},ir=class extends Dt{type=$e.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},It=class extends Dt{urlAfterRedirects;type=$e.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},mt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(mt||{}),Xi=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Xi||{}),tn=class extends Dt{reason;code;type=$e.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},rn=class extends Dt{reason;code;type=$e.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},Ji=class extends Dt{error;target;type=$e.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},ua=class extends Dt{urlAfterRedirects;state;type=$e.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},zc=class extends Dt{urlAfterRedirects;state;type=$e.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qc=class extends Dt{urlAfterRedirects;state;shouldActivate;type=$e.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Gc=class extends Dt{urlAfterRedirects;state;type=$e.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Hc=class extends Dt{urlAfterRedirects;state;type=$e.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Wc=class{route;type=$e.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Kc=class{route;type=$e.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Qc=class{snapshot;type=$e.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yc=class{snapshot;type=$e.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Zc=class{snapshot;type=$e.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Xc=class{snapshot;type=$e.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},es=class{routerEvent;position;anchor;type=$e.Scroll;constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},ca=class{},ts=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function XS(n,e){return n.providers&&!n._injector&&(n._injector=Wu(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Bt(n){return n.outlet||te}function JS(n,e){let t=n.filter(r=>Bt(r)===e);return t.push(...n.filter(r=>Bt(r)!==e)),t}function ma(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Jc=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return ma(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Qr(this.rootInjector)}},Qr=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Jc(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(O(nt))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),el=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Bf(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Bf(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=jf(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return jf(e,this._root).map(t=>t.value)}};function Bf(n,e){if(n===e.value)return e;for(let t of e.children){let r=Bf(n,t);if(r)return r}return null}function jf(n,e){if(n===e.value)return[e];for(let t of e.children){let r=jf(n,t);if(r.length)return r.unshift(e),r}return[]}var Tt=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Qi(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var la=class extends el{snapshot;constructor(e,t){super(e),this.snapshot=t,Qf(this,e)}toString(){return this.snapshot.toString()}};function kE(n){let e=eR(n),t=new Pt([new tr("",{})]),r=new Pt({}),i=new Pt({}),s=new Pt({}),o=new Pt(""),u=new Sn(t,r,s,o,i,te,n,e.root);return u.snapshot=e.root,new la(new Tt(u,[]),e)}function eR(n){let e={},t={},r={},i="",s=new Hr([],e,r,i,t,te,n,null,{});return new ha("",new Tt(s,[]))}var Sn=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,u,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=u,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(J(l=>l[ga]))??W(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(J(e=>Wr(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(J(e=>Wr(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function tl(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:$($({},e.params),n.params),data:$($({},e.data),n.data),resolve:$($($($({},n.data),e.data),i?.data),n._resolvedData)}:r={params:$({},n.params),data:$({},n.data),resolve:$($({},n.data),n._resolvedData??{})},i&&FE(i)&&(r.resolve[ga]=i.title),r}var Hr=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[ga]}constructor(e,t,r,i,s,o,u,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=u,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Wr(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Wr(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ha=class extends el{url;constructor(e,t){super(t),this.url=e,Qf(this,t)}toString(){return xE(this._root)}};function Qf(n,e){e.value._routerState=n,e.children.forEach(t=>Qf(n,t))}function xE(n){let e=n.children.length>0?` { ${n.children.map(xE).join(", ")} } `:"";return`${n.value}${e}`}function kf(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,en(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),en(e.params,t.params)||n.paramsSubject.next(t.params),SS(e.url,t.url)||n.urlSubject.next(t.url),en(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function $f(n,e){let t=en(n.params,e.params)&&NS(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||$f(n.parent,e.parent))}function FE(n){return typeof n.title=="string"||n.title===null}var OE=new Q(""),Yf=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=te;activateEvents=new Mt;deactivateEvents=new Mt;attachEvents=new Mt;detachEvents=new Mt;routerOutletData=Iv(void 0);parentContexts=L(Qr);location=L(Fo);changeDetector=L(Br);inputBinder=L(ya,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new re(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new re(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new re(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new re(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new zf(t,u,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Be({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Zt]})}return n})(),zf=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Sn?this.route:e===Qr?this.childContexts:e===OE?this.outletData:this.parent.get(e,t)}},ya=new Q(""),Zf=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=ju([r.queryParams,r.params,r.data]).pipe(Te(([s,o,u],c)=>(u=$($($({},s),o),u),c===0?W(u):Promise.resolve(u)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let o=Yv(r.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:u}of o.inputs)t.activatedComponentRef.setInput(u,s[u])});this.outletDataSubscriptions.set(t,i)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();function tR(n,e,t){let r=da(n,e._root,t?t._root:void 0);return new la(r,e)}function da(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=nR(n,e,t);return new Tt(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(u=>da(n,u)),o}}let r=rR(e.value),i=e.children.map(s=>da(n,s));return new Tt(r,i)}}function nR(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return da(n,r,i);return da(n,r)})}function rR(n){return new Sn(new Pt(n.url),new Pt(n.params),new Pt(n.queryParams),new Pt(n.fragment),new Pt(n.data),n.outlet,n.component,n)}var ns=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},VE="ngNavigationCancelingError";function nl(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=rr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=LE(!1,mt.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function LE(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[VE]=!0,t.cancellationCode=e,t}function iR(n){return UE(n)&&rr(n.url)}function UE(n){return!!n&&n[VE]}var sR=(n,e,t,r)=>J(i=>(new qf(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),qf=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),kf(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Qi(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Qi(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),u=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Qi(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Qi(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Xc(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Yc(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(kf(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(u.contexts),o.attachRef=u.componentRef,o.route=u.route.value,o.outlet&&o.outlet.attach(u.componentRef,u.route.value),kf(u.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},rl=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Zi=class{component;route;constructor(e,t){this.component=e,this.route=t}};function oR(n,e,t){let r=n._root,i=e?e._root:null;return ia(r,i,t,[r.value])}function aR(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function is(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!_v(n)?n:e.get(n):r}function ia(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Qi(e);return n.children.forEach(o=>{uR(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,u])=>oa(u,t.getContext(o),i)),i}function uR(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=cR(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new rl(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?ia(n,e,u?u.children:null,r,i):ia(n,e,t,r,i),c&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new Zi(u.outlet.component,o))}else o&&oa(e,u,i),i.canActivateChecks.push(new rl(r)),s.component?ia(n,null,u?u.children:null,r,i):ia(n,null,t,r,i);return i}function cR(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Gr(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Gr(n.url,e.url)||!en(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!$f(n,e)||!en(n.queryParams,e.queryParams);case"paramsChange":default:return!$f(n,e)}}function oa(n,e,t){let r=Qi(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?oa(o,e.children.getContext(s),t):oa(o,null,t):oa(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Zi(e.outlet.component,i)):t.canDeactivateChecks.push(new Zi(null,i)):t.canDeactivateChecks.push(new Zi(null,i))}function _a(n){return typeof n=="function"}function lR(n){return typeof n=="boolean"}function hR(n){return n&&_a(n.canLoad)}function dR(n){return n&&_a(n.canActivate)}function fR(n){return n&&_a(n.canActivateChild)}function pR(n){return n&&_a(n.canDeactivate)}function gR(n){return n&&_a(n.canMatch)}function BE(n){return n instanceof hv||n?.name==="EmptyError"}var Oc=Symbol("INITIAL_VALUE");function rs(){return Te(n=>ju(n.map(e=>e.pipe(Mi(1),ki(Oc)))).pipe(J(e=>{for(let t of e)if(t!==!0){if(t===Oc)return Oc;if(t===!1||mR(t))return t}return!0}),lt(e=>e!==Oc),Mi(1)))}function mR(n){return rr(n)||n instanceof ns}function yR(n,e){return pt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?W(he($({},t),{guardsResult:!0})):_R(o,r,i,n).pipe(pt(u=>u&&lR(u)?vR(r,s,n,e):W(u)),J(u=>he($({},t),{guardsResult:u})))})}function _R(n,e,t,r){return de(n).pipe(pt(i=>IR(i.component,i.route,t,e,r)),Yt(i=>i!==!0,!0))}function vR(n,e,t,r){return de(e).pipe(Dn(i=>dv(ER(i.route.parent,r),wR(i.route,r),DR(n,i.path,t),TR(n,i.route,t))),Yt(i=>i!==!0,!0))}function wR(n,e){return n!==null&&e&&e(new Zc(n)),W(!0)}function ER(n,e){return n!==null&&e&&e(new Qc(n)),W(!0)}function TR(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return W(!0);let i=r.map(s=>xd(()=>{let o=ma(e)??t,u=is(s,o),c=dR(u)?u.canActivate(e,n):rt(o,()=>u(e,n));return sr(c).pipe(Yt())}));return W(i).pipe(rs())}function DR(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>aR(o)).filter(o=>o!==null).map(o=>xd(()=>{let u=o.guards.map(c=>{let l=ma(o.node)??t,f=is(c,l),p=fR(f)?f.canActivateChild(r,n):rt(l,()=>f(r,n));return sr(p).pipe(Yt())});return W(u).pipe(rs())}));return W(s).pipe(rs())}function IR(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return W(!0);let o=s.map(u=>{let c=ma(e)??i,l=is(u,c),f=pR(l)?l.canDeactivate(n,e,t,r):rt(c,()=>l(n,e,t,r));return sr(f).pipe(Yt())});return W(o).pipe(rs())}function AR(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return W(!0);let s=i.map(o=>{let u=is(o,n),c=hR(u)?u.canLoad(e,t):rt(n,()=>u(e,t));return sr(c)});return W(s).pipe(rs(),jE(r))}function jE(n){return uv(tt(e=>{if(typeof e!="boolean")throw nl(n,e)}),J(e=>e===!0))}function bR(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return W(!0);let s=i.map(o=>{let u=is(o,n),c=gR(u)?u.canMatch(e,t):rt(n,()=>u(e,t));return sr(c)});return W(s).pipe(rs(),jE(r))}var fa=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},pa=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Ki(n){return Vr(new fa(n))}function CR(n){return Vr(new re(4e3,!1))}function SR(n){return Vr(LE(!1,mt.GuardRejected))}var Gf=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return W(r);if(i.numberOfChildren>1||!i.children[te])return CR(`${e.redirectTo}`);i=i.children[te]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let u=t,{queryParams:c,fragment:l,routeConfig:f,url:p,outlet:m,params:w,data:P,title:S}=i,A=rt(s,()=>u({params:w,data:P,queryParams:c,fragment:l,routeConfig:f,url:p,outlet:m,title:S}));if(A instanceof nn)throw new pa(A);t=A}let o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new pa(o);return o}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new nn(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let u=s.substring(1);r[i]=t[u]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([u,c])=>{o[u]=this.createSegmentGroup(e,c,r,i)}),new fe(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new re(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Hf={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function RR(n,e,t,r,i){let s=$E(n,e,t);return s.matched?(r=XS(e,r),bR(r,e,t,i).pipe(J(o=>o===!0?s:$({},Hf)))):W(s)}function $E(n,e,t){if(e.path==="**")return PR(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?$({},Hf):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||yE)(t,n,e);if(!i)return $({},Hf);let s={};Object.entries(i.posParams??{}).forEach(([u,c])=>{s[u]=c.path});let o=i.consumed.length>0?$($({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function PR(n){return{matched:!0,parameters:n.length>0?vE(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function pE(n,e,t,r){return t.length>0&&kR(n,t,r)?{segmentGroup:new fe(e,NR(r,new fe(t,n.children))),slicedSegments:[]}:t.length===0&&xR(n,t,r)?{segmentGroup:new fe(n.segments,MR(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new fe(n.segments,n.children),slicedSegments:t}}function MR(n,e,t,r){let i={};for(let s of t)if(sl(n,e,s)&&!r[Bt(s)]){let o=new fe([],{});i[Bt(s)]=o}return $($({},r),i)}function NR(n,e){let t={};t[te]=e;for(let r of n)if(r.path===""&&Bt(r)!==te){let i=new fe([],{});t[Bt(r)]=i}return t}function kR(n,e,t){return t.some(r=>sl(n,e,r)&&Bt(r)!==te)}function xR(n,e,t){return t.some(r=>sl(n,e,r))}function sl(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function FR(n,e,t){return e.length===0&&!n.children[t]}var Wf=class{};function OR(n,e,t,r,i,s,o="emptyOnly"){return new Kf(n,e,t,r,i,o,s).recognize()}var VR=31,Kf=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,u){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=u,this.applyRedirects=new Gf(this.urlSerializer,this.urlTree)}noMatchError(e){return new re(4002,`'${e.segmentGroup}'`)}recognize(){let e=pE(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(J(({children:t,rootSnapshot:r})=>{let i=new Tt(r,t),s=new ha("",i),o=SE(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){let t=new Hr([],Object.freeze({}),Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),te,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,te,t).pipe(J(r=>({children:r,rootSnapshot:t})),Ge(r=>{if(r instanceof pa)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof fa?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(J(o=>o instanceof Tt?[o]:[]))}processChildren(e,t,r,i){let s=[];for(let o of Object.keys(r.children))o==="primary"?s.unshift(o):s.push(o);return de(s).pipe(Dn(o=>{let u=r.children[o],c=JS(t,o);return this.processSegmentGroup(e,c,u,o,i)}),Ni((o,u)=>(o.push(...u),o)),Fd(null),mv(),pt(o=>{if(o===null)return Ki(r);let u=zE(o);return LR(u),W(u)}))}processSegment(e,t,r,i,s,o,u){return de(t).pipe(Dn(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,u).pipe(Ge(l=>{if(l instanceof fa)return W(null);throw l}))),Yt(c=>!!c),Ge(c=>{if(BE(c))return FR(r,i,s)?W(new Wf):Ki(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,o,u,c){return Bt(r)!==o&&(o===te||!sl(i,s,r))?Ki(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o,c):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c):Ki(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,u){let{matched:c,parameters:l,consumedSegments:f,positionalParamSegments:p,remainingSegments:m}=$E(t,i,s);if(!c)return Ki(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>VR&&(this.allowRedirects=!1));let w=new Hr(s,l,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,gE(i),Bt(i),i.component??i._loadedComponent??null,i,mE(i)),P=tl(w,u,this.paramsInheritanceStrategy);w.params=Object.freeze(P.params),w.data=Object.freeze(P.data);let S=this.applyRedirects.applyRedirectCommands(f,i.redirectTo,p,w,e);return this.applyRedirects.lineralizeSegments(i,S).pipe(pt(A=>this.processSegment(e,r,t,A.concat(m),o,!1,u)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let u=RR(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),u.pipe(Te(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Te(({routes:l})=>{let f=r._loadedInjector??e,{parameters:p,consumedSegments:m,remainingSegments:w}=c,P=new Hr(m,p,Object.freeze($({},this.urlTree.queryParams)),this.urlTree.fragment,gE(r),Bt(r),r.component??r._loadedComponent??null,r,mE(r)),S=tl(P,o,this.paramsInheritanceStrategy);P.params=Object.freeze(S.params),P.data=Object.freeze(S.data);let{segmentGroup:A,slicedSegments:j}=pE(t,m,w,l);if(j.length===0&&A.hasChildren())return this.processChildren(f,l,A,P).pipe(J(k=>new Tt(P,k)));if(l.length===0&&j.length===0)return W(new Tt(P,[]));let G=Bt(r)===s;return this.processSegment(f,l,A,j,G?te:s,!0,P).pipe(J(k=>new Tt(P,k instanceof Tt?[k]:[])))}))):Ki(t)))}getChildConfig(e,t,r){return t.children?W({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?W({routes:t._loadedRoutes,injector:t._loadedInjector}):AR(e,t,r,this.urlSerializer).pipe(pt(i=>i?this.configLoader.loadChildren(e,t).pipe(tt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):SR(t))):W({routes:[],injector:e})}};function LR(n){n.sort((e,t)=>e.value.outlet===te?-1:t.value.outlet===te?1:e.value.outlet.localeCompare(t.value.outlet))}function UR(n){let e=n.value.routeConfig;return e&&e.path===""}function zE(n){let e=[],t=new Set;for(let r of n){if(!UR(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=zE(r.children);e.push(new Tt(r.value,i))}return e.filter(r=>!t.has(r))}function gE(n){return n.data||{}}function mE(n){return n.resolve||{}}function BR(n,e,t,r,i,s){return pt(o=>OR(n,e,t,r,o.extractedUrl,i,s).pipe(J(({state:u,tree:c})=>he($({},o),{targetSnapshot:u,urlAfterRedirects:c}))))}function jR(n,e){return pt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return W(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of qE(c))o.add(l);let u=0;return de(o).pipe(Dn(c=>s.has(c)?$R(c,r,n,e):(c.data=tl(c,c.parent,n).resolve,W(void 0))),tt(()=>u++),Od(1),pt(c=>u===o.size?W(t):Tn))})}function qE(n){let e=n.children.map(t=>qE(t)).flat();return[n,...e]}function $R(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!FE(i)&&(s[ga]=i.title),zR(s,n,e,r).pipe(J(o=>(n._resolvedData=o,n.data=tl(n,n.parent,t).resolve,null)))}function zR(n,e,t,r){let i=Of(n);if(i.length===0)return W({});let s={};return de(i).pipe(pt(o=>qR(n[o],e,t,r).pipe(Yt(),tt(u=>{if(u instanceof ns)throw nl(new nr,u);s[o]=u}))),Od(1),J(()=>s),Ge(o=>BE(o)?Tn:Vr(o)))}function qR(n,e,t,r){let i=ma(e)??r,s=is(n,i),o=s.resolve?s.resolve(e,t):rt(i,()=>s(e,t));return sr(o)}function xf(n){return Te(e=>{let t=n(e);return t?de(t).pipe(J(()=>e)):W(e)})}var Xf=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===te);return r}getResolvedTitleForRoute(t){return t.data[ga]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>L(GE),providedIn:"root"})}return n})(),GE=(()=>{class n extends Xf{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(O(Nw))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Yr=new Q("",{providedIn:"root",factory:()=>({})}),Jf=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Vi({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&Ur(0,"router-outlet")},dependencies:[Yf],encapsulation:2})}return n})();function ep(n){let e=n.children&&n.children.map(ep),t=e?he($({},n),{children:e}):$({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==te&&(t.component=Jf),t}var ss=new Q(""),ol=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=L(Xu);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return W(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=sr(t.loadComponent()).pipe(J(WE),tt(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Lr(()=>{this.componentLoaders.delete(t)})),i=new kd(r,()=>new ct).pipe(Nd());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return W({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=HE(r,this.compiler,t,this.onLoadEndListener).pipe(Lr(()=>{this.childrenLoaders.delete(r)})),o=new kd(s,()=>new ct).pipe(Nd());return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function HE(n,e,t,r){return sr(n.loadChildren()).pipe(J(WE),pt(i=>i instanceof kv||Array.isArray(i)?W(i):de(e.compileModuleAsync(i))),J(i=>{r&&r(n);let s,o,u=!1;return Array.isArray(i)?(o=i,u=!0):(s=i.create(t).injector,o=s.get(ss,[],{optional:!0,self:!0}).flat()),{routes:o.map(ep),injector:s}}))}function GR(n){return n&&typeof n=="object"&&"default"in n}function WE(n){return GR(n)?n.default:n}var al=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>L(HR),providedIn:"root"})}return n})(),HR=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),tp=new Q(""),np=new Q("");function KE(n,e,t){let r=n.get(np),i=n.get(ke);return n.get(De).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),u=i.startViewTransition(()=>(s(),WR(n))),{onViewTransitionCreated:c}=r;return c&&rt(n,()=>c({transition:u,from:e,to:t})),o})}function WR(n){return new Promise(e=>{Sv({read:()=>setTimeout(e)},{injector:n})})}var rp=new Q(""),ul=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new ct;transitionAbortSubject=new ct;configLoader=L(ol);environmentInjector=L(nt);destroyRef=L($d);urlSerializer=L(Kr);rootContexts=L(Qr);location=L(Xn);inputBindingEnabled=L(ya,{optional:!0})!==null;titleStrategy=L(Xf);options=L(Yr,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=L(al);createViewTransition=L(tp,{optional:!0});navigationErrorHandler=L(rp,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>W(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new Wc(i)),r=i=>this.events.next(new Kc(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(he($({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))}setupNavigations(t){return this.transitions=new Pt(null),this.transitions.pipe(lt(r=>r!==null),Te(r=>{let i=!1,s=!1;return W(r).pipe(Te(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",mt.SupersededByNewNavigation),Tn;this.currentTransition=r,this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?he($({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),c=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&c!=="reload"){let l="";return this.events.next(new rn(o.id,this.urlSerializer.serialize(o.rawUrl),l,Xi.IgnoredSameUrlNavigation)),o.resolve(!1),Tn}if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return W(o).pipe(Te(l=>(this.events.next(new ir(l.id,this.urlSerializer.serialize(l.extractedUrl),l.source,l.restoredState)),l.id!==this.navigationId?Tn:Promise.resolve(l))),BR(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),tt(l=>{r.targetSnapshot=l.targetSnapshot,r.urlAfterRedirects=l.urlAfterRedirects,this.currentNavigation=he($({},this.currentNavigation),{finalUrl:l.urlAfterRedirects});let f=new ua(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:l,extractedUrl:f,source:p,restoredState:m,extras:w}=o,P=new ir(l,this.urlSerializer.serialize(f),p,m);this.events.next(P);let S=kE(this.rootComponentType).snapshot;return this.currentTransition=r=he($({},o),{targetSnapshot:S,urlAfterRedirects:f,extras:he($({},w),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,W(r)}else{let l="";return this.events.next(new rn(o.id,this.urlSerializer.serialize(o.extractedUrl),l,Xi.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Tn}}),tt(o=>{let u=new zc(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(u)}),J(o=>(this.currentTransition=r=he($({},o),{guards:oR(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),yR(this.environmentInjector,o=>this.events.next(o)),tt(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw nl(this.urlSerializer,o.guardsResult);let u=new qc(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(u)}),lt(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",mt.GuardRejected),!1)),xf(o=>{if(o.guards.canActivateChecks.length!==0)return W(o).pipe(tt(u=>{let c=new Gc(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}),Te(u=>{let c=!1;return W(u).pipe(jR(this.paramsInheritanceStrategy,this.environmentInjector),tt({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(u,"",mt.NoDataFromResolver)}}))}),tt(u=>{let c=new Hc(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}))}),xf(o=>{let u=c=>{let l=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&l.push(this.configLoader.loadComponent(c.routeConfig).pipe(tt(f=>{c.component=f}),J(()=>{})));for(let f of c.children)l.push(...u(f));return l};return ju(u(o.targetSnapshot.root)).pipe(Fd(null),Mi(1))}),xf(()=>this.afterPreactivation()),Te(()=>{let{currentSnapshot:o,targetSnapshot:u}=r,c=this.createViewTransition?.(this.environmentInjector,o.root,u.root);return c?de(c).pipe(J(()=>r)):W(r)}),J(o=>{let u=tR(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=he($({},o),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,r}),tt(()=>{this.events.next(new ca)}),sR(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Mi(1),tt({next:o=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new It(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),yv(this.transitionAbortSubject.pipe(tt(o=>{throw o}))),Lr(()=>{!i&&!s&&this.cancelNavigationTransition(r,"",mt.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation=null,this.currentTransition=null)}),Ge(o=>{if(this.destroyed)return r.resolve(!1),Tn;if(s=!0,UE(o))this.events.next(new tn(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),iR(o)?this.events.next(new ts(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let u=new Ji(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let c=rt(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(c instanceof ns){let{message:l,cancellationCode:f}=nl(this.urlSerializer,c);this.events.next(new tn(r.id,this.urlSerializer.serialize(r.extractedUrl),l,f)),this.events.next(new ts(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(u),o}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return Tn}))}))}cancelNavigationTransition(t,r,i){let s=new tn(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function KR(n){return n!==Bc}var QE=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>L(QR),providedIn:"root"})}return n})(),il=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},QR=(()=>{class n extends il{static \u0275fac=(()=>{let t;return function(i){return(t||(t=xi(n)))(i||n)}})();static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),YE=(()=>{class n{urlSerializer=L(Kr);options=L(Yr,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=L(Xn);urlHandlingStrategy=L(al);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new nn;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof nn?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=kE(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:()=>L(YR),providedIn:"root"})}return n})(),YR=(()=>{class n extends YE{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof ir?this.updateStateMemento():t instanceof rn?this.commitTransition(r):t instanceof ua?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof ca?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof tn&&(t.code===mt.GuardRejected||t.code===mt.NoDataFromResolver)?this.restoreHistory(r):t instanceof Ji?this.restoreHistory(r,!0):t instanceof It&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let u=this.browserPageId,c=$($({},o),this.generateNgRouterState(i,u));this.location.replaceState(t,"",c)}else{let u=$($({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",u)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=xi(n)))(i||n)}})();static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function cl(n,e){n.events.pipe(lt(t=>t instanceof It||t instanceof tn||t instanceof Ji||t instanceof rn),J(t=>t instanceof It||t instanceof rn?0:(t instanceof tn?t.code===mt.Redirect||t.code===mt.SupersededByNewNavigation:!1)?2:1),lt(t=>t!==2),Mi(1)).subscribe(()=>{e()})}var ZR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},XR={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},sn=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=L(Fv);stateManager=L(YE);options=L(Yr,{optional:!0})||{};pendingTasks=L(ko);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=L(ul);urlSerializer=L(Kr);location=L(Xn);urlHandlingStrategy=L(al);_events=new ct;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=L(QE);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=L(ss,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!L(ya,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new av;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof tn&&r.code!==mt.Redirect&&r.code!==mt.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof It)this.navigated=!0;else if(r instanceof ts){let o=r.navigationBehaviorOptions,u=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=$({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||KR(i.source)},o);this.scheduleNavigation(u,Bc,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}eP(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Bc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=$({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let u=this.parseUrl(t);this.scheduleNavigation(u,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(ep),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:u,preserveFragment:c}=r,l=c?this.currentUrlTree.fragment:o,f=null;switch(u??this.options.defaultQueryParamsHandling){case"merge":f=$($({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}f!==null&&(f=this.removeEmptyProps(f));let p;try{let m=i?i.snapshot:this.routerState.snapshot.root;p=RE(m)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return PE(p,t,f,l??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=rr(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Bc,null,r)}navigate(t,r={skipLocationChange:!1}){return JR(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=$({},ZR):r===!1?i=$({},XR):i=r,rr(t))return lE(this.currentUrlTree,t,i);let s=this.parseUrl(t);return lE(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let u,c,l;o?(u=o.resolve,c=o.reject,l=o.promise):l=new Promise((p,m)=>{u=p,c=m});let f=this.pendingTasks.add();return cl(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(p=>Promise.reject(p))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function JR(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new re(4008,!1)}function eP(n){return!(n instanceof ca)&&!(n instanceof ts)}var ll=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new ct;constructor(t,r,i,s,o,u){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=u;let c=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=t.events.subscribe(l=>{l instanceof It&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(rr(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,s,o){let u=this.urlTree;if(u===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:Pv(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:rr(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(ie(sn),ie(Sn),jd("tabindex"),ie(Yn),ie(Qn),ie(Lt))};static \u0275dir=Be({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&An("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&Yu("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",jr],skipLocationChange:[2,"skipLocationChange","skipLocationChange",jr],replaceUrl:[2,"replaceUrl","replaceUrl",jr],routerLink:"routerLink"},features:[Zt]})}return n})(),tP=(()=>{class n{router;element;renderer;cdr;link;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new Mt;constructor(t,r,i,s,o){this.router=t,this.element=r,this.renderer=i,this.cdr=s,this.link=o,this.routerEventsSubscription=t.events.subscribe(u=>{u instanceof It&&this.update()})}ngAfterContentInit(){W(this.links.changes,W(null)).pipe(Mo()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=de(t).pipe(Mo()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(t){let r=Array.isArray(t)?t:t.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(r=>{t?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let r=nP(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>{let s=i.urlTree;return s?t.isActive(s,r):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static \u0275fac=function(r){return new(r||n)(ie(sn),ie(Qn),ie(Yn),ie(Br),ie(ll,8))};static \u0275dir=Be({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,s){if(r&1&&jv(s,ll,5),r&2){let o;$v(o=zv())&&(i.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Zt]})}return n})();function nP(n){return!!n.paths}var va=class{};var ZE=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(t,r,i,s,o){this.router=t,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(lt(t=>t instanceof It),Dn(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let s of r){s.providers&&!s._injector&&(s._injector=Wu(s.providers,t,`Route: ${s.path}`));let o=s._injector??t,u=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&s.canLoad===void 0||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(u,s.children??s._loadedRoutes))}return de(i).pipe(Mo())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=W(null);let s=i.pipe(pt(o=>o===null?W(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));if(r.loadComponent&&!r._loadedComponent){let o=this.loader.loadComponent(r);return de([s,o]).pipe(Mo())}else return s})}static \u0275fac=function(r){return new(r||n)(O(sn),O(Xu),O(nt),O(va),O(ol))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),XE=new Q(""),rP=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(t,r,i,s,o={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof ir?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof It?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof rn&&t.code===Xi.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof es&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new es(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){Nv()};static \u0275prov=K({token:n,factory:n.\u0275fac})}return n})();function iP(n){return n.routerState.root}function wa(n,e){return{\u0275kind:n,\u0275providers:e}}function sP(){let n=L(Kn);return e=>{let t=n.get(Lv);if(e!==t.components[0])return;let r=n.get(sn),i=n.get(JE);n.get(sp)===1&&r.initialNavigation(),n.get(n0,null,Ud.Optional)?.setUpPreloading(),n.get(XE,null,Ud.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var JE=new Q("",{factory:()=>new ct}),sp=new Q("",{providedIn:"root",factory:()=>1});function e0(){let n=[{provide:sp,useValue:0},Qd(()=>{let e=L(Kn);return e.get(nf,Promise.resolve()).then(()=>new Promise(r=>{let i=e.get(sn),s=e.get(JE);cl(i,()=>{r(!0)}),e.get(ul).afterPreactivation=()=>(r(!0),s.closed?W(void 0):s),i.initialNavigation()}))})];return wa(2,n)}function t0(){let n=[Qd(()=>{L(sn).setUpLocationChangeListener()}),{provide:sp,useValue:2}];return wa(3,n)}var n0=new Q("");function r0(n){return wa(0,[{provide:n0,useExisting:ZE},{provide:va,useExisting:n}])}function i0(){return wa(8,[Zf,{provide:ya,useExisting:Zf}])}function s0(n){Hd("NgRouterViewTransitions");let e=[{provide:tp,useValue:KE},{provide:np,useValue:$({skipNextTransition:!!n?.skipInitialTransition},n)}];return wa(9,e)}var o0=[Xn,{provide:Kr,useClass:nr},sn,Qr,{provide:Sn,useFactory:iP,deps:[sn]},ol,[]],op=(()=>{class n{constructor(){}static forRoot(t,r){return{ngModule:n,providers:[o0,[],{provide:ss,multi:!0,useValue:t},[],r?.errorHandler?{provide:rp,useValue:r.errorHandler}:[],{provide:Yr,useValue:r||{}},r?.useHash?aP():uP(),oP(),r?.preloadingStrategy?r0(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?cP(r):[],r?.bindToComponentInputs?i0().\u0275providers:[],r?.enableViewTransitions?s0().\u0275providers:[],lP()]}}static forChild(t){return{ngModule:n,providers:[{provide:ss,multi:!0,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Ue({type:n});static \u0275inj=Le({})}return n})();function oP(){return{provide:XE,useFactory:()=>{let n=L(aw),e=L(De),t=L(Yr),r=L(ul),i=L(Kr);return t.scrollOffset&&n.setOffset(t.scrollOffset),new rP(i,r,n,e,t)}}}function aP(){return{provide:Lt,useClass:rf}}function uP(){return{provide:Lt,useClass:lc}}function cP(n){return[n.initialNavigation==="disabled"?t0().\u0275providers:[],n.initialNavigation==="enabledBlocking"?e0().\u0275providers:[]]}var ip=new Q("");function lP(){return[{provide:ip,useFactory:sP},{provide:Vv,multi:!0,useExisting:ip}]}var hP="firebase",dP="11.6.0";Nt(hP,dP,"app");function We(n){n===void 0&&(Ev(We),n=L(Kn));let e=n.get(Gu);return t=>new Rt(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let u=t.subscribe({next:c=>{r.next(c),o()},complete:()=>{r.complete(),o()},error:c=>{r.error(c),o()}});return u.add(()=>{r.unsubscribe(),o()}),u})}var Rn=new Zu("ANGULARFIRE2_VERSION");var ap=(n,e)=>{let t=e?[e]:Jv(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},os=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(os||{}),a0=Li()&&typeof Zone<"u"?os.WARN:os.SILENT;var hl=class{zone;delegate;constructor(e,t=cv){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,r)}},Xr=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=L(De);this.outsideAngular=t.runOutsideAngular(()=>new hl(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new hl(typeof Zone>"u"?void 0:Zone.current,Bu))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),u0=!1;function fP(n,e){!u0&&(a0>os.SILENT||Li())&&(u0=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),a0>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function pP(n){let e=L(De,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function Zr(n){let e=L(De,{optional:!0});return e?e.run(()=>n()):n()}var gP=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),rt(t,()=>Zr(()=>n.apply(void 0,r)))),Ea=(n,e,t)=>(t||=e?os.WARN:os.VERBOSE,function(){let r,i=arguments,s,o,u;try{s=L(Xr),o=L(Gu),u=L(nt)}catch{return fP(n,t),n.apply(this,i)}for(let l=0;l<arguments.length;l++)typeof i[l]=="function"&&(e&&(r||=Zr(()=>o.add())),i[l]=gP(i[l],r,u));let c=pP(()=>n.apply(this,i));return e?c instanceof Rt?c.pipe(Or(s.outsideAngular),Hn(s.insideAngular),We(u)):c instanceof Promise?Zr(()=>new Promise((l,f)=>{o.run(()=>c).then(p=>rt(u,()=>Zr(()=>l(p))),p=>rt(u,()=>Zr(()=>f(p))))})):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:Zr(()=>c):c instanceof Rt?c.pipe(Or(s.outsideAngular),Hn(s.insideAngular)):Zr(()=>c)});var mP=new Map,yP={activated:!1,tokenObservers:[]},_P={initialized:!1,enabled:!1};function jt(n){return mP.get(n)||Object.assign({},yP)}function f0(){return _P}var vP="https://content-firebaseappcheck.googleapis.com/v1";var wP="exchangeDebugToken",l0={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},IL=24*60*60*1e3;var lp=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return R(this,null,function*(){this.stop();try{this.pending=new Jd,this.pending.promise.catch(t=>{}),yield EP(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Jd,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function EP(n){return new Promise(e=>{setTimeout(e,n)})}var TP={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},or=new Xv("appCheck","AppCheck",TP);function p0(n){if(!jt(n).activated)throw or.create("use-before-activation",{appName:n.name})}function g0(r,i){return R(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let w=yield o.getHeartbeatsHeader();w&&(s["X-Firebase-Client"]=w)}let u={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(n,u)}catch(w){throw or.create("fetch-network-error",{originalErrorMessage:w?.message})}if(c.status!==200)throw or.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(w){throw or.create("fetch-parse-error",{originalErrorMessage:w?.message})}let f=l.ttl.match(/^([\d.]+)(s)$/);if(!f||!f[2]||isNaN(Number(f[1])))throw or.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let p=Number(f[1])*1e3,m=Date.now();return{token:l.token,expireTimeMillis:m+p,issuedAtTimeMillis:m}})}function m0(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${vP}/projects/${t}/apps/${r}:${wP}?key=${i}`,body:{debug_token:e}}}var DP="firebase-app-check-database",IP=1,hp="firebase-app-check-store";var dl=null;function AP(){return dl||(dl=new Promise((n,e)=>{try{let t=indexedDB.open(DP,IP);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(or.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(hp,{keyPath:"compositeKey"})}}}catch(t){e(or.create("storage-open",{originalErrorMessage:t?.message}))}}),dl)}function bP(n,e){return CP(SP(n),e)}function CP(n,e){return R(this,null,function*(){let r=(yield AP()).transaction(hp,"readwrite"),s=r.objectStore(hp).put({compositeKey:n,value:e});return new Promise((o,u)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var l;u(or.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function SP(n){return`${n.options.appId}-${n.name}`}var Ta=new rc("@firebase/app-check");function up(n,e){return ec()?bP(n,e).catch(t=>{Ta.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function y0(){return f0().enabled}function _0(){return R(this,null,function*(){let n=f0();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var RP={error:"UNKNOWN_ERROR"};function PP(n){return Zv.encodeString(JSON.stringify(n),!1)}function dp(n,e=!1,t=!1){return R(this,null,function*(){let r=n.app;p0(r);let i=jt(r),s=i.token,o;if(s&&!Da(s)&&(i.token=void 0,s=void 0),!s){let l=yield i.cachedTokenPromise;l&&(Da(l)?s=l:yield up(r,void 0))}if(!e&&s&&Da(s))return{token:s.token};let u=!1;if(y0())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=g0(m0(r,yield _0()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);let l=yield i.exchangeTokenPromise;return yield up(r,l),i.token=l,{token:l.token}}catch(l){return l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?Ta.warn(l.message):t&&Ta.error(l),cp(l)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),s=yield jt(r).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"||l.code==="appCheck/initial-throttle"?Ta.warn(l.message):t&&Ta.error(l),o=l}let c;return s?o?Da(s)?c={token:s.token,internalError:o}:c=cp(o):(c={token:s.token},i.token=s,yield up(r,s)):c=cp(o),u&&xP(r,c),c})}function MP(n){return R(this,null,function*(){let e=n.app;p0(e);let{provider:t}=jt(e);if(y0()){let r=yield _0(),{token:i}=yield g0(m0(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function NP(n,e,t,r){let{app:i}=n,s=jt(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Da(s.token)){let u=s.token;Promise.resolve().then(()=>{t({token:u.token}),h0(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>h0(n))}function v0(n,e){let t=jt(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function h0(n){let{app:e}=n,t=jt(e),r=t.tokenRefresher;r||(r=kP(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function kP(n){let{app:e}=n;return new lp(()=>R(this,null,function*(){let t=jt(e),r;if(t.token?r=yield dp(n,!0):r=yield dp(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=jt(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},l0.RETRIAL_MIN_WAIT,l0.RETRIAL_MAX_WAIT)}function xP(n,e){let t=jt(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Da(n){return n.expireTimeMillis-Date.now()>0}function cp(n){return{token:PP(RP),error:n}}var fp=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=jt(this.app);for(let t of e)v0(this.app,t.next);return Promise.resolve()}};function FP(n,e){return new fp(n,e)}function OP(n){return{getToken:e=>dp(n,e),getLimitedUseToken:()=>MP(n),addTokenListener:e=>NP(n,"INTERNAL",e),removeTokenListener:e=>v0(n.app,e)}}var VP="@firebase/app-check",LP="0.8.13";var UP="app-check",d0="app-check-internal";function BP(){$r(new bn(UP,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return FP(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(d0).initialize()})),$r(new bn(d0,n=>{let e=n.getProvider("app-check").getImmediate();return OP(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Nt(VP,LP)}BP();var $P="app-check";var as=class{constructor(){return ap($P)}};var zP=["localhost","0.0.0.0","127.0.0.1"],VL=typeof window<"u"&&zP.includes(window.location.hostname);var qP="firebase",GP="11.6.0";ht.registerVersion(qP,GP,"app-compat");var HP=["ngOnDestroy"],T0=(n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(HP.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(u=>{let c=u?.[s];return typeof c=="function"?c.bind(u):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(u,c)=>o[c],apply:(u,c,l)=>o.then(f=>{let p=f?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,p),p})})})});var fl=class{constructor(e){return e}},us=new Q("angularfire2.app.options"),cs=new Q("angularfire2.app.name");function Ia(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let o=ht.apps.filter(u=>u&&u.name===i.name)[0]||e.runOutsideAngular(()=>ht.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let u=!!module.hot;WP("error",`${o.name} Firebase App already initialized with different options${u?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new fl(o)}var WP=(n,...e)=>{Li()&&typeof console<"u"&&console[n](...e)},KP={provide:fl,useFactory:Ia,deps:[us,De,[new vv,cs]]},WL=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:us,useValue:t},{provide:cs,useValue:r}]}}constructor(t){ht.registerVersion("angularfire",Rn.full,"core"),ht.registerVersion("angularfire",Rn.full,"app-compat"),ht.registerVersion("angular",Gv.full,t.toString())}static \u0275fac=function(r){return new(r||n)(O(gt))};static \u0275mod=Ue({type:n});static \u0275inj=Le({providers:[KP]})}return n})();function pl(n,e,t,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(u=>u[0]===n)||[];if(s)return QP(i,o)||(E0("error",`${e} was already initialized on the ${t} Firebase App with different settings.${YP?" You may need to reload as Firebase is not HMR aware.":""}`),E0("warn",{is:i,was:o})),s;{let u=r();return globalThis.\u0275AngularfireInstanceCache.push([n,u,i]),u}}function QP(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var YP=typeof module<"u"&&!!module.hot,E0=(n,...e)=>{Li()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var pp=new Q("angularfire2.auth.use-emulator"),gp=new Q("angularfire2.auth.settings"),mp=new Q("angularfire2.auth.tenant-id"),yp=new Q("angularfire2.auth.langugage-code"),_p=new Q("angularfire2.auth.use-device-language"),vp=new Q("angularfire.auth.persistence"),wp=(n,e,t,r,i,s,o,u)=>pl(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[l,f]of Object.entries(o))c.settings[l]=f;return u&&c.setPersistence(u),c},[t,r,i,s,o,u]),Ep=(()=>{class n{injector=L(nt);authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,u,c,l,f,p,m,w){let P=new ct,S=W(void 0).pipe(Hn(o.outsideAngular),Te(()=>s.runOutsideAngular(()=>import("./chunk-W57UCGOO.js"))),J(()=>Ia(t,s,r)),J(A=>wp(A,s,u,l,f,p,c,m)),Vd({bufferSize:1,refCount:!1}));if(Jn(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=W(null);else{S.pipe(Yt()).subscribe();let A=S.pipe(Te(k=>k.getRedirectResult().then(z=>z,()=>null)),We(this.injector),Vd({bufferSize:1,refCount:!1})),j=S.pipe(Te(k=>new Rt(z=>({unsubscribe:s.runOutsideAngular(()=>k.onAuthStateChanged(Z=>z.next(Z),Z=>z.error(Z),()=>z.complete()))})))),G=S.pipe(Te(k=>new Rt(z=>({unsubscribe:s.runOutsideAngular(()=>k.onIdTokenChanged(Z=>z.next(Z),Z=>z.error(Z),()=>z.complete()))}))));this.authState=A.pipe(Ld(j),Or(o.outsideAngular),Hn(o.insideAngular)),this.user=A.pipe(Ld(G),Or(o.outsideAngular),Hn(o.insideAngular)),this.idToken=this.user.pipe(Te(k=>k?de(k.getIdToken()):W(null))),this.idTokenResult=this.user.pipe(Te(k=>k?de(k.getIdTokenResult()):W(null))),this.credential=pv(A,P,this.authState.pipe(lt(k=>!k))).pipe(J(k=>k?.user?k:null),Or(o.outsideAngular),Hn(o.insideAngular))}return T0(this,S,s,{spy:{apply:(A,j,G)=>{(A.startsWith("signIn")||A.startsWith("createUser"))&&G.then(k=>P.next(k))}}})}static \u0275fac=function(r){return new(r||n)(O(us),O(cs,8),O(gt),O(De),O(Xr),O(pp,8),O(gp,8),O(mp,8),O(yp,8),O(_p,8),O(vp,8),O(as,8))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),c2=(()=>{class n{constructor(){ht.registerVersion("angularfire",Rn.full,"auth-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Ue({type:n});static \u0275inj=Le({providers:[Ep]})}return n})();var D0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},I0={};var Pn,Tp;(function(){var n;function e(E,y){function v(){}v.prototype=y.prototype,E.D=y.prototype,E.prototype=new v,E.prototype.constructor=E,E.C=function(T,D,b){for(var _=Array(arguments.length-2),vn=2;vn<arguments.length;vn++)_[vn-2]=arguments[vn];return y.prototype[D].apply(T,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,y,v){v||(v=0);var T=Array(16);if(typeof y=="string")for(var D=0;16>D;++D)T[D]=y.charCodeAt(v++)|y.charCodeAt(v++)<<8|y.charCodeAt(v++)<<16|y.charCodeAt(v++)<<24;else for(D=0;16>D;++D)T[D]=y[v++]|y[v++]<<8|y[v++]<<16|y[v++]<<24;y=E.g[0],v=E.g[1],D=E.g[2];var b=E.g[3],_=y+(b^v&(D^b))+T[0]+3614090360&4294967295;y=v+(_<<7&4294967295|_>>>25),_=b+(D^y&(v^D))+T[1]+3905402710&4294967295,b=y+(_<<12&4294967295|_>>>20),_=D+(v^b&(y^v))+T[2]+606105819&4294967295,D=b+(_<<17&4294967295|_>>>15),_=v+(y^D&(b^y))+T[3]+3250441966&4294967295,v=D+(_<<22&4294967295|_>>>10),_=y+(b^v&(D^b))+T[4]+4118548399&4294967295,y=v+(_<<7&4294967295|_>>>25),_=b+(D^y&(v^D))+T[5]+1200080426&4294967295,b=y+(_<<12&4294967295|_>>>20),_=D+(v^b&(y^v))+T[6]+2821735955&4294967295,D=b+(_<<17&4294967295|_>>>15),_=v+(y^D&(b^y))+T[7]+4249261313&4294967295,v=D+(_<<22&4294967295|_>>>10),_=y+(b^v&(D^b))+T[8]+1770035416&4294967295,y=v+(_<<7&4294967295|_>>>25),_=b+(D^y&(v^D))+T[9]+2336552879&4294967295,b=y+(_<<12&4294967295|_>>>20),_=D+(v^b&(y^v))+T[10]+4294925233&4294967295,D=b+(_<<17&4294967295|_>>>15),_=v+(y^D&(b^y))+T[11]+2304563134&4294967295,v=D+(_<<22&4294967295|_>>>10),_=y+(b^v&(D^b))+T[12]+1804603682&4294967295,y=v+(_<<7&4294967295|_>>>25),_=b+(D^y&(v^D))+T[13]+4254626195&4294967295,b=y+(_<<12&4294967295|_>>>20),_=D+(v^b&(y^v))+T[14]+2792965006&4294967295,D=b+(_<<17&4294967295|_>>>15),_=v+(y^D&(b^y))+T[15]+1236535329&4294967295,v=D+(_<<22&4294967295|_>>>10),_=y+(D^b&(v^D))+T[1]+4129170786&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^D&(y^v))+T[6]+3225465664&4294967295,b=y+(_<<9&4294967295|_>>>23),_=D+(y^v&(b^y))+T[11]+643717713&4294967295,D=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(D^b))+T[0]+3921069994&4294967295,v=D+(_<<20&4294967295|_>>>12),_=y+(D^b&(v^D))+T[5]+3593408605&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^D&(y^v))+T[10]+38016083&4294967295,b=y+(_<<9&4294967295|_>>>23),_=D+(y^v&(b^y))+T[15]+3634488961&4294967295,D=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(D^b))+T[4]+3889429448&4294967295,v=D+(_<<20&4294967295|_>>>12),_=y+(D^b&(v^D))+T[9]+568446438&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^D&(y^v))+T[14]+3275163606&4294967295,b=y+(_<<9&4294967295|_>>>23),_=D+(y^v&(b^y))+T[3]+4107603335&4294967295,D=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(D^b))+T[8]+1163531501&4294967295,v=D+(_<<20&4294967295|_>>>12),_=y+(D^b&(v^D))+T[13]+2850285829&4294967295,y=v+(_<<5&4294967295|_>>>27),_=b+(v^D&(y^v))+T[2]+4243563512&4294967295,b=y+(_<<9&4294967295|_>>>23),_=D+(y^v&(b^y))+T[7]+1735328473&4294967295,D=b+(_<<14&4294967295|_>>>18),_=v+(b^y&(D^b))+T[12]+2368359562&4294967295,v=D+(_<<20&4294967295|_>>>12),_=y+(v^D^b)+T[5]+4294588738&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^D)+T[8]+2272392833&4294967295,b=y+(_<<11&4294967295|_>>>21),_=D+(b^y^v)+T[11]+1839030562&4294967295,D=b+(_<<16&4294967295|_>>>16),_=v+(D^b^y)+T[14]+4259657740&4294967295,v=D+(_<<23&4294967295|_>>>9),_=y+(v^D^b)+T[1]+2763975236&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^D)+T[4]+1272893353&4294967295,b=y+(_<<11&4294967295|_>>>21),_=D+(b^y^v)+T[7]+4139469664&4294967295,D=b+(_<<16&4294967295|_>>>16),_=v+(D^b^y)+T[10]+3200236656&4294967295,v=D+(_<<23&4294967295|_>>>9),_=y+(v^D^b)+T[13]+681279174&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^D)+T[0]+3936430074&4294967295,b=y+(_<<11&4294967295|_>>>21),_=D+(b^y^v)+T[3]+3572445317&4294967295,D=b+(_<<16&4294967295|_>>>16),_=v+(D^b^y)+T[6]+76029189&4294967295,v=D+(_<<23&4294967295|_>>>9),_=y+(v^D^b)+T[9]+3654602809&4294967295,y=v+(_<<4&4294967295|_>>>28),_=b+(y^v^D)+T[12]+3873151461&4294967295,b=y+(_<<11&4294967295|_>>>21),_=D+(b^y^v)+T[15]+530742520&4294967295,D=b+(_<<16&4294967295|_>>>16),_=v+(D^b^y)+T[2]+3299628645&4294967295,v=D+(_<<23&4294967295|_>>>9),_=y+(D^(v|~b))+T[0]+4096336452&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~D))+T[7]+1126891415&4294967295,b=y+(_<<10&4294967295|_>>>22),_=D+(y^(b|~v))+T[14]+2878612391&4294967295,D=b+(_<<15&4294967295|_>>>17),_=v+(b^(D|~y))+T[5]+4237533241&4294967295,v=D+(_<<21&4294967295|_>>>11),_=y+(D^(v|~b))+T[12]+1700485571&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~D))+T[3]+2399980690&4294967295,b=y+(_<<10&4294967295|_>>>22),_=D+(y^(b|~v))+T[10]+4293915773&4294967295,D=b+(_<<15&4294967295|_>>>17),_=v+(b^(D|~y))+T[1]+2240044497&4294967295,v=D+(_<<21&4294967295|_>>>11),_=y+(D^(v|~b))+T[8]+1873313359&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~D))+T[15]+4264355552&4294967295,b=y+(_<<10&4294967295|_>>>22),_=D+(y^(b|~v))+T[6]+2734768916&4294967295,D=b+(_<<15&4294967295|_>>>17),_=v+(b^(D|~y))+T[13]+1309151649&4294967295,v=D+(_<<21&4294967295|_>>>11),_=y+(D^(v|~b))+T[4]+4149444226&4294967295,y=v+(_<<6&4294967295|_>>>26),_=b+(v^(y|~D))+T[11]+3174756917&4294967295,b=y+(_<<10&4294967295|_>>>22),_=D+(y^(b|~v))+T[2]+718787259&4294967295,D=b+(_<<15&4294967295|_>>>17),_=v+(b^(D|~y))+T[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(D+(_<<21&4294967295|_>>>11))&4294967295,E.g[2]=E.g[2]+D&4294967295,E.g[3]=E.g[3]+b&4294967295}r.prototype.u=function(E,y){y===void 0&&(y=E.length);for(var v=y-this.blockSize,T=this.B,D=this.h,b=0;b<y;){if(D==0)for(;b<=v;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<y;)if(T[D++]=E.charCodeAt(b++),D==this.blockSize){i(this,T),D=0;break}}else for(;b<y;)if(T[D++]=E[b++],D==this.blockSize){i(this,T),D=0;break}}this.h=D,this.o+=y},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;var v=8*this.o;for(y=E.length-8;y<E.length;++y)E[y]=v&255,v/=256;for(this.u(E),E=Array(16),y=v=0;4>y;++y)for(var T=0;32>T;T+=8)E[v++]=this.g[y]>>>T&255;return E};function s(E,y){var v=u;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=y(E)}function o(E,y){this.h=y;for(var v=[],T=!0,D=E.length-1;0<=D;D--){var b=E[D]|0;T&&b==y||(v[D]=b,T=!1)}this.g=v}var u={};function c(E){return-128<=E&&128>E?s(E,function(y){return new o([y|0],0>y?-1:0)}):new o([E|0],0>E?-1:0)}function l(E){if(isNaN(E)||!isFinite(E))return p;if(0>E)return A(l(-E));for(var y=[],v=1,T=0;E>=v;T++)y[T]=E/v|0,v*=4294967296;return new o(y,0)}function f(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return A(f(E.substring(1),y));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=l(Math.pow(y,8)),T=p,D=0;D<E.length;D+=8){var b=Math.min(8,E.length-D),_=parseInt(E.substring(D,D+b),y);8>b?(b=l(Math.pow(y,b)),T=T.j(b).add(l(_))):(T=T.j(v),T=T.add(l(_)))}return T}var p=c(0),m=c(1),w=c(16777216);n=o.prototype,n.m=function(){if(S(this))return-A(this).m();for(var E=0,y=1,v=0;v<this.g.length;v++){var T=this.i(v);E+=(0<=T?T:4294967296+T)*y,y*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(P(this))return"0";if(S(this))return"-"+A(this).toString(E);for(var y=l(Math.pow(E,6)),v=this,T="";;){var D=z(v,y).g;v=j(v,D.j(y));var b=((0<v.g.length?v.g[0]:v.h)>>>0).toString(E);if(v=D,P(v))return b+T;for(;6>b.length;)b="0"+b;T=b+T}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function P(E){if(E.h!=0)return!1;for(var y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function S(E){return E.h==-1}n.l=function(E){return E=j(this,E),S(E)?-1:P(E)?0:1};function A(E){for(var y=E.g.length,v=[],T=0;T<y;T++)v[T]=~E.g[T];return new o(v,~E.h).add(m)}n.abs=function(){return S(this)?A(this):this},n.add=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],T=0,D=0;D<=y;D++){var b=T+(this.i(D)&65535)+(E.i(D)&65535),_=(b>>>16)+(this.i(D)>>>16)+(E.i(D)>>>16);T=_>>>16,b&=65535,_&=65535,v[D]=_<<16|b}return new o(v,v[v.length-1]&-2147483648?-1:0)};function j(E,y){return E.add(A(y))}n.j=function(E){if(P(this)||P(E))return p;if(S(this))return S(E)?A(this).j(A(E)):A(A(this).j(E));if(S(E))return A(this.j(A(E)));if(0>this.l(w)&&0>E.l(w))return l(this.m()*E.m());for(var y=this.g.length+E.g.length,v=[],T=0;T<2*y;T++)v[T]=0;for(T=0;T<this.g.length;T++)for(var D=0;D<E.g.length;D++){var b=this.i(T)>>>16,_=this.i(T)&65535,vn=E.i(D)>>>16,ho=E.i(D)&65535;v[2*T+2*D]+=_*ho,G(v,2*T+2*D),v[2*T+2*D+1]+=b*ho,G(v,2*T+2*D+1),v[2*T+2*D+1]+=_*vn,G(v,2*T+2*D+1),v[2*T+2*D+2]+=b*vn,G(v,2*T+2*D+2)}for(T=0;T<y;T++)v[T]=v[2*T+1]<<16|v[2*T];for(T=y;T<2*y;T++)v[T]=0;return new o(v,0)};function G(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function k(E,y){this.g=E,this.h=y}function z(E,y){if(P(y))throw Error("division by zero");if(P(E))return new k(p,p);if(S(E))return y=z(A(E),y),new k(A(y.g),A(y.h));if(S(y))return y=z(E,A(y)),new k(A(y.g),y.h);if(30<E.g.length){if(S(E)||S(y))throw Error("slowDivide_ only works with positive integers.");for(var v=m,T=y;0>=T.l(E);)v=Z(v),T=Z(T);var D=X(v,1),b=X(T,1);for(T=X(T,2),v=X(v,2);!P(T);){var _=b.add(T);0>=_.l(E)&&(D=D.add(v),b=_),T=X(T,1),v=X(v,1)}return y=j(E,D.j(y)),new k(D,y)}for(D=p;0<=E.l(y);){for(v=Math.max(1,Math.floor(E.m()/y.m())),T=Math.ceil(Math.log(v)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),b=l(v),_=b.j(y);S(_)||0<_.l(E);)v-=T,b=l(v),_=b.j(y);P(b)&&(b=m),D=D.add(b),E=j(E,_)}return new k(D,E)}n.A=function(E){return z(this,E).h},n.and=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],T=0;T<y;T++)v[T]=this.i(T)&E.i(T);return new o(v,this.h&E.h)},n.or=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],T=0;T<y;T++)v[T]=this.i(T)|E.i(T);return new o(v,this.h|E.h)},n.xor=function(E){for(var y=Math.max(this.g.length,E.g.length),v=[],T=0;T<y;T++)v[T]=this.i(T)^E.i(T);return new o(v,this.h^E.h)};function Z(E){for(var y=E.g.length+1,v=[],T=0;T<y;T++)v[T]=E.i(T)<<1|E.i(T-1)>>>31;return new o(v,E.h)}function X(E,y){var v=y>>5;y%=32;for(var T=E.g.length-v,D=[],b=0;b<T;b++)D[b]=0<y?E.i(b+v)>>>y|E.i(b+v+1)<<32-y:E.i(b+v);return new o(D,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Tp=I0.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=f,Pn=I0.Integer=o}).apply(typeof D0<"u"?D0:typeof self<"u"?self:typeof window<"u"?window:{});var gl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Mn={};var Dp,XP,ls,Ip,Aa,ml,Ap,bp,Cp;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,d){return a==Array.prototype||a==Object.prototype||(a[h]=d.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof gl=="object"&&gl];for(var h=0;h<a.length;++h){var d=a[h];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(a,h){if(h)e:{var d=r;a=a.split(".");for(var g=0;g<a.length-1;g++){var I=a[g];if(!(I in d))break e;d=d[I]}a=a[a.length-1],g=d[a],h=h(g),h!=g&&h!=null&&e(d,a,{configurable:!0,writable:!0,value:h})}}function s(a,h){a instanceof String&&(a+="");var d=0,g=!1,I={next:function(){if(!g&&d<a.length){var N=d++;return{value:h(N,a[N]),done:!1}}return g=!0,{done:!0,value:void 0}}};return I[Symbol.iterator]=function(){return I},I}i("Array.prototype.values",function(a){return a||function(){return s(this,function(h,d){return d})}});var o=o||{},u=this||self;function c(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function l(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function f(a,h,d){return a.call.apply(a.bind,arguments)}function p(a,h,d){if(!a)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var I=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(I,g),a.apply(h,I)}}return function(){return a.apply(h,arguments)}}function m(a,h,d){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:p,m.apply(null,arguments)}function w(a,h){var d=Array.prototype.slice.call(arguments,1);return function(){var g=d.slice();return g.push.apply(g,arguments),a.apply(this,g)}}function P(a,h){function d(){}d.prototype=h.prototype,a.aa=h.prototype,a.prototype=new d,a.prototype.constructor=a,a.Qb=function(g,I,N){for(var V=Array(arguments.length-2),me=2;me<arguments.length;me++)V[me-2]=arguments[me];return h.prototype[I].apply(g,V)}}function S(a){let h=a.length;if(0<h){let d=Array(h);for(let g=0;g<h;g++)d[g]=a[g];return d}return[]}function A(a,h){for(let d=1;d<arguments.length;d++){let g=arguments[d];if(c(g)){let I=a.length||0,N=g.length||0;a.length=I+N;for(let V=0;V<N;V++)a[I+V]=g[V]}else a.push(g)}}class j{constructor(h,d){this.i=h,this.j=d,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function G(a){return/^[\s\xa0]*$/.test(a)}function k(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function z(a){return z[" "](a),a}z[" "]=function(){};var Z=k().indexOf("Gecko")!=-1&&!(k().toLowerCase().indexOf("webkit")!=-1&&k().indexOf("Edge")==-1)&&!(k().indexOf("Trident")!=-1||k().indexOf("MSIE")!=-1)&&k().indexOf("Edge")==-1;function X(a,h,d){for(let g in a)h.call(d,a[g],g,a)}function E(a,h){for(let d in a)h.call(void 0,a[d],d,a)}function y(a){let h={};for(let d in a)h[d]=a[d];return h}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(a,h){let d,g;for(let I=1;I<arguments.length;I++){g=arguments[I];for(d in g)a[d]=g[d];for(let N=0;N<v.length;N++)d=v[N],Object.prototype.hasOwnProperty.call(g,d)&&(a[d]=g[d])}}function D(a){var h=1;a=a.split(":");let d=[];for(;0<h&&a.length;)d.push(a.shift()),h--;return a.length&&d.push(a.join(":")),d}function b(a){u.setTimeout(()=>{throw a},0)}function _(){var a=od;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class vn{constructor(){this.h=this.g=null}add(h,d){let g=ho.get();g.set(h,d),this.h?this.h.next=g:this.g=g,this.h=g}}var ho=new j(()=>new gb,a=>a.reset());class gb{constructor(){this.next=this.g=this.h=null}set(h,d){this.h=h,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let fo,po=!1,od=new vn,o_=()=>{let a=u.Promise.resolve(void 0);fo=()=>{a.then(mb)}};var mb=()=>{for(var a;a=_();){try{a.h.call(a.g)}catch(d){b(d)}var h=ho;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}po=!1};function $n(){this.s=this.s,this.C=this.C}$n.prototype.s=!1,$n.prototype.ma=function(){this.s||(this.s=!0,this.N())},$n.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ze(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}Ze.prototype.h=function(){this.defaultPrevented=!0};var yb=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};u.addEventListener("test",d,h),u.removeEventListener("test",d,h)}catch{}return a}();function go(a,h){if(Ze.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var d=this.type=a.type,g=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(Z){e:{try{z(h.nodeName);var I=!0;break e}catch{}I=!1}I||(h=null)}}else d=="mouseover"?h=a.fromElement:d=="mouseout"&&(h=a.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:_b[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&go.aa.h.call(this)}}P(go,Ze);var _b={2:"touch",3:"pen",4:"mouse"};go.prototype.h=function(){go.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var mo="closure_listenable_"+(1e6*Math.random()|0),vb=0;function wb(a,h,d,g,I){this.listener=a,this.proxy=null,this.src=h,this.type=d,this.capture=!!g,this.ha=I,this.key=++vb,this.da=this.fa=!1}function Du(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Iu(a){this.src=a,this.g={},this.h=0}Iu.prototype.add=function(a,h,d,g,I){var N=a.toString();a=this.g[N],a||(a=this.g[N]=[],this.h++);var V=ud(a,h,g,I);return-1<V?(h=a[V],d||(h.fa=!1)):(h=new wb(h,this.src,N,!!g,I),h.fa=d,a.push(h)),h};function ad(a,h){var d=h.type;if(d in a.g){var g=a.g[d],I=Array.prototype.indexOf.call(g,h,void 0),N;(N=0<=I)&&Array.prototype.splice.call(g,I,1),N&&(Du(h),a.g[d].length==0&&(delete a.g[d],a.h--))}}function ud(a,h,d,g){for(var I=0;I<a.length;++I){var N=a[I];if(!N.da&&N.listener==h&&N.capture==!!d&&N.ha==g)return I}return-1}var cd="closure_lm_"+(1e6*Math.random()|0),ld={};function a_(a,h,d,g,I){if(g&&g.once)return c_(a,h,d,g,I);if(Array.isArray(h)){for(var N=0;N<h.length;N++)a_(a,h[N],d,g,I);return null}return d=pd(d),a&&a[mo]?a.K(h,d,l(g)?!!g.capture:!!g,I):u_(a,h,d,!1,g,I)}function u_(a,h,d,g,I,N){if(!h)throw Error("Invalid event type");var V=l(I)?!!I.capture:!!I,me=dd(a);if(me||(a[cd]=me=new Iu(a)),d=me.add(h,d,g,V,N),d.proxy)return d;if(g=Eb(),d.proxy=g,g.src=a,g.listener=d,a.addEventListener)yb||(I=V),I===void 0&&(I=!1),a.addEventListener(h.toString(),g,I);else if(a.attachEvent)a.attachEvent(h_(h.toString()),g);else if(a.addListener&&a.removeListener)a.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return d}function Eb(){function a(d){return h.call(a.src,a.listener,d)}let h=Tb;return a}function c_(a,h,d,g,I){if(Array.isArray(h)){for(var N=0;N<h.length;N++)c_(a,h[N],d,g,I);return null}return d=pd(d),a&&a[mo]?a.L(h,d,l(g)?!!g.capture:!!g,I):u_(a,h,d,!0,g,I)}function l_(a,h,d,g,I){if(Array.isArray(h))for(var N=0;N<h.length;N++)l_(a,h[N],d,g,I);else g=l(g)?!!g.capture:!!g,d=pd(d),a&&a[mo]?(a=a.i,h=String(h).toString(),h in a.g&&(N=a.g[h],d=ud(N,d,g,I),-1<d&&(Du(N[d]),Array.prototype.splice.call(N,d,1),N.length==0&&(delete a.g[h],a.h--)))):a&&(a=dd(a))&&(h=a.g[h.toString()],a=-1,h&&(a=ud(h,d,g,I)),(d=-1<a?h[a]:null)&&hd(d))}function hd(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[mo])ad(h.i,a);else{var d=a.type,g=a.proxy;h.removeEventListener?h.removeEventListener(d,g,a.capture):h.detachEvent?h.detachEvent(h_(d),g):h.addListener&&h.removeListener&&h.removeListener(g),(d=dd(h))?(ad(d,a),d.h==0&&(d.src=null,h[cd]=null)):Du(a)}}}function h_(a){return a in ld?ld[a]:ld[a]="on"+a}function Tb(a,h){if(a.da)a=!0;else{h=new go(h,this);var d=a.listener,g=a.ha||a.src;a.fa&&hd(a),a=d.call(g,h)}return a}function dd(a){return a=a[cd],a instanceof Iu?a:null}var fd="__closure_events_fn_"+(1e9*Math.random()>>>0);function pd(a){return typeof a=="function"?a:(a[fd]||(a[fd]=function(h){return a.handleEvent(h)}),a[fd])}function Xe(){$n.call(this),this.i=new Iu(this),this.M=this,this.F=null}P(Xe,$n),Xe.prototype[mo]=!0,Xe.prototype.removeEventListener=function(a,h,d,g){l_(this,a,h,d,g)};function at(a,h){var d,g=a.F;if(g)for(d=[];g;g=g.F)d.push(g);if(a=a.M,g=h.type||h,typeof h=="string")h=new Ze(h,a);else if(h instanceof Ze)h.target=h.target||a;else{var I=h;h=new Ze(g,a),T(h,I)}if(I=!0,d)for(var N=d.length-1;0<=N;N--){var V=h.g=d[N];I=Au(V,g,!0,h)&&I}if(V=h.g=a,I=Au(V,g,!0,h)&&I,I=Au(V,g,!1,h)&&I,d)for(N=0;N<d.length;N++)V=h.g=d[N],I=Au(V,g,!1,h)&&I}Xe.prototype.N=function(){if(Xe.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var d=a.g[h],g=0;g<d.length;g++)Du(d[g]);delete a.g[h],a.h--}}this.F=null},Xe.prototype.K=function(a,h,d,g){return this.i.add(String(a),h,!1,d,g)},Xe.prototype.L=function(a,h,d,g){return this.i.add(String(a),h,!0,d,g)};function Au(a,h,d,g){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var I=!0,N=0;N<h.length;++N){var V=h[N];if(V&&!V.da&&V.capture==d){var me=V.listener,He=V.ha||V.src;V.fa&&ad(a.i,V),I=me.call(He,g)!==!1&&I}}return I&&!g.defaultPrevented}function d_(a,h,d){if(typeof a=="function")d&&(a=m(a,d));else if(a&&typeof a.handleEvent=="function")a=m(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:u.setTimeout(a,h||0)}function f_(a){a.g=d_(()=>{a.g=null,a.i&&(a.i=!1,f_(a))},a.l);let h=a.h;a.h=null,a.m.apply(null,h)}class Db extends $n{constructor(h,d){super(),this.m=h,this.l=d,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:f_(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yo(a){$n.call(this),this.h=a,this.g={}}P(yo,$n);var p_=[];function g_(a){X(a.g,function(h,d){this.g.hasOwnProperty(d)&&hd(h)},a),a.g={}}yo.prototype.N=function(){yo.aa.N.call(this),g_(this)},yo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gd=u.JSON.stringify,Ib=u.JSON.parse,Ab=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function md(){}md.prototype.h=null;function m_(a){return a.h||(a.h=a.i())}function y_(){}var _o={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function yd(){Ze.call(this,"d")}P(yd,Ze);function _d(){Ze.call(this,"c")}P(_d,Ze);var Nr={},__=null;function bu(){return __=__||new Xe}Nr.La="serverreachability";function v_(a){Ze.call(this,Nr.La,a)}P(v_,Ze);function vo(a){let h=bu();at(h,new v_(h))}Nr.STAT_EVENT="statevent";function w_(a,h){Ze.call(this,Nr.STAT_EVENT,a),this.stat=h}P(w_,Ze);function ut(a){let h=bu();at(h,new w_(h,a))}Nr.Ma="timingevent";function E_(a,h){Ze.call(this,Nr.Ma,a),this.size=h}P(E_,Ze);function wo(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},h)}function Eo(){this.g=!0}Eo.prototype.xa=function(){this.g=!1};function bb(a,h,d,g,I,N){a.info(function(){if(a.g)if(N)for(var V="",me=N.split("&"),He=0;He<me.length;He++){var le=me[He].split("=");if(1<le.length){var Je=le[0];le=le[1];var et=Je.split("_");V=2<=et.length&&et[1]=="type"?V+(Je+"="+le+"&"):V+(Je+"=redacted&")}}else V=null;else V=N;return"XMLHTTP REQ ("+g+") [attempt "+I+"]: "+h+`
`+d+`
`+V})}function Cb(a,h,d,g,I,N,V){a.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+I+"]: "+h+`
`+d+`
`+N+" "+V})}function Ci(a,h,d,g){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+Rb(a,d)+(g?" "+g:"")})}function Sb(a,h){a.info(function(){return"TIMEOUT: "+h})}Eo.prototype.info=function(){};function Rb(a,h){if(!a.g)return h;if(!h)return null;try{var d=JSON.parse(h);if(d){for(a=0;a<d.length;a++)if(Array.isArray(d[a])){var g=d[a];if(!(2>g.length)){var I=g[1];if(Array.isArray(I)&&!(1>I.length)){var N=I[0];if(N!="noop"&&N!="stop"&&N!="close")for(var V=1;V<I.length;V++)I[V]=""}}}}return gd(d)}catch{return h}}var Cu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},T_={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},vd;function Su(){}P(Su,md),Su.prototype.g=function(){return new XMLHttpRequest},Su.prototype.i=function(){return{}},vd=new Su;function zn(a,h,d,g){this.j=a,this.i=h,this.l=d,this.R=g||1,this.U=new yo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new D_}function D_(){this.i=null,this.g="",this.h=!1}var I_={},wd={};function Ed(a,h,d){a.L=1,a.v=Nu(wn(h)),a.m=d,a.P=!0,A_(a,null)}function A_(a,h){a.F=Date.now(),Ru(a),a.A=wn(a.v);var d=a.A,g=a.R;Array.isArray(g)||(g=[String(g)]),U_(d.i,"t",g),a.C=0,d=a.j.J,a.h=new D_,a.g=rv(a.j,d?h:null,!a.m),0<a.O&&(a.M=new Db(m(a.Y,a,a.g),a.O)),h=a.U,d=a.g,g=a.ca;var I="readystatechange";Array.isArray(I)||(I&&(p_[0]=I.toString()),I=p_);for(var N=0;N<I.length;N++){var V=a_(d,I[N],g||h.handleEvent,!1,h.h||h);if(!V)break;h.g[V.key]=V}h=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),vo(),bb(a.i,a.u,a.A,a.l,a.R,a.m)}zn.prototype.ca=function(a){a=a.target;let h=this.M;h&&En(a)==3?h.j():this.Y(a)},zn.prototype.Y=function(a){try{if(a==this.g)e:{let et=En(this.g);var h=this.g.Ba();let Pi=this.g.Z();if(!(3>et)&&(et!=3||this.g&&(this.h.h||this.g.oa()||H_(this.g)))){this.J||et!=4||h==7||(h==8||0>=Pi?vo(3):vo(2)),Td(this);var d=this.g.Z();this.X=d;t:if(b_(this)){var g=H_(this.g);a="";var I=g.length,N=En(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){kr(this),To(this);var V="";break t}this.h.i=new u.TextDecoder}for(h=0;h<I;h++)this.h.h=!0,a+=this.h.i.decode(g[h],{stream:!(N&&h==I-1)});g.length=0,this.h.g+=a,this.C=0,V=this.h.g}else V=this.g.oa();if(this.o=d==200,Cb(this.i,this.u,this.A,this.l,this.R,et,d),this.o){if(this.T&&!this.K){t:{if(this.g){var me,He=this.g;if((me=He.g?He.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(me)){var le=me;break t}}le=null}if(d=le)Ci(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Dd(this,d);else{this.o=!1,this.s=3,ut(12),kr(this),To(this);break e}}if(this.P){d=!0;let Ft;for(;!this.J&&this.C<V.length;)if(Ft=Pb(this,V),Ft==wd){et==4&&(this.s=4,ut(14),d=!1),Ci(this.i,this.l,null,"[Incomplete Response]");break}else if(Ft==I_){this.s=4,ut(15),Ci(this.i,this.l,V,"[Invalid Chunk]"),d=!1;break}else Ci(this.i,this.l,Ft,null),Dd(this,Ft);if(b_(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),et!=4||V.length!=0||this.h.h||(this.s=1,ut(16),d=!1),this.o=this.o&&d,!d)Ci(this.i,this.l,V,"[Invalid Chunked Response]"),kr(this),To(this);else if(0<V.length&&!this.W){this.W=!0;var Je=this.j;Je.g==this&&Je.ba&&!Je.M&&(Je.j.info("Great, no buffering proxy detected. Bytes received: "+V.length),Rd(Je),Je.M=!0,ut(11))}}else Ci(this.i,this.l,V,null),Dd(this,V);et==4&&kr(this),this.o&&!this.J&&(et==4?J_(this.j,this):(this.o=!1,Ru(this)))}else Wb(this.g),d==400&&0<V.indexOf("Unknown SID")?(this.s=3,ut(12)):(this.s=0,ut(13)),kr(this),To(this)}}}catch{}finally{}};function b_(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function Pb(a,h){var d=a.C,g=h.indexOf(`
`,d);return g==-1?wd:(d=Number(h.substring(d,g)),isNaN(d)?I_:(g+=1,g+d>h.length?wd:(h=h.slice(g,g+d),a.C=g+d,h)))}zn.prototype.cancel=function(){this.J=!0,kr(this)};function Ru(a){a.S=Date.now()+a.I,C_(a,a.I)}function C_(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=wo(m(a.ba,a),h)}function Td(a){a.B&&(u.clearTimeout(a.B),a.B=null)}zn.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(Sb(this.i,this.A),this.L!=2&&(vo(),ut(17)),kr(this),this.s=2,To(this)):C_(this,this.S-a)};function To(a){a.j.G==0||a.J||J_(a.j,a)}function kr(a){Td(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,g_(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Dd(a,h){try{var d=a.j;if(d.G!=0&&(d.g==a||Id(d.h,a))){if(!a.K&&Id(d.h,a)&&d.G==3){try{var g=d.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var I=g;if(I[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<a.F)Vu(d),Fu(d);else break e;Sd(d),ut(18)}}else d.za=I[1],0<d.za-d.T&&37500>I[2]&&d.F&&d.v==0&&!d.C&&(d.C=wo(m(d.Za,d),6e3));if(1>=P_(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else Fr(d,11)}else if((a.K||d.g==a)&&Vu(d),!G(h))for(I=d.Da.g.parse(h),h=0;h<I.length;h++){let le=I[h];if(d.T=le[0],le=le[1],d.G==2)if(le[0]=="c"){d.K=le[1],d.ia=le[2];let Je=le[3];Je!=null&&(d.la=Je,d.j.info("VER="+d.la));let et=le[4];et!=null&&(d.Aa=et,d.j.info("SVER="+d.Aa));let Pi=le[5];Pi!=null&&typeof Pi=="number"&&0<Pi&&(g=1.5*Pi,d.L=g,d.j.info("backChannelRequestTimeoutMs_="+g)),g=d;let Ft=a.g;if(Ft){let Uu=Ft.g?Ft.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Uu){var N=g.h;N.g||Uu.indexOf("spdy")==-1&&Uu.indexOf("quic")==-1&&Uu.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(Ad(N,N.h),N.h=null))}if(g.D){let Pd=Ft.g?Ft.g.getResponseHeader("X-HTTP-Session-Id"):null;Pd&&(g.ya=Pd,_e(g.I,g.D,Pd))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-a.F,d.j.info("Handshake RTT: "+d.R+"ms")),g=d;var V=a;if(g.qa=nv(g,g.J?g.ia:null,g.W),V.K){M_(g.h,V);var me=V,He=g.L;He&&(me.I=He),me.B&&(Td(me),Ru(me)),g.g=V}else Z_(g);0<d.i.length&&Ou(d)}else le[0]!="stop"&&le[0]!="close"||Fr(d,7);else d.G==3&&(le[0]=="stop"||le[0]=="close"?le[0]=="stop"?Fr(d,7):Cd(d):le[0]!="noop"&&d.l&&d.l.ta(le),d.v=0)}}vo(4)}catch{}}var Mb=class{constructor(a,h){this.g=a,this.map=h}};function S_(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function R_(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function P_(a){return a.h?1:a.g?a.g.size:0}function Id(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function Ad(a,h){a.g?a.g.add(h):a.h=h}function M_(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}S_.prototype.cancel=function(){if(this.i=N_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function N_(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(let d of a.g.values())h=h.concat(d.D);return h}return S(a.i)}function Nb(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var h=[],d=a.length,g=0;g<d;g++)h.push(a[g]);return h}h=[],d=0;for(g in a)h[d++]=a[g];return h}function kb(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var h=[];a=a.length;for(var d=0;d<a;d++)h.push(d);return h}h=[],d=0;for(let g in a)h[d++]=g;return h}}}function k_(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var d=kb(a),g=Nb(a),I=g.length,N=0;N<I;N++)h.call(void 0,g[N],d&&d[N],a)}var x_=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xb(a,h){if(a){a=a.split("&");for(var d=0;d<a.length;d++){var g=a[d].indexOf("="),I=null;if(0<=g){var N=a[d].substring(0,g);I=a[d].substring(g+1)}else N=a[d];h(N,I?decodeURIComponent(I.replace(/\+/g," ")):"")}}}function xr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof xr){this.h=a.h,Pu(this,a.j),this.o=a.o,this.g=a.g,Mu(this,a.s),this.l=a.l;var h=a.i,d=new Ao;d.i=h.i,h.g&&(d.g=new Map(h.g),d.h=h.h),F_(this,d),this.m=a.m}else a&&(h=String(a).match(x_))?(this.h=!1,Pu(this,h[1]||"",!0),this.o=Do(h[2]||""),this.g=Do(h[3]||"",!0),Mu(this,h[4]),this.l=Do(h[5]||"",!0),F_(this,h[6]||"",!0),this.m=Do(h[7]||"")):(this.h=!1,this.i=new Ao(null,this.h))}xr.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Io(h,O_,!0),":");var d=this.g;return(d||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Io(h,O_,!0),"@"),a.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&a.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(Io(d,d.charAt(0)=="/"?Vb:Ob,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",Io(d,Ub)),a.join("")};function wn(a){return new xr(a)}function Pu(a,h,d){a.j=d?Do(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function Mu(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function F_(a,h,d){h instanceof Ao?(a.i=h,Bb(a.i,a.h)):(d||(h=Io(h,Lb)),a.i=new Ao(h,a.h))}function _e(a,h,d){a.i.set(h,d)}function Nu(a){return _e(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Do(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Io(a,h,d){return typeof a=="string"?(a=encodeURI(a).replace(h,Fb),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Fb(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var O_=/[#\/\?@]/g,Ob=/[#\?:]/g,Vb=/[#\?]/g,Lb=/[#\?@]/g,Ub=/#/g;function Ao(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function qn(a){a.g||(a.g=new Map,a.h=0,a.i&&xb(a.i,function(h,d){a.add(decodeURIComponent(h.replace(/\+/g," ")),d)}))}n=Ao.prototype,n.add=function(a,h){qn(this),this.i=null,a=Si(this,a);var d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(h),this.h+=1,this};function V_(a,h){qn(a),h=Si(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function L_(a,h){return qn(a),h=Si(a,h),a.g.has(h)}n.forEach=function(a,h){qn(this),this.g.forEach(function(d,g){d.forEach(function(I){a.call(h,I,g,this)},this)},this)},n.na=function(){qn(this);let a=Array.from(this.g.values()),h=Array.from(this.g.keys()),d=[];for(let g=0;g<h.length;g++){let I=a[g];for(let N=0;N<I.length;N++)d.push(h[g])}return d},n.V=function(a){qn(this);let h=[];if(typeof a=="string")L_(this,a)&&(h=h.concat(this.g.get(Si(this,a))));else{a=Array.from(this.g.values());for(let d=0;d<a.length;d++)h=h.concat(a[d])}return h},n.set=function(a,h){return qn(this),this.i=null,a=Si(this,a),L_(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},n.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function U_(a,h,d){V_(a,h),0<d.length&&(a.i=null,a.g.set(Si(a,h),S(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],h=Array.from(this.g.keys());for(var d=0;d<h.length;d++){var g=h[d];let N=encodeURIComponent(String(g)),V=this.V(g);for(g=0;g<V.length;g++){var I=N;V[g]!==""&&(I+="="+encodeURIComponent(String(V[g]))),a.push(I)}}return this.i=a.join("&")};function Si(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function Bb(a,h){h&&!a.j&&(qn(a),a.i=null,a.g.forEach(function(d,g){var I=g.toLowerCase();g!=I&&(V_(this,g),U_(this,I,d))},a)),a.j=h}function jb(a,h){let d=new Eo;if(u.Image){let g=new Image;g.onload=w(Gn,d,"TestLoadImage: loaded",!0,h,g),g.onerror=w(Gn,d,"TestLoadImage: error",!1,h,g),g.onabort=w(Gn,d,"TestLoadImage: abort",!1,h,g),g.ontimeout=w(Gn,d,"TestLoadImage: timeout",!1,h,g),u.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=a}else h(!1)}function $b(a,h){let d=new Eo,g=new AbortController,I=setTimeout(()=>{g.abort(),Gn(d,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:g.signal}).then(N=>{clearTimeout(I),N.ok?Gn(d,"TestPingServer: ok",!0,h):Gn(d,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(I),Gn(d,"TestPingServer: error",!1,h)})}function Gn(a,h,d,g,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),g(d)}catch{}}function zb(){this.g=new Ab}function qb(a,h,d){let g=d||"";try{k_(a,function(I,N){let V=I;l(I)&&(V=gd(I)),h.push(g+N+"="+encodeURIComponent(V))})}catch(I){throw h.push(g+"type="+encodeURIComponent("_badmap")),I}}function bo(a){this.l=a.Ub||null,this.j=a.eb||!1}P(bo,md),bo.prototype.g=function(){return new ku(this.l,this.j)},bo.prototype.i=function(a){return function(){return a}}({});function ku(a,h){Xe.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(ku,Xe),n=ku.prototype,n.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,So(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||u).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Co(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,So(this)),this.g&&(this.readyState=3,So(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;B_(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function B_(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?Co(this):So(this),this.readyState==3&&B_(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,Co(this))},n.Qa=function(a){this.g&&(this.response=a,Co(this))},n.ga=function(){this.g&&Co(this)};function Co(a){a.readyState=4,a.l=null,a.j=null,a.v=null,So(a)}n.setRequestHeader=function(a,h){this.u.append(a,h)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],h=this.h.entries();for(var d=h.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=h.next();return a.join(`\r
`)};function So(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ku.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function j_(a){let h="";return X(a,function(d,g){h+=g,h+=":",h+=d,h+=`\r
`}),h}function bd(a,h,d){e:{for(g in d){var g=!1;break e}g=!0}g||(d=j_(d),typeof a=="string"?d!=null&&encodeURIComponent(String(d)):_e(a,h,d))}function Ce(a){Xe.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(Ce,Xe);var Gb=/^https?$/i,Hb=["POST","PUT"];n=Ce.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,h,d,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():vd.g(),this.v=this.o?m_(this.o):m_(vd),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(N){$_(this,N);return}if(a=d||"",d=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var I in g)d.set(I,g[I]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(let N of g.keys())d.set(N,g.get(N));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(d.keys()).find(N=>N.toLowerCase()=="content-type"),I=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Hb,h,void 0))||g||I||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[N,V]of d)this.g.setRequestHeader(N,V);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{G_(this),this.u=!0,this.g.send(a),this.u=!1}catch(N){$_(this,N)}};function $_(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,z_(a),xu(a)}function z_(a){a.A||(a.A=!0,at(a,"complete"),at(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,at(this,"complete"),at(this,"abort"),xu(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xu(this,!0)),Ce.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?q_(this):this.bb())},n.bb=function(){q_(this)};function q_(a){if(a.h&&typeof o<"u"&&(!a.v[1]||En(a)!=4||a.Z()!=2)){if(a.u&&En(a)==4)d_(a.Ea,0,a);else if(at(a,"readystatechange"),En(a)==4){a.h=!1;try{let V=a.Z();e:switch(V){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var d;if(!(d=h)){var g;if(g=V===0){var I=String(a.D).match(x_)[1]||null;!I&&u.self&&u.self.location&&(I=u.self.location.protocol.slice(0,-1)),g=!Gb.test(I?I.toLowerCase():"")}d=g}if(d)at(a,"complete"),at(a,"success");else{a.m=6;try{var N=2<En(a)?a.g.statusText:""}catch{N=""}a.l=N+" ["+a.Z()+"]",z_(a)}}finally{xu(a)}}}}function xu(a,h){if(a.g){G_(a);let d=a.g,g=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||at(a,"ready");try{d.onreadystatechange=g}catch{}}}function G_(a){a.I&&(u.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function En(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<En(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),Ib(h)}};function H_(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Wb(a){let h={};a=(a.g&&2<=En(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<a.length;g++){if(G(a[g]))continue;var d=D(a[g]);let I=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let N=h[I]||[];h[I]=N,N.push(d)}E(h,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ro(a,h,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||h}function W_(a){this.Aa=0,this.i=[],this.j=new Eo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ro("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ro("baseRetryDelayMs",5e3,a),this.cb=Ro("retryDelaySeedMs",1e4,a),this.Wa=Ro("forwardChannelMaxRetries",2,a),this.wa=Ro("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new S_(a&&a.concurrentRequestLimit),this.Da=new zb,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=W_.prototype,n.la=8,n.G=1,n.connect=function(a,h,d,g){ut(0),this.W=a,this.H=h||{},d&&g!==void 0&&(this.H.OSID=d,this.H.OAID=g),this.F=this.X,this.I=nv(this,null,this.W),Ou(this)};function Cd(a){if(K_(a),a.G==3){var h=a.U++,d=wn(a.I);if(_e(d,"SID",a.K),_e(d,"RID",h),_e(d,"TYPE","terminate"),Po(a,d),h=new zn(a,a.j,h),h.L=2,h.v=Nu(wn(d)),d=!1,u.navigator&&u.navigator.sendBeacon)try{d=u.navigator.sendBeacon(h.v.toString(),"")}catch{}!d&&u.Image&&(new Image().src=h.v,d=!0),d||(h.g=rv(h.j,null),h.g.ea(h.v)),h.F=Date.now(),Ru(h)}tv(a)}function Fu(a){a.g&&(Rd(a),a.g.cancel(),a.g=null)}function K_(a){Fu(a),a.u&&(u.clearTimeout(a.u),a.u=null),Vu(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Ou(a){if(!R_(a.h)&&!a.s){a.s=!0;var h=a.Ga;fo||o_(),po||(fo(),po=!0),od.add(h,a),a.B=0}}function Kb(a,h){return P_(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=wo(m(a.Ga,a,h),ev(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let I=new zn(this,this.j,a),N=this.o;if(this.S&&(N?(N=y(N),T(N,this.S)):N=this.S),this.m!==null||this.O||(I.H=N,N=null),this.P)e:{for(var h=0,d=0;d<this.i.length;d++){t:{var g=this.i[d];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=d;break e}if(h===4096||d===this.i.length-1){h=d+1;break e}}h=1e3}else h=1e3;h=Y_(this,I,h),d=wn(this.I),_e(d,"RID",a),_e(d,"CVER",22),this.D&&_e(d,"X-HTTP-Session-Id",this.D),Po(this,d),N&&(this.O?h="headers="+encodeURIComponent(String(j_(N)))+"&"+h:this.m&&bd(d,this.m,N)),Ad(this.h,I),this.Ua&&_e(d,"TYPE","init"),this.P?(_e(d,"$req",h),_e(d,"SID","null"),I.T=!0,Ed(I,d,null)):Ed(I,d,h),this.G=2}}else this.G==3&&(a?Q_(this,a):this.i.length==0||R_(this.h)||Q_(this))};function Q_(a,h){var d;h?d=h.l:d=a.U++;let g=wn(a.I);_e(g,"SID",a.K),_e(g,"RID",d),_e(g,"AID",a.T),Po(a,g),a.m&&a.o&&bd(g,a.m,a.o),d=new zn(a,a.j,d,a.B+1),a.m===null&&(d.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Y_(a,d,1e3),d.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Ad(a.h,d),Ed(d,g,h)}function Po(a,h){a.H&&X(a.H,function(d,g){_e(h,g,d)}),a.l&&k_({},function(d,g){_e(h,g,d)})}function Y_(a,h,d){d=Math.min(a.i.length,d);var g=a.l?m(a.l.Na,a.l,a):null;e:{var I=a.i;let N=-1;for(;;){let V=["count="+d];N==-1?0<d?(N=I[0].g,V.push("ofs="+N)):N=0:V.push("ofs="+N);let me=!0;for(let He=0;He<d;He++){let le=I[He].g,Je=I[He].map;if(le-=N,0>le)N=Math.max(0,I[He].g-100),me=!1;else try{qb(Je,V,"req"+le+"_")}catch{g&&g(Je)}}if(me){g=V.join("&");break e}}}return a=a.i.splice(0,d),h.D=a,g}function Z_(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;fo||o_(),po||(fo(),po=!0),od.add(h,a),a.v=0}}function Sd(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=wo(m(a.Fa,a),ev(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,X_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=wo(m(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ut(10),Fu(this),X_(this))};function Rd(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function X_(a){a.g=new zn(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=wn(a.qa);_e(h,"RID","rpc"),_e(h,"SID",a.K),_e(h,"AID",a.T),_e(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&_e(h,"TO",a.ja),_e(h,"TYPE","xmlhttp"),Po(a,h),a.m&&a.o&&bd(h,a.m,a.o),a.L&&(a.g.I=a.L);var d=a.g;a=a.ia,d.L=1,d.v=Nu(wn(h)),d.m=null,d.P=!0,A_(d,a)}n.Za=function(){this.C!=null&&(this.C=null,Fu(this),Sd(this),ut(19))};function Vu(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function J_(a,h){var d=null;if(a.g==h){Vu(a),Rd(a),a.g=null;var g=2}else if(Id(a.h,h))d=h.D,M_(a.h,h),g=1;else return;if(a.G!=0){if(h.o)if(g==1){d=h.m?h.m.length:0,h=Date.now()-h.F;var I=a.B;g=bu(),at(g,new E_(g,d)),Ou(a)}else Z_(a);else if(I=h.s,I==3||I==0&&0<h.X||!(g==1&&Kb(a,h)||g==2&&Sd(a)))switch(d&&0<d.length&&(h=a.h,h.i=h.i.concat(d)),I){case 1:Fr(a,5);break;case 4:Fr(a,10);break;case 3:Fr(a,6);break;default:Fr(a,2)}}}function ev(a,h){let d=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(d*=2),d*h}function Fr(a,h){if(a.j.info("Error code "+h),h==2){var d=m(a.fb,a),g=a.Xa;let I=!g;g=new xr(g||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Pu(g,"https"),Nu(g),I?jb(g.toString(),d):$b(g.toString(),d)}else ut(2);a.G=0,a.l&&a.l.sa(h),tv(a),K_(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),ut(2)):(this.j.info("Failed to ping google.com"),ut(1))};function tv(a){if(a.G=0,a.ka=[],a.l){let h=N_(a.h);(h.length!=0||a.i.length!=0)&&(A(a.ka,h),A(a.ka,a.i),a.h.i.length=0,S(a.i),a.i.length=0),a.l.ra()}}function nv(a,h,d){var g=d instanceof xr?wn(d):new xr(d);if(g.g!="")h&&(g.g=h+"."+g.g),Mu(g,g.s);else{var I=u.location;g=I.protocol,h=h?h+"."+I.hostname:I.hostname,I=+I.port;var N=new xr(null);g&&Pu(N,g),h&&(N.g=h),I&&Mu(N,I),d&&(N.l=d),g=N}return d=a.D,h=a.ya,d&&h&&_e(g,d,h),_e(g,"VER",a.la),Po(a,g),g}function rv(a,h,d){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new Ce(new bo({eb:d})):new Ce(a.pa),h.Ha(a.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function iv(){}n=iv.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Lu(){}Lu.prototype.g=function(a,h){return new wt(a,h)};function wt(a,h){Xe.call(this),this.g=new W_(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!G(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!G(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new Ri(this)}P(wt,Xe),wt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},wt.prototype.close=function(){Cd(this.g)},wt.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.u&&(d={},d.__data__=gd(a),a=d);h.i.push(new Mb(h.Ya++,a)),h.G==3&&Ou(h)},wt.prototype.N=function(){this.g.l=null,delete this.j,Cd(this.g),delete this.g,wt.aa.N.call(this)};function sv(a){yd.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(let d in h){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}P(sv,yd);function ov(){_d.call(this),this.status=1}P(ov,_d);function Ri(a){this.g=a}P(Ri,iv),Ri.prototype.ua=function(){at(this.g,"a")},Ri.prototype.ta=function(a){at(this.g,new sv(a))},Ri.prototype.sa=function(a){at(this.g,new ov)},Ri.prototype.ra=function(){at(this.g,"b")},Lu.prototype.createWebChannel=Lu.prototype.g,wt.prototype.send=wt.prototype.o,wt.prototype.open=wt.prototype.m,wt.prototype.close=wt.prototype.close,Cp=Mn.createWebChannelTransport=function(){return new Lu},bp=Mn.getStatEventTarget=function(){return bu()},Ap=Mn.Event=Nr,ml=Mn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Cu.NO_ERROR=0,Cu.TIMEOUT=8,Cu.HTTP_ERROR=6,Aa=Mn.ErrorCode=Cu,T_.COMPLETE="complete",Ip=Mn.EventType=T_,y_.EventType=_o,_o.OPEN="a",_o.CLOSE="b",_o.ERROR="c",_o.MESSAGE="d",Xe.prototype.listen=Xe.prototype.K,ls=Mn.WebChannel=y_,XP=Mn.FetchXmlHttpFactory=bo,Ce.prototype.listenOnce=Ce.prototype.L,Ce.prototype.getLastError=Ce.prototype.Ka,Ce.prototype.getLastErrorCode=Ce.prototype.Ba,Ce.prototype.getStatus=Ce.prototype.Z,Ce.prototype.getResponseJson=Ce.prototype.Oa,Ce.prototype.getResponseText=Ce.prototype.oa,Ce.prototype.send=Ce.prototype.ea,Ce.prototype.setWithCredentials=Ce.prototype.Ha,Dp=Mn.XhrIo=Ce}).apply(typeof gl<"u"?gl:typeof self<"u"?self:typeof window<"u"?window:{});var A0="@firebase/firestore",b0="4.7.10";var Oe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Oe.UNAUTHENTICATED=new Oe(null),Oe.GOOGLE_CREDENTIALS=new Oe("google-credentials-uid"),Oe.FIRST_PARTY=new Oe("first-party-uid"),Oe.MOCK_USER=new Oe("mock-user");var Qs="11.5.0";var gr=new rc("@firebase/firestore");function ys(){return gr.logLevel}function UT(n){gr.setLogLevel(n)}function F(n,...e){if(gr.logLevel<=Jt.DEBUG){let t=e.map(jm);gr.debug(`Firestore (${Qs}): ${n}`,...t)}}function Re(n,...e){if(gr.logLevel<=Jt.ERROR){let t=e.map(jm);gr.error(`Firestore (${Qs}): ${n}`,...t)}}function zt(n,...e){if(gr.logLevel<=Jt.WARN){let t=e.map(jm);gr.warn(`Firestore (${Qs}): ${n}`,...t)}}function jm(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function q(n="Unexpected state"){let e=`FIRESTORE (${Qs}) INTERNAL ASSERTION FAILED: `+n;throw Re(e),new Error(e)}function H(n,e){n||q()}function BT(n,e){n||q()}function U(n,e){return n}var M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends tc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ze=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Rl=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Fp=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Oe.UNAUTHENTICATED))}shutdown(){}},Op=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Vp=class{constructor(e){this.t=e,this.currentUser=Oe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){H(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new ze;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ze,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>R(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},u=c=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?u(c):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ze)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(H(typeof r.accessToken=="string"),new Rl(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return H(e===null||typeof e=="string"),new Oe(e)}},Lp=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Oe.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},Up=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Lp(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Oe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Pl=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Bp=class{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,sc(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){H(this.o===void 0);let r=s=>{s.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,F("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new Pl(this.V));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(H(typeof t.token=="string"),this.R=t.token,new Pl(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function JP(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function $m(){return new TextEncoder}var Ml=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=JP(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function ee(n,e){return n<e?-1:n>e?1:0}function jp(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return ee(r,i);{let s=$m(),o=eM(s.encode(C0(n,t)),s.encode(C0(e,t)));return o!==0?o:ee(r,i)}}t+=r>65535?2:1}return ee(n.length,e.length)}function C0(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function eM(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ee(n[t],e[t]);return ee(n.length,e.length)}function bs(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function jT(n){return n+"\0"}var S0=-62135596800,R0=1e6,Ie=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*R0);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<S0)throw new x(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/R0}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds-S0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var Y=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Ie(0,0))}static max(){return new n(new Ie(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var P0="__name__",Nl=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&q(),r===void 0?r=e.length-t:r>e.length-t&&q(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return ee(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):jp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Pn.fromString(e.substring(4,e.length-2))}},ae=class n extends Nl{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new x(M.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},tM=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Pe=class n extends Nl{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return tM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===P0}static keyField(){return new n([P0])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new x(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new x(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new x(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new x(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(ae.fromString(e))}static fromName(e){return new n(ae.fromString(e).popFirst(5))}static empty(){return new n(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ae(e.slice()))}};var Cs=-1,Ss=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function $p(n){return n.fields.find(e=>e.kind===2)}function ei(n){return n.fields.filter(e=>e.kind!==2)}Ss.UNKNOWN_ID=-1;var Ds=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var La=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,kt.min())}};function $T(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Y.fromTimestamp(r===1e9?new Ie(t+1,0):new Ie(t,r));return new kt(i,B.empty(),e)}function zT(n){return new kt(n.readTime,n.key,Cs)}var kt=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Y.min(),B.empty(),Cs)}static max(){return new n(Y.max(),B.empty(),Cs)}};function zm(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:ee(n.largestBatchId,e.largestBatchId))}var qT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",kl=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function br(n){return R(this,null,function*(){if(n.code!==M.FAILED_PRECONDITION||n.message!==qT)throw n;F("LocalStore","Unexpectedly lost primary lease")})}var C=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),u=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(f=>{o[l]=f,++u,u===s&&r(o)},f=>i(f))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var At="SimpleDb",xl=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new ui(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new ze,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new ui(e,t.error)):this.m.resolve()},this.transaction.onerror=r=>{let i=qm(r.target.error);this.m.reject(new ui(e,i))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(F(At,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new qp(t)}},mr=class n{static delete(e){return F(At,"Removing database:",e),ni(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!ec())return!1;if(n.v())return!0;let e=Uo(),t=n.C(e),r=0<t&&t<10,i=GT(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static C(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.O=r,n.C(Uo())===12.2&&Re("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}N(e){return R(this,null,function*(){return this.db||(F(At,"Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new ui(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new x(M.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new x(M.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ui(e,o))},i.onupgradeneeded=s=>{F(At,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.O.B(o,i.transaction,s.oldVersion,this.version).next(()=>{F(At,"Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=t=>this.L(t)),this.db})}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return R(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.N(e);let u=xl.open(this.db,e,s?"readonly":"readwrite",r),c=i(u).next(l=>(u.S(),l)).catch(l=>(u.abort(l),C.reject(l))).toPromise();return c.catch(()=>{}),yield u.p,c}catch(u){let c=u,l=c.name!=="FirebaseError"&&o<3;if(F(At,"Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function GT(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var zp=class{constructor(e){this.q=e,this.$=!1,this.U=null}get isDone(){return this.$}get K(){return this.U}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.U=e}delete(){return ni(this.q.delete())}},ui=class extends x{constructor(e,t){super(M.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Cr(n){return n.name==="IndexedDbTransactionError"}var qp=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(F(At,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(F(At,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ni(r)}add(e){return F(At,"ADD",this.store.name,e,e),ni(this.store.add(e))}get(e){return ni(this.store.get(e)).next(t=>(t===void 0&&(t=null),F(At,"GET",this.store.name,e,t),t))}delete(e){return F(At,"DELETE",this.store.name,e),ni(this.store.delete(e))}count(){return F(At,"COUNT",this.store.name),ni(this.store.count())}G(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new C((o,u)=>{s.onerror=c=>{u(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.j(s,(u,c)=>{o.push(c)}).next(()=>o)}}H(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new C((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}J(e,t){F(At,"DELETE ALL",this.store.name);let r=this.options(e,t);r.Y=!1;let i=this.cursor(r);return this.j(i,(s,o,u)=>u.delete())}Z(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.j(i,t)}X(e){let t=this.cursor({});return new C((r,i)=>{t.onerror=s=>{let o=qm(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(u=>{u?o.continue():r()}):r()}})}j(e,t){let r=[];return new C((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let u=o.target.result;if(!u)return void i();let c=new zp(u),l=t(u.primaryKey,u.value,c);if(l instanceof C){let f=l.catch(p=>(c.done(),C.reject(p)));r.push(f)}c.isDone?i():c.K===null?u.continue():u.continue(c.K)}}).next(()=>C.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function ni(n){return new C((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=qm(r.target.error);t(i)}})}var M0=!1;function qm(n){let e=mr.C(Uo());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new x("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return M0||(M0=!0,setTimeout(()=>{throw r},0)),r}}return n}var Na="IndexBackfiller",Gp=class{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}te(e){F(Na,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>R(this,null,function*(){this.task=null;try{let t=yield this.ee.ne();F(Na,`Documents written: ${t}`)}catch(t){Cr(t)?F(Na,"Ignoring IndexedDB error during index backfill: ",t):yield br(t)}yield this.te(6e4)}))}},Hp=class{constructor(e,t){this.localStore=e,this.persistence=t}ne(e=50){return R(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.re(t,e))})}re(e,t){let r=new Set,i=t,s=!0;return C.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return F(Na,`Processing collection: ${o}`),this.ie(e,o,i).next(u=>{i-=u,r.add(o)});s=!1})).next(()=>t-i)}ie(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.se(i,s)).next(u=>(F(Na,`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,t,u))).next(()=>o.size)}))}se(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=zT(s);zm(o,r)>0&&(r=o)}),new kt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var bt=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.oe(i),this._e=i=>r.writeSequenceNumber(i))}oe(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this._e&&this._e(t),t}}n.ae=-1;return n})(),fr=-1;function cu(n){return n==null}function Ua(n){return n===0&&1/n==-1/0}function HT(n){return typeof n=="number"&&Number.isInteger(n)&&!Ua(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Fl="";function ot(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=N0(e)),e=nM(n.get(t),e);return N0(e)}function nM(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case Fl:t+="";break;default:t+=s}}return t}function N0(n){return n+Fl+""}function an(n){let e=n.length;if(H(e>=2),e===2)return H(n.charAt(0)===Fl&&n.charAt(1)===""),ae.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf(Fl,s);switch((o<0||o>t)&&q(),n.charAt(o+1)){case"":let u=n.substring(s,o),c;i.length===0?c=u:(i+=u,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:q()}s=o+2}return new ae(r)}var ti="remoteDocuments",lu="owner",hs="owner",Ba="mutationQueues",rM="userId",$t="mutations",k0="batchId",oi="userMutationsIndex",x0=["userId","batchId"];function Tl(n,e){return[n,ot(e)]}function WT(n,e,t){return[n,ot(e),t]}var iM={},Rs="documentMutations",Ol="remoteDocumentsV14",sM=["prefixPath","collectionGroup","readTime","documentId"],Dl="documentKeyIndex",oM=["prefixPath","collectionGroup","documentId"],KT="collectionGroupIndex",aM=["collectionGroup","readTime","prefixPath","documentId"],ja="remoteDocumentGlobal",Wp="remoteDocumentGlobalKey",Ps="targets",QT="queryTargetsIndex",uM=["canonicalId","targetId"],Ms="targetDocuments",cM=["targetId","path"],Gm="documentTargetsIndex",lM=["path","targetId"],Vl="targetGlobalKey",ci="targetGlobal",$a="collectionParents",hM=["collectionId","parent"],Ns="clientMetadata",dM="clientId",kh="bundles",fM="bundleId",xh="namedQueries",pM="name",Hm="indexConfiguration",gM="indexId",Kp="collectionGroupIndex",mM="collectionGroup",Ll="indexState",yM=["indexId","uid"],YT="sequenceNumberIndex",_M=["uid","sequenceNumber"],Ul="indexEntries",vM=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ZT="documentKeyIndex",wM=["indexId","uid","orderedDocumentKey"],Fh="documentOverlays",EM=["userId","collectionPath","documentId"],Qp="collectionPathOverlayIndex",TM=["userId","collectionPath","largestBatchId"],XT="collectionGroupOverlayIndex",DM=["userId","collectionGroup","largestBatchId"],Wm="globals",IM="name",JT=[Ba,$t,Rs,ti,Ps,lu,ci,Ms,Ns,ja,$a,kh,xh],AM=[...JT,Fh],eD=[Ba,$t,Rs,Ol,Ps,lu,ci,Ms,Ns,ja,$a,kh,xh,Fh],tD=eD,Km=[...tD,Hm,Ll,Ul],bM=Km,CM=[...Km,Wm];var za=class extends kl{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}};function qe(n,e){let t=U(n);return mr.M(t.ue,e)}function F0(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Sr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function nD(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ve=class n{constructor(e,t){this.comparator=e,this.root=t||cn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ts(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ts(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ts(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ts(this.root,e,this.comparator,!0)}},Ts=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},cn=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();let e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}};cn.EMPTY=null,cn.RED=!0,cn.BLACK=!1;cn.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(e,t,r,i,s){return this}insert(e,t,r){return new cn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ge=class n{constructor(e){this.comparator=e,this.data=new ve(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Bl(this.data.getIterator())}getIteratorFrom(e){return new Bl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Bl=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function ds(n){return n.hasNext()?n.getNext():void 0}var Ct=class n{constructor(e){this.fields=e,e.sort(Pe.comparator)}static empty(){return new n([])}unionWith(e){let t=new ge(Pe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return bs(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var jl=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function rD(){return typeof atob<"u"}var Ne=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new jl("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ne.EMPTY_BYTE_STRING=new Ne("");var SM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xn(n){if(H(!!n),typeof n=="string"){let e=0,t=SM.exec(n);if(H(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:we(n.seconds),nanos:we(n.nanos)}}function we(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Fn(n){return typeof n=="string"?Ne.fromBase64String(n):Ne.fromUint8Array(n)}var iD="server_timestamp",sD="__type__",oD="__previous_value__",aD="__local_write_time__";function Oh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[sD])===null||t===void 0?void 0:t.stringValue)===iD}function Vh(n){let e=n.mapValue.fields[oD];return Oh(e)?Vh(e):e}function qa(n){let e=xn(n.mapValue.fields[aD].timestampValue);return new Ie(e.seconds,e.nanos)}var Yp=class{constructor(e,t,r,i,s,o,u,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=l}},Zp="(default)",yr=class n{constructor(e,t){this.projectId=e,this.database=t||Zp}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Zp}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Qm="__type__",uD="__max__",hr={mapValue:{fields:{__type__:{stringValue:uD}}}},Ym="__vector__",ks="value",Il={nullValue:"NULL_VALUE"};function _r(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Oh(n)?4:cD(n)?9007199254740991:Lh(n)?10:11:q()}function dn(n,e){if(n===e)return!0;let t=_r(n);if(t!==_r(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return qa(n).isEqual(qa(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=xn(i.timestampValue),u=xn(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Fn(i.bytesValue).isEqual(Fn(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return we(i.geoPointValue.latitude)===we(s.geoPointValue.latitude)&&we(i.geoPointValue.longitude)===we(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return we(i.integerValue)===we(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=we(i.doubleValue),u=we(s.doubleValue);return o===u?Ua(o)===Ua(u):isNaN(o)&&isNaN(u)}return!1}(n,e);case 9:return bs(n.arrayValue.values||[],e.arrayValue.values||[],dn);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(F0(o)!==F0(u))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!dn(o[c],u[c])))return!1;return!0}(n,e);default:return q()}}function Ga(n,e){return(n.values||[]).find(t=>dn(t,e))!==void 0}function vr(n,e){if(n===e)return 0;let t=_r(n),r=_r(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return function(s,o){let u=we(s.integerValue||s.doubleValue),c=we(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(n,e);case 3:return O0(n.timestampValue,e.timestampValue);case 4:return O0(qa(n),qa(e));case 5:return jp(n.stringValue,e.stringValue);case 6:return function(s,o){let u=Fn(s),c=Fn(o);return u.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let u=s.split("/"),c=o.split("/");for(let l=0;l<u.length&&l<c.length;l++){let f=ee(u[l],c[l]);if(f!==0)return f}return ee(u.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let u=ee(we(s.latitude),we(o.latitude));return u!==0?u:ee(we(s.longitude),we(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return V0(n.arrayValue,e.arrayValue);case 10:return function(s,o){var u,c,l,f;let p=s.fields||{},m=o.fields||{},w=(u=p[ks])===null||u===void 0?void 0:u.arrayValue,P=(c=m[ks])===null||c===void 0?void 0:c.arrayValue,S=ee(((l=w?.values)===null||l===void 0?void 0:l.length)||0,((f=P?.values)===null||f===void 0?void 0:f.length)||0);return S!==0?S:V0(w,P)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===hr.mapValue&&o===hr.mapValue)return 0;if(s===hr.mapValue)return 1;if(o===hr.mapValue)return-1;let u=s.fields||{},c=Object.keys(u),l=o.fields||{},f=Object.keys(l);c.sort(),f.sort();for(let p=0;p<c.length&&p<f.length;++p){let m=jp(c[p],f[p]);if(m!==0)return m;let w=vr(u[c[p]],l[f[p]]);if(w!==0)return w}return ee(c.length,f.length)}(n.mapValue,e.mapValue);default:throw q()}}function O0(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);let t=xn(n),r=xn(e),i=ee(t.seconds,r.seconds);return i!==0?i:ee(t.nanos,r.nanos)}function V0(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=vr(t[i],r[i]);if(s)return s}return ee(t.length,r.length)}function xs(n){return Xp(n)}function Xp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=xn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Fn(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Xp(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Xp(t.fields[o])}`;return i+"}"}(n.mapValue):q()}function Al(n){switch(_r(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Vh(n);return e?16+Al(e):16;case 5:return 2*n.stringValue.length;case 6:return Fn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Al(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Sr(r.fields,(s,o)=>{i+=s.length+Al(o)}),i}(n.mapValue);default:throw q()}}function li(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Jp(n){return!!n&&"integerValue"in n}function Ha(n){return!!n&&"arrayValue"in n}function L0(n){return!!n&&"nullValue"in n}function U0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function bl(n){return!!n&&"mapValue"in n}function Lh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Qm])===null||t===void 0?void 0:t.stringValue)===Ym}function ka(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Sr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ka(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ka(n.arrayValue.values[t]);return e}return Object.assign({},n)}function cD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===uD}var lD={mapValue:{fields:{[Qm]:{stringValue:Ym},[ks]:{arrayValue:{}}}}};function RM(n){return"nullValue"in n?Il:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?li(yr.empty(),B.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Lh(n)?lD:{mapValue:{}}:q()}function PM(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?li(yr.empty(),B.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?lD:"mapValue"in n?Lh(n)?{mapValue:{}}:hr:q()}function B0(n,e){let t=vr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function j0(n,e){let t=vr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var st=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!bl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ka(t)}setAll(e){let t=Pe.emptyPath(),r={},i=[];e.forEach((o,u)=>{if(!t.isImmediateParentOf(u)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=u.popLast()}o?r[u.lastSegment()]=ka(o):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());bl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return dn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];bl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Sr(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(ka(this.value))}};function hD(n){let e=[];return Sr(n.fields,(t,r)=>{let i=new Pe([t]);if(bl(r)){let s=hD(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Ct(e)}var Ve=class n{constructor(e,t,r,i,s,o,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new n(e,0,Y.min(),Y.min(),Y.min(),st.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Y.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Y.min(),Y.min(),st.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Y.min(),Y.min(),st.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Y.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=st.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=st.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var fn=class{constructor(e,t){this.position=e,this.inclusive=t}};function $0(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=B.comparator(B.fromName(o.referenceValue),t.key):r=vr(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function z0(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!dn(n.position[t],e.position[t]))return!1;return!0}var hi=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function MM(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var $l=class{},se=class n extends $l{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new ng(e,t,r):t==="array-contains"?new sg(e,r):t==="in"?new zl(e,r):t==="not-in"?new og(e,r):t==="array-contains-any"?new ag(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new rg(e,r):new ig(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(vr(t,this.value)):t!==null&&_r(this.value)===_r(t)&&this.matchesComparison(vr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},pe=class n extends $l{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new n(e,t)}matches(e){return Fs(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}};function Fs(n){return n.op==="and"}function eg(n){return n.op==="or"}function Zm(n){return dD(n)&&Fs(n)}function dD(n){for(let e of n.filters)if(e instanceof pe)return!1;return!0}function tg(n){if(n instanceof se)return n.field.canonicalString()+n.op.toString()+xs(n.value);if(Zm(n))return n.filters.map(e=>tg(e)).join(",");{let e=n.filters.map(t=>tg(t)).join(",");return`${n.op}(${e})`}}function fD(n,e){return n instanceof se?function(r,i){return i instanceof se&&r.op===i.op&&r.field.isEqual(i.field)&&dn(r.value,i.value)}(n,e):n instanceof pe?function(r,i){return i instanceof pe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&fD(o,i.filters[u]),!0):!1}(n,e):void q()}function pD(n,e){let t=n.filters.concat(e);return pe.create(t,n.op)}function gD(n){return n instanceof se?function(t){return`${t.field.canonicalString()} ${t.op} ${xs(t.value)}`}(n):n instanceof pe?function(t){return t.op.toString()+" {"+t.getFilters().map(gD).join(" ,")+"}"}(n):"Filter"}var ng=class extends se{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},rg=class extends se{constructor(e,t){super(e,"in",t),this.keys=mD("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ig=class extends se{constructor(e,t){super(e,"not-in",t),this.keys=mD("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function mD(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var sg=class extends se{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ha(t)&&Ga(t.arrayValue,this.value)}},zl=class extends se{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ga(this.value.arrayValue,t)}},og=class extends se{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ga(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ga(this.value.arrayValue,t)}},ag=class extends se{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ha(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ga(this.value.arrayValue,r))}};var ug=class{constructor(e,t=null,r=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.le=null}};function cg(n,e=null,t=[],r=[],i=null,s=null,o=null){return new ug(n,e,t,r,i,s,o)}function di(n){let e=U(n);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>tg(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),cu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>xs(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>xs(r)).join(",")),e.le=t}return e.le}function hu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!MM(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!fD(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!z0(n.startAt,e.startAt)&&z0(n.endAt,e.endAt)}function ql(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Gl(n,e){return n.filters.filter(t=>t instanceof se&&t.field.isEqual(e))}function q0(n,e,t){let r=Il,i=!0;for(let s of Gl(n,e)){let o=Il,u=!0;switch(s.op){case"<":case"<=":o=RM(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,u=!1;break;case"!=":case"not-in":o=Il}B0({value:r,inclusive:i},{value:o,inclusive:u})<0&&(r=o,i=u)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];B0({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function G0(n,e,t){let r=hr,i=!0;for(let s of Gl(n,e)){let o=hr,u=!0;switch(s.op){case">=":case">":o=PM(s.value),u=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,u=!1;break;case"!=":case"not-in":o=hr}j0({value:r,inclusive:i},{value:o,inclusive:u})>0&&(r=o,i=u)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];j0({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var qt=class{constructor(e,t=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}};function yD(n,e,t,r,i,s,o,u){return new qt(n,e,t,r,i,s,o,u)}function Ys(n){return new qt(n)}function H0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Xm(n){return n.collectionGroup!==null}function Is(n){let e=U(n);if(e.he===null){e.he=[];let t=new Set;for(let s of e.explicitOrderBy)e.he.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new ge(Pe.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(u=u.add(l.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.he.push(new hi(s,r))}),t.has(Pe.keyField().canonicalString())||e.he.push(new hi(Pe.keyField(),r))}return e.he}function dt(n){let e=U(n);return e.Pe||(e.Pe=NM(e,Is(n))),e.Pe}function NM(n,e){if(n.limitType==="F")return cg(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new hi(i.field,s)});let t=n.endAt?new fn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new fn(n.startAt.position,n.startAt.inclusive):null;return cg(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function lg(n,e){let t=n.filters.concat([e]);return new qt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Hl(n,e,t){return new qt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function du(n,e){return hu(dt(n),dt(e))&&n.limitType===e.limitType}function _D(n){return`${di(dt(n))}|lt:${n.limitType}`}function _s(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>gD(i)).join(", ")}]`),cu(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>xs(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>xs(i)).join(",")),`Target(${r})`}(dt(n))}; limitType=${n.limitType})`}function fu(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):B.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of Is(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,u,c){let l=$0(o,u,c);return o.inclusive?l<=0:l<0}(r.startAt,Is(r),i)||r.endAt&&!function(o,u,c){let l=$0(o,u,c);return o.inclusive?l>=0:l>0}(r.endAt,Is(r),i))}(n,e)}function vD(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wD(n){return(e,t)=>{let r=!1;for(let i of Is(n)){let s=kM(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function kM(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(s,o,u){let c=o.data.field(s),l=u.data.field(s);return c!==null&&l!==null?vr(c,l):q()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return q()}}var Gt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Sr(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return nD(this.inner)}size(){return this.innerSize}};var xM=new ve(B.comparator);function _t(){return xM}var ED=new ve(B.comparator);function Pa(...n){let e=ED;for(let t of n)e=e.insert(t.key,t);return e}function TD(n){let e=ED;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function un(){return xa()}function DD(){return xa()}function xa(){return new Gt(n=>n.toString(),(n,e)=>n.isEqual(e))}var FM=new ve(B.comparator),OM=new ge(B.comparator);function ne(...n){let e=OM;for(let t of n)e=e.add(t);return e}var VM=new ge(ee);function Jm(){return VM}function ey(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ua(e)?"-0":e}}function ID(n){return{integerValue:""+n}}function AD(n,e){return HT(e)?ID(e):ey(n,e)}var Os=class{constructor(){this._=void 0}};function LM(n,e,t){return n instanceof wr?function(i,s){let o={fields:{[sD]:{stringValue:iD},[aD]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Oh(s)&&(s=Vh(s)),s&&(o.fields[oD]=s),{mapValue:o}}(t,e):n instanceof On?CD(n,e):n instanceof Vn?SD(n,e):function(i,s){let o=bD(i,s),u=W0(o)+W0(i.Ie);return Jp(o)&&Jp(i.Ie)?ID(u):ey(i.serializer,u)}(n,e)}function UM(n,e,t){return n instanceof On?CD(n,e):n instanceof Vn?SD(n,e):t}function bD(n,e){return n instanceof Er?function(r){return Jp(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var wr=class extends Os{},On=class extends Os{constructor(e){super(),this.elements=e}};function CD(n,e){let t=RD(e);for(let r of n.elements)t.some(i=>dn(i,r))||t.push(r);return{arrayValue:{values:t}}}var Vn=class extends Os{constructor(e){super(),this.elements=e}};function SD(n,e){let t=RD(e);for(let r of n.elements)t=t.filter(i=>!dn(i,r));return{arrayValue:{values:t}}}var Er=class extends Os{constructor(e,t){super(),this.serializer=e,this.Ie=t}};function W0(n){return we(n.integerValue||n.doubleValue)}function RD(n){return Ha(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var fi=class{constructor(e,t){this.field=e,this.transform=t}};function BM(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof On&&i instanceof On||r instanceof Vn&&i instanceof Vn?bs(r.elements,i.elements,dn):r instanceof Er&&i instanceof Er?dn(r.Ie,i.Ie):r instanceof wr&&i instanceof wr}(n.transform,e.transform)}var hg=class{constructor(e,t){this.version=e,this.transformResults=t}},Se=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Cl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Vs=class{};function PD(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Dr(n.key,Se.none()):new Tr(n.key,n.data,Se.none());{let t=n.data,r=st.empty(),i=new ge(Pe.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ht(n.key,r,new Ct(i.toArray()),Se.none())}}function jM(n,e,t){n instanceof Tr?function(i,s,o){let u=i.value.clone(),c=Q0(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Ht?function(i,s,o){if(!Cl(i.precondition,s))return void s.convertToUnknownDocument(o.version);let u=Q0(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(MD(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Fa(n,e,t,r){return n instanceof Tr?function(s,o,u,c){if(!Cl(s.precondition,o))return u;let l=s.value.clone(),f=Y0(s.fieldTransforms,c,o);return l.setAll(f),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Ht?function(s,o,u,c){if(!Cl(s.precondition,o))return u;let l=Y0(s.fieldTransforms,c,o),f=o.data;return f.setAll(MD(s)),f.setAll(l),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(s,o,u){return Cl(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u}(n,e,t)}function $M(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=bD(r.transform,i||null);s!=null&&(t===null&&(t=st.empty()),t.set(r.field,s))}return t||null}function K0(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&bs(r,i,(s,o)=>BM(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Tr=class extends Vs{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Ht=class extends Vs{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function MD(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Q0(n,e,t){let r=new Map;H(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,u=e.data.field(s.field);r.set(s.field,UM(o,u,t[i]))}return r}function Y0(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,LM(s,o,e))}return r}var Dr=class extends Vs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Wa=class extends Vs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Ka=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&jM(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Fa(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Fa(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=DD();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,u=this.applyToLocalView(o,s.mutatedFields);u=t.has(i.key)?null:u;let c=PD(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Y.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ne())}isEqual(e){return this.batchId===e.batchId&&bs(this.mutations,e.mutations,(t,r)=>K0(t,r))&&bs(this.baseMutations,e.baseMutations,(t,r)=>K0(t,r))}},dg=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){H(e.mutations.length===r.length);let i=function(){return FM}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Qa=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var fg=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var xe,oe;function ND(n){switch(n){case M.OK:return q();case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return q()}}function kD(n){if(n===void 0)return Re("GRPC error has no .code"),M.UNKNOWN;switch(n){case xe.OK:return M.OK;case xe.CANCELLED:return M.CANCELLED;case xe.UNKNOWN:return M.UNKNOWN;case xe.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case xe.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case xe.INTERNAL:return M.INTERNAL;case xe.UNAVAILABLE:return M.UNAVAILABLE;case xe.UNAUTHENTICATED:return M.UNAUTHENTICATED;case xe.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case xe.NOT_FOUND:return M.NOT_FOUND;case xe.ALREADY_EXISTS:return M.ALREADY_EXISTS;case xe.PERMISSION_DENIED:return M.PERMISSION_DENIED;case xe.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case xe.ABORTED:return M.ABORTED;case xe.OUT_OF_RANGE:return M.OUT_OF_RANGE;case xe.UNIMPLEMENTED:return M.UNIMPLEMENTED;case xe.DATA_LOSS:return M.DATA_LOSS;default:return q()}}(oe=xe||(xe={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";var Z0=null;var zM=new Pn([4294967295,4294967295],0);function X0(n){let e=$m().encode(n),t=new Tp;return t.update(e),new Uint8Array(t.digest())}function J0(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Pn([t,r],0),new Pn([i,s],0)]}var pg=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ai(`Invalid padding: ${t}`);if(r<0)throw new ai(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ai(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ai(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=Pn.fromNumber(this.Ee)}Ae(e,t,r){let i=e.add(t.multiply(Pn.fromNumber(r)));return i.compare(zM)===1&&(i=new Pn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;let t=X0(e),[r,i]=J0(t);for(let s=0;s<this.hashCount;s++){let o=this.Ae(r,i,s);if(!this.Re(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(u=>o.insert(u)),o}insert(e){if(this.Ee===0)return;let t=X0(e),[r,i]=J0(t);for(let s=0;s<this.hashCount;s++){let o=this.Ae(r,i,s);this.Ve(o)}}Ve(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},ai=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ya=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Za.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(Y.min(),i,new ve(ee),_t(),ne())}},Za=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ne(),ne(),ne())}};var As=class{constructor(e,t,r,i){this.me=e,this.removedTargetIds=t,this.key=r,this.fe=i}},Wl=class{constructor(e,t){this.targetId=e,this.ge=t}},Kl=class{constructor(e,t,r=Ne.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ql=class{constructor(){this.pe=0,this.ye=eT(),this.we=Ne.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=ne(),t=ne(),r=ne();return this.ye.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:q()}}),new Za(this.we,this.Se,e,t,r)}Me(){this.be=!1,this.ye=eT()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,H(this.pe>=0)}Le(){this.be=!0,this.Se=!0}},gg=class{constructor(e){this.ke=e,this.qe=new Map,this.Qe=_t(),this.$e=yl(),this.Ue=yl(),this.Ke=new ve(ee)}We(e){for(let t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(let t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{let r=this.He(t);switch(e.state){case 0:this.Je(t)&&r.Ce(e.resumeToken);break;case 1:r.Be(),r.De||r.Me(),r.Ce(e.resumeToken);break;case 2:r.Be(),r.De||this.removeTarget(t);break;case 3:this.Je(t)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),r.Ce(e.resumeToken));break;default:q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((r,i)=>{this.Je(i)&&t(i)})}Ze(e){let t=e.targetId,r=e.ge.count,i=this.Xe(t);if(i){let s=i.target;if(ql(s))if(r===0){let o=new B(s.path);this.ze(t,o,Ve.newNoDocument(o,Y.min()))}else H(r===1);else{let o=this.et(t);if(o!==r){let u=this.tt(e),c=u?this.nt(u,e,o):1;if(c!==0){this.Ye(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,l)}Z0?.rt(function(f,p,m,w,P){var S,A,j,G,k,z;let Z={localCacheCount:f,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},X=p.unchangedNames;return X&&(Z.bloomFilter={applied:P===0,hashCount:(S=X?.hashCount)!==null&&S!==void 0?S:0,bitmapLength:(G=(j=(A=X?.bits)===null||A===void 0?void 0:A.bitmap)===null||j===void 0?void 0:j.length)!==null&&G!==void 0?G:0,padding:(z=(k=X?.bits)===null||k===void 0?void 0:k.padding)!==null&&z!==void 0?z:0,mightContain:E=>{var y;return(y=w?.mightContain(E))!==null&&y!==void 0&&y}}),Z}(o,e.ge,this.ke.it(),u,c))}}}}tt(e){let t=e.ge.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,u;try{o=Fn(r).toUint8Array()}catch(c){if(c instanceof jl)return zt("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new pg(o,i,s)}catch(c){return zt(c instanceof ai?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ee===0?null:u}nt(e,t,r){return t.ge.count===r-this.st(e,t.targetId)?0:2}st(e,t){let r=this.ke.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.ke.it(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.ze(t,s,null),i++)}),i}ot(e){let t=new Map;this.qe.forEach((s,o)=>{let u=this.Xe(o);if(u){if(s.current&&ql(u.target)){let c=new B(u.target.path);this._t(c).has(o)||this.ut(o,c)||this.ze(o,c,Ve.newNoDocument(c,e))}s.ve&&(t.set(o,s.Fe()),s.Me())}});let r=ne();this.Ue.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{let l=this.Xe(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.Qe.forEach((s,o)=>o.setReadTime(e));let i=new Ya(e,t,this.Ke,this.Qe,r);return this.Qe=_t(),this.$e=yl(),this.Ue=yl(),this.Ke=new ve(ee),i}Ge(e,t){if(!this.Je(e))return;let r=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,r),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,r){if(!this.Je(e))return;let i=this.He(e);this.ut(e,t)?i.xe(t,1):i.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),r&&(this.Qe=this.Qe.insert(t,r))}removeTarget(e){this.qe.delete(e)}et(e){let t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Ql,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new ge(ee),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new ge(ee),this.$e=this.$e.insert(e,t)),t}Je(e){let t=this.Xe(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){let t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Ql),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}};function yl(){return new ve(B.comparator)}function eT(){return new ve(B.comparator)}var qM={asc:"ASCENDING",desc:"DESCENDING"},GM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HM={and:"AND",or:"OR"},mg=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function yg(n,e){return n.useProto3Json||cu(e)?e:{value:e}}function Ls(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xD(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function WM(n,e){return Ls(n,e.toTimestamp())}function Me(n){return H(!!n),Y.fromTimestamp(function(t){let r=xn(t);return new Ie(r.seconds,r.nanos)}(n))}function ty(n,e){return _g(n,e).canonicalString()}function _g(n,e){let t=function(i){return new ae(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function FD(n){let e=ae.fromString(n);return H(GD(e)),e}function Xa(n,e){return ty(n.databaseId,e.path)}function ln(n,e){let t=FD(e);if(t.get(1)!==n.databaseId.projectId)throw new x(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(LD(t))}function OD(n,e){return ty(n.databaseId,e)}function VD(n){let e=FD(n);return e.length===4?ae.emptyPath():LD(e)}function vg(n){return new ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function LD(n){return H(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function tT(n,e,t){return{name:Xa(n,e),fields:t.value.mapValue.fields}}function UD(n,e,t){let r=ln(n,e.name),i=Me(e.updateTime),s=e.createTime?Me(e.createTime):Y.min(),o=new st({mapValue:{fields:e.fields}}),u=Ve.newFoundDocument(r,i,s,o);return t&&u.setHasCommittedMutations(),t?u.setHasCommittedMutations():u}function KM(n,e){return"found"in e?function(r,i){H(!!i.found),i.found.name,i.found.updateTime;let s=ln(r,i.found.name),o=Me(i.found.updateTime),u=i.found.createTime?Me(i.found.createTime):Y.min(),c=new st({mapValue:{fields:i.found.fields}});return Ve.newFoundDocument(s,o,u,c)}(n,e):"missing"in e?function(r,i){H(!!i.missing),H(!!i.readTime);let s=ln(r,i.missing),o=Me(i.readTime);return Ve.newNoDocument(s,o)}(n,e):q()}function QM(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,f){return l.useProto3Json?(H(f===void 0||typeof f=="string"),Ne.fromBase64String(f||"")):(H(f===void 0||f instanceof Buffer||f instanceof Uint8Array),Ne.fromUint8Array(f||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&function(l){let f=l.code===void 0?M.UNKNOWN:kD(l.code);return new x(f,l.message||"")}(o);t=new Kl(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=ln(n,r.document.name),s=Me(r.document.updateTime),o=r.document.createTime?Me(r.document.createTime):Y.min(),u=new st({mapValue:{fields:r.document.fields}}),c=Ve.newFoundDocument(i,s,o,u),l=r.targetIds||[],f=r.removedTargetIds||[];t=new As(l,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=ln(n,r.document),s=r.readTime?Me(r.readTime):Y.min(),o=Ve.newNoDocument(i,s),u=r.removedTargetIds||[];t=new As([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=ln(n,r.document),s=r.removedTargetIds||[];t=new As([],s,i,null)}else{if(!("filter"in e))return q();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new fg(i,s),u=r.targetId;t=new Wl(u,o)}}return t}function Ja(n,e){let t;if(e instanceof Tr)t={update:tT(n,e.key,e.value)};else if(e instanceof Dr)t={delete:Xa(n,e.key)};else if(e instanceof Ht)t={update:tT(n,e.key,e.data),updateMask:tN(e.fieldMask)};else{if(!(e instanceof Wa))return q();t={verify:Xa(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let u=o.transform;if(u instanceof wr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof On)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Vn)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Er)return{fieldPath:o.field.canonicalString(),increment:u.Ie};throw q()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:WM(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:q()}(n,e.precondition)),t}function wg(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?Se.updateTime(Me(s.updateTime)):s.exists!==void 0?Se.exists(s.exists):Se.none()}(e.currentDocument):Se.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,u){let c=null;if("setToServerValue"in u)H(u.setToServerValue==="REQUEST_TIME"),c=new wr;else if("appendMissingElements"in u){let f=u.appendMissingElements.values||[];c=new On(f)}else if("removeAllFromArray"in u){let f=u.removeAllFromArray.values||[];c=new Vn(f)}else"increment"in u?c=new Er(o,u.increment):q();let l=Pe.fromServerFormat(u.fieldPath);return new fi(l,c)}(n,i)):[];if(e.update){e.update.name;let i=ln(n,e.update.name),s=new st({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new Ct(l.map(f=>Pe.fromServerFormat(f)))}(e.updateMask);return new Ht(i,s,o,t,r)}return new Tr(i,s,t,r)}if(e.delete){let i=ln(n,e.delete);return new Dr(i,t)}if(e.verify){let i=ln(n,e.verify);return new Wa(i,t)}return q()}function YM(n,e){return n&&n.length>0?(H(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?Me(i.updateTime):Me(s);return o.isEqual(Y.min())&&(o=Me(s)),new hg(o,i.transformResults||[])}(t,e))):[]}function BD(n,e){return{documents:[OD(n,e.path)]}}function jD(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=OD(n,i);let s=function(l){if(l.length!==0)return qD(pe.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(f=>function(m){return{field:vs(m.field),direction:XM(m.dir)}}(f))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let u=yg(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{ht:t,parent:i}}function $D(n){let e=VD(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){H(r===1);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(p){let m=zD(p);return m instanceof pe&&Zm(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(m=>function(P){return new hi(ws(P.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(m))}(t.orderBy));let u=null;t.limit&&(u=function(p){let m;return m=typeof p=="object"?p.value:p,cu(m)?null:m}(t.limit));let c=null;t.startAt&&(c=function(p){let m=!!p.before,w=p.values||[];return new fn(w,m)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let m=!p.before,w=p.values||[];return new fn(w,m)}(t.endAt)),yD(e,i,o,s,u,"F",c,l)}function ZM(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function zD(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ws(t.unaryFilter.field);return se.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ws(t.unaryFilter.field);return se.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ws(t.unaryFilter.field);return se.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ws(t.unaryFilter.field);return se.create(o,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(n):n.fieldFilter!==void 0?function(t){return se.create(ws(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return pe.create(t.compositeFilter.filters.map(r=>zD(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return q()}}(t.compositeFilter.op))}(n):q()}function XM(n){return qM[n]}function JM(n){return GM[n]}function eN(n){return HM[n]}function vs(n){return{fieldPath:n.canonicalString()}}function ws(n){return Pe.fromServerFormat(n.fieldPath)}function qD(n){return n instanceof se?function(t){if(t.op==="=="){if(U0(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NAN"}};if(L0(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(U0(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NOT_NAN"}};if(L0(t.value))return{unaryFilter:{field:vs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vs(t.field),op:JM(t.op),value:t.value}}}(n):n instanceof pe?function(t){let r=t.getFilters().map(i=>qD(i));return r.length===1?r[0]:{compositeFilter:{op:eN(t.op),filters:r}}}(n):q()}function tN(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function GD(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Us=class n{constructor(e,t,r,i,s=Y.min(),o=Y.min(),u=Ne.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Yl=class{constructor(e){this.Tt=e}};function nN(n,e){let t;if(e.document)t=UD(n.Tt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=B.fromSegments(e.noDocument.path),i=gi(e.noDocument.readTime);t=Ve.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return q();{let r=B.fromSegments(e.unknownDocument.path),i=gi(e.unknownDocument.version);t=Ve.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new Ie(i[0],i[1]);return Y.fromTimestamp(s)}(e.readTime)),t}function nT(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Zl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Xa(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ls(s,o.version.toTimestamp()),createTime:Ls(s,o.createTime.toTimestamp())}}(n.Tt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:pi(e.version)};else{if(!e.isUnknownDocument())return q();r.unknownDocument={path:t.path.toArray(),version:pi(e.version)}}return r}function Zl(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function pi(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function gi(n){let e=new Ie(n.seconds,n.nanoseconds);return Y.fromTimestamp(e)}function ri(n,e){let t=(e.baseMutations||[]).map(s=>wg(n.Tt,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let u=e.mutations[s+1];o.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>wg(n.Tt,s)),i=Ie.fromMillis(e.localWriteTimeMs);return new Ka(e.batchId,i,t,r)}function Ma(n){let e=gi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?gi(n.lastLimboFreeSnapshotVersion):Y.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return H(s.documents.length===1),dt(Ys(VD(s.documents[0])))}(n.query):function(s){return dt($D(s))}(n.query),new Us(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ne.fromBase64String(n.resumeToken))}function HD(n,e){let t=pi(e.snapshotVersion),r=pi(e.lastLimboFreeSnapshotVersion),i;i=ql(e.target)?BD(n.Tt,e.target):jD(n.Tt,e.target).ht;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:di(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function ny(n){let e=$D({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Hl(e,e.limit,"L"):e}function Sp(n,e){return new Qa(e.largestBatchId,wg(n.Tt,e.overlayMutation))}function rT(n,e){let t=e.path.lastSegment();return[n,ot(e.path.popLast()),t]}function iT(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:pi(r.readTime),documentKey:ot(r.documentKey.path),largestBatchId:r.largestBatchId}}var Eg=class{getBundleMetadata(e,t){return sT(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:gi(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return sT(e).put(function(i){return{bundleId:i.id,createTime:pi(Me(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return oT(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:ny(s.bundledQuery),readTime:gi(s.readTime)}}(r)})}saveNamedQuery(e,t){return oT(e).put(function(i){return{name:i.name,readTime:pi(Me(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function sT(n){return qe(n,kh)}function oT(n){return qe(n,xh)}var Xl=class n{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return ba(e).get(rT(this.userId,t)).next(r=>r?Sp(this.serializer,r):null)}getOverlays(e,t){let r=un();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let u=new Qa(t,o);i.push(this.Et(e,u))}),C.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(ot(o.getCollectionPath())));let s=[];return i.forEach(o=>{let u=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(ba(e).J(Qp,u))}),C.waitFor(s)}getOverlaysForCollection(e,t,r){let i=un(),s=ot(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ba(e).G(Qp,o).next(u=>{for(let c of u){let l=Sp(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=un(),o,u=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ba(e).Z({index:XT,range:u},(c,l,f)=>{let p=Sp(this.serializer,l);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):f.done()}).next(()=>s)}Et(e,t){return ba(e).put(function(i,s,o){let[u,c,l]=rT(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ja(i.Tt,o.mutation)}}(this.serializer,this.userId,t))}};function ba(n){return qe(n,Fh)}var Tg=class{dt(e){return qe(e,Wm)}getSessionToken(e){return this.dt(e).get("sessionToken").next(t=>{let r=t?.value;return r?Ne.fromUint8Array(r):Ne.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Nn=class{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(we(e.integerValue));else if("doubleValue"in e){let r=we(e.doubleValue);isNaN(r)?this.ft(t,13):(this.ft(t,15),Ua(r)?t.gt(0):t.gt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.ft(t,20),typeof r=="string"&&(r=xn(r)),t.yt(`${r.seconds||""}`),t.gt(r.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(Fn(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.ft(t,45),t.gt(r.latitude||0),t.gt(r.longitude||0)}else"mapValue"in e?cD(e)?this.ft(t,Number.MAX_SAFE_INTEGER):Lh(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):q()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){let r=e.fields||{};this.ft(t,55);for(let i of Object.keys(r))this.wt(i,t),this.Rt(r[i],t)}vt(e,t){var r,i;let s=e.fields||{};this.ft(t,53);let o=ks,u=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.ft(t,15),t.gt(we(u)),this.wt(o,t),this.Rt(s[o],t)}Ft(e,t){let r=e.values||[];this.ft(t,50);for(let i of r)this.Rt(i,t)}Dt(e,t){this.ft(t,37),B.fromName(e).path.forEach(r=>{this.ft(t,60),this.Mt(r,t)})}ft(e,t){e.gt(t)}St(e){e.gt(2)}};Nn.xt=new Nn;var fs=255;function rN(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function aT(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=rN(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var Dg=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Nt(r.value),r=t.next();this.Bt()}Lt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.kt(r.value),r=t.next();this.qt()}Qt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Nt(r);else if(r<2048)this.Nt(960|r>>>6),this.Nt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Nt(480|r>>>12),this.Nt(128|63&r>>>6),this.Nt(128|63&r);else{let i=t.codePointAt(0);this.Nt(240|i>>>18),this.Nt(128|63&i>>>12),this.Nt(128|63&i>>>6),this.Nt(128|63&i)}}this.Bt()}$t(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.kt(r);else if(r<2048)this.kt(960|r>>>6),this.kt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.kt(480|r>>>12),this.kt(128|63&r>>>6),this.kt(128|63&r);else{let i=t.codePointAt(0);this.kt(240|i>>>18),this.kt(128|63&i>>>12),this.kt(128|63&i>>>6),this.kt(128|63&i)}}this.qt()}Ut(e){let t=this.Kt(e),r=aT(t);this.Wt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Gt(e){let t=this.Kt(e),r=aT(t);this.Wt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}zt(){this.jt(fs),this.jt(255)}Ht(){this.Jt(fs),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Kt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Nt(e){let t=255&e;t===0?(this.jt(0),this.jt(255)):t===fs?(this.jt(fs),this.jt(0)):this.jt(t)}kt(e){let t=255&e;t===0?(this.Jt(0),this.Jt(255)):t===fs?(this.Jt(fs),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Ig=class{constructor(e){this.Zt=e}bt(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Ut(e)}Vt(){this.Zt.zt()}},Ag=class{constructor(e){this.Zt=e}bt(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}},ii=class{constructor(){this.Zt=new Dg,this.Xt=new Ig(this.Zt),this.en=new Ag(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return e===0?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}};var si=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}nn(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function ar(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=uT(n.arrayValue,e.arrayValue),t!==0?t:(t=uT(n.directionalValue,e.directionalValue),t!==0?t:B.comparator(n.documentKey,e.documentKey)))}function uT(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Jl=class{constructor(e){this.rn=new ge((t,r)=>Pe.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(let t of e.filters){let r=t;r.isInequality()?this.rn=this.rn.add(r):this._n.push(r)}}get an(){return this.rn.size>1}un(e){if(H(e.collectionGroup===this.collectionId),this.an)return!1;let t=$p(e);if(t!==void 0&&!this.cn(t))return!1;let r=ei(e),i=new Set,s=0,o=0;for(;s<r.length&&this.cn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.rn.size>0){let u=this.rn.getIterator().getNext();if(!i.has(u.field.canonicalString())){let c=r[s];if(!this.ln(u,c)||!this.hn(this.sn[o++],c))return!1}++s}for(;s<r.length;++s){let u=r[s];if(o>=this.sn.length||!this.hn(this.sn[o++],u))return!1}return!0}Pn(){if(this.an)return null;let e=new ge(Pe.comparator),t=[];for(let r of this._n)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Ds(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ds(r.field,0))}for(let r of this.sn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ds(r.field,r.dir==="asc"?0:1)));return new Ss(Ss.UNKNOWN_ID,this.collectionId,t,La.empty())}cn(e){for(let t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function WD(n){var e,t;if(H(n instanceof se||n instanceof pe),n instanceof se){if(n instanceof zl){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>se.create(n.field,"==",s)))||[];return pe.create(i,"or")}return n}let r=n.filters.map(i=>WD(i));return pe.create(r,n.op)}function iN(n){if(n.getFilters().length===0)return[];let e=Sg(WD(n));return H(KD(e)),bg(e)||Cg(e)?[e]:e.getFilters()}function bg(n){return n instanceof se}function Cg(n){return n instanceof pe&&Zm(n)}function KD(n){return bg(n)||Cg(n)||function(t){if(t instanceof pe&&eg(t)){for(let r of t.getFilters())if(!bg(r)&&!Cg(r))return!1;return!0}return!1}(n)}function Sg(n){if(H(n instanceof se||n instanceof pe),n instanceof se)return n;if(n.filters.length===1)return Sg(n.filters[0]);let e=n.filters.map(r=>Sg(r)),t=pe.create(e,n.op);return t=eh(t),KD(t)?t:(H(t instanceof pe),H(Fs(t)),H(t.filters.length>1),t.filters.reduce((r,i)=>ry(r,i)))}function ry(n,e){let t;return H(n instanceof se||n instanceof pe),H(e instanceof se||e instanceof pe),t=n instanceof se?e instanceof se?function(i,s){return pe.create([i,s],"and")}(n,e):cT(n,e):e instanceof se?cT(e,n):function(i,s){if(H(i.filters.length>0&&s.filters.length>0),Fs(i)&&Fs(s))return pD(i,s.getFilters());let o=eg(i)?i:s,u=eg(i)?s:i,c=o.filters.map(l=>ry(l,u));return pe.create(c,"or")}(n,e),eh(t)}function cT(n,e){if(Fs(e))return pD(e,n.getFilters());{let t=e.filters.map(r=>ry(n,r));return pe.create(t,"or")}}function eh(n){if(H(n instanceof se||n instanceof pe),n instanceof se)return n;let e=n.getFilters();if(e.length===1)return eh(e[0]);if(dD(n))return n;let t=e.map(i=>eh(i)),r=[];return t.forEach(i=>{i instanceof se?r.push(i):i instanceof pe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:pe.create(r,n.op)}var Rg=class{constructor(){this.Tn=new eu}addToCollectionParentIndex(e,t){return this.Tn.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return C.resolve()}deleteFieldIndex(e,t){return C.resolve()}deleteAllFieldIndexes(e){return C.resolve()}createTargetIndexes(e,t){return C.resolve()}getDocumentsMatchingTarget(e,t){return C.resolve(null)}getIndexType(e,t){return C.resolve(0)}getFieldIndexes(e,t){return C.resolve([])}getNextCollectionGroupToUpdate(e){return C.resolve(null)}getMinOffset(e,t){return C.resolve(kt.min())}getMinOffsetFromCollectionGroup(e,t){return C.resolve(kt.min())}updateCollectionGroup(e,t,r){return C.resolve()}updateIndexEntries(e,t){return C.resolve()}},eu=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new ge(ae.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new ge(ae.comparator)).toArray()}};var lT="IndexedDbIndexManager",_l=new Uint8Array(0),Pg=class{constructor(e,t){this.databaseId=t,this.In=new eu,this.En=new Gt(r=>di(r),(r,i)=>hu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.In.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.In.add(t)});let s={collectionId:r,parent:ot(i)};return hT(e).put(s)}return C.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[jT(t),""],!1,!0);return hT(e).G(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(an(o.parent))}return r})}addFieldIndex(e,t){let r=Ca(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=gs(e);return s.next(u=>{o.put(iT(u,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=Ca(e),i=gs(e),s=ps(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Ca(e),r=ps(e),i=gs(e);return t.J().next(()=>r.J()).next(()=>i.J())}createTargetIndexes(e,t){return C.forEach(this.dn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Jl(r).Pn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=ps(e),i=!0,s=new Map;return C.forEach(this.dn(t),o=>this.An(e,o).next(u=>{i&&(i=!!u),s.set(o,u)})).next(()=>{if(i){let o=ne(),u=[];return C.forEach(s,(c,l)=>{F(lT,`Using index ${function(k){return`id=${k.indexId}|cg=${k.collectionGroup}|f=${k.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(c)} to execute ${di(t)}`);let f=function(k,z){let Z=$p(z);if(Z===void 0)return null;for(let X of Gl(k,Z.fieldPath))switch(X.op){case"array-contains-any":return X.value.arrayValue.values||[];case"array-contains":return[X.value]}return null}(l,c),p=function(k,z){let Z=new Map;for(let X of ei(z))for(let E of Gl(k,X.fieldPath))switch(E.op){case"==":case"in":Z.set(X.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return Z.set(X.fieldPath.canonicalString(),E.value),Array.from(Z.values())}return null}(l,c),m=function(k,z){let Z=[],X=!0;for(let E of ei(z)){let y=E.kind===0?q0(k,E.fieldPath,k.startAt):G0(k,E.fieldPath,k.startAt);Z.push(y.value),X&&(X=y.inclusive)}return new fn(Z,X)}(l,c),w=function(k,z){let Z=[],X=!0;for(let E of ei(z)){let y=E.kind===0?G0(k,E.fieldPath,k.endAt):q0(k,E.fieldPath,k.endAt);Z.push(y.value),X&&(X=y.inclusive)}return new fn(Z,X)}(l,c),P=this.Rn(c,l,m),S=this.Rn(c,l,w),A=this.Vn(c,l,p),j=this.mn(c.indexId,f,P,m.inclusive,S,w.inclusive,A);return C.forEach(j,G=>r.H(G,t.limit).next(k=>{k.forEach(z=>{let Z=B.fromSegments(z.documentKey);o.has(Z)||(o=o.add(Z),u.push(Z))})}))}).next(()=>u)}return C.resolve(null)})}dn(e){let t=this.En.get(e);return t||(e.filters.length===0?t=[e]:t=iN(pe.create(e.filters,"and")).map(r=>cg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.En.set(e,t),t)}mn(e,t,r,i,s,o,u){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),f=[];for(let p=0;p<c;++p){let m=t?this.fn(t[p/l]):_l,w=this.gn(e,m,r[p%l],i),P=this.pn(e,m,s[p%l],o),S=u.map(A=>this.gn(e,m,A,!0));f.push(...this.createRange(w,P,S))}return f}gn(e,t,r,i){let s=new si(e,B.empty(),t,r);return i?s:s.nn()}pn(e,t,r,i){let s=new si(e,B.empty(),t,r);return i?s.nn():s}An(e,t){let r=new Jl(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let u of s)r.un(u)&&(!o||u.fields.length>o.fields.length)&&(o=u);return o})}getIndexType(e,t){let r=2,i=this.dn(t);return C.forEach(i,s=>this.An(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new ge(Pe.comparator),f=!1;for(let p of c.filters)for(let m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?f=!0:l=l.add(m.field));for(let p of c.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(f?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}yn(e,t){let r=new ii;for(let i of ei(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.tn(i.kind);Nn.xt.At(s,o)}return r.Yt()}fn(e){let t=new ii;return Nn.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){let r=new ii;return Nn.xt.At(li(this.databaseId,t),r.tn(function(s){let o=ei(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Yt()}Vn(e,t,r){if(r===null)return[];let i=[];i.push(new ii);let s=0;for(let o of ei(e)){let u=r[s++];for(let c of i)if(this.Sn(t,o.fieldPath)&&Ha(u))i=this.bn(i,o,u);else{let l=c.tn(o.kind);Nn.xt.At(u,l)}}return this.Dn(i)}Rn(e,t,r){return this.Vn(e,t,r.position)}Dn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Yt();return t}bn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let u of i){let c=new ii;c.seed(u.Yt()),Nn.xt.At(o,c.tn(t.kind)),s.push(c)}return s}Sn(e,t){return!!e.filters.find(r=>r instanceof se&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Ca(e),i=gs(e);return(t?r.G(Kp,IDBKeyRange.bound(t,t)):r.G()).next(s=>{let o=[];return C.forEach(s,u=>i.get([u.indexId,this.uid]).next(c=>{o.push(function(f,p){let m=p?new La(p.sequenceNumber,new kt(gi(p.readTime),new B(an(p.documentKey)),p.largestBatchId)):La.empty(),w=f.fields.map(([P,S])=>new Ds(Pe.fromServerFormat(P),S));return new Ss(f.indexId,f.collectionGroup,w,m)}(u,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ee(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Ca(e),s=gs(e);return this.vn(e).next(o=>i.G(Kp,IDBKeyRange.bound(t,t)).next(u=>C.forEach(u,c=>s.put(iT(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return C.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?C.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(r.set(i.collectionGroup,u),C.forEach(u,c=>this.Cn(e,i,c).next(l=>{let f=this.Fn(s,c);return l.isEqual(f)?C.resolve():this.Mn(e,s,c,l,f)}))))})}xn(e,t,r,i){return ps(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.wn(r,t.key),documentKey:t.key.path.toArray()})}On(e,t,r,i){return ps(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.wn(r,t.key),t.key.path.toArray()])}Cn(e,t,r){let i=ps(e),s=new ge(ar);return i.Z({index:ZT,range:IDBKeyRange.only([r.indexId,this.uid,this.wn(r,t)])},(o,u)=>{s=s.add(new si(r.indexId,t,u.arrayValue,u.directionalValue))}).next(()=>s)}Fn(e,t){let r=new ge(ar),i=this.yn(t,e);if(i==null)return r;let s=$p(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Ha(o))for(let u of o.arrayValue.values||[])r=r.add(new si(t.indexId,e.key,this.fn(u),i))}else r=r.add(new si(t.indexId,e.key,_l,i));return r}Mn(e,t,r,i,s){F(lT,"Updating index entries for document '%s'",t.key);let o=[];return function(c,l,f,p,m){let w=c.getIterator(),P=l.getIterator(),S=ds(w),A=ds(P);for(;S||A;){let j=!1,G=!1;if(S&&A){let k=f(S,A);k<0?G=!0:k>0&&(j=!0)}else S!=null?G=!0:j=!0;j?(p(A),A=ds(P)):G?(m(S),S=ds(w)):(S=ds(w),A=ds(P))}}(i,s,ar,u=>{o.push(this.xn(e,t,r,u))},u=>{o.push(this.On(e,t,r,u))}),C.waitFor(o)}vn(e){let t=1;return gs(e).Z({index:YT,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,u)=>ar(o,u)).filter((o,u,c)=>!u||ar(o,c[u-1])!==0);let i=[];i.push(e);for(let o of r){let u=ar(o,e),c=ar(o,t);if(u===0)i[0]=e.nn();else if(u>0&&c<0)i.push(o),i.push(o.nn());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Nn(i[o],i[o+1]))return[];let u=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,_l,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,_l,[]];s.push(IDBKeyRange.bound(u,c))}return s}Nn(e,t){return ar(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(dT)}getMinOffset(e,t){return C.mapArray(this.dn(t),r=>this.An(e,r).next(i=>i||q())).next(dT)}};function hT(n){return qe(n,$a)}function ps(n){return qe(n,Ul)}function Ca(n){return qe(n,Hm)}function gs(n){return qe(n,Ll)}function dT(n){H(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;zm(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new kt(e.readTime,e.documentKey,t)}var fT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},QD=41943040,yt=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function YD(n,e,t){let r=n.store($t),i=n.store(Rs),s=[],o=IDBKeyRange.only(t.batchId),u=0,c=r.Z({range:o},(f,p,m)=>(u++,m.delete()));s.push(c.next(()=>{H(u===1)}));let l=[];for(let f of t.mutations){let p=WT(e,f.key.path,t.batchId);s.push(i.delete(p)),l.push(f.key)}return C.waitFor(s).next(()=>l)}function th(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw q();e=n.noDocument}return JSON.stringify(e).length}yt.DEFAULT_COLLECTION_PERCENTILE=10,yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yt.DEFAULT=new yt(QD,yt.DEFAULT_COLLECTION_PERCENTILE,yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yt.DISABLED=new yt(-1,0,0);var nh=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Bn={}}static It(e,t,r,i){H(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ur(e).Z({index:oi,range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=Es(e),o=ur(e);return o.add({}).next(u=>{H(typeof u=="number");let c=new Ka(u,t,r,i),l=function(w,P,S){let A=S.baseMutations.map(G=>Ja(w.Tt,G)),j=S.mutations.map(G=>Ja(w.Tt,G));return{userId:P,batchId:S.batchId,localWriteTimeMs:S.localWriteTime.toMillis(),baseMutations:A,mutations:j}}(this.serializer,this.userId,c),f=[],p=new ge((m,w)=>ee(m.canonicalString(),w.canonicalString()));for(let m of i){let w=WT(this.userId,m.key.path,u);p=p.add(m.key.path.popLast()),f.push(o.put(l)),f.push(s.put(w,iM))}return p.forEach(m=>{f.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Bn[u]=c.keys()}),C.waitFor(f).next(()=>c)})}lookupMutationBatch(e,t){return ur(e).get(t).next(r=>r?(H(r.userId===this.userId),ri(this.serializer,r)):null)}Ln(e,t){return this.Bn[t]?C.resolve(this.Bn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Bn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ur(e).Z({index:oi,range:i},(o,u,c)=>{u.userId===this.userId&&(H(u.batchId>=r),s=ri(this.serializer,u)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=fr;return ur(e).Z({index:oi,range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,fr],[this.userId,Number.POSITIVE_INFINITY]);return ur(e).G(oi,t).next(r=>r.map(i=>ri(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Tl(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Es(e).Z({range:i},(o,u,c)=>{let[l,f,p]=o,m=an(f);if(l===this.userId&&t.path.isEqual(m))return ur(e).get(p).next(w=>{if(!w)throw q();H(w.userId===this.userId),s.push(ri(this.serializer,w))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ge(ee),i=[];return t.forEach(s=>{let o=Tl(this.userId,s.path),u=IDBKeyRange.lowerBound(o),c=Es(e).Z({range:u},(l,f,p)=>{let[m,w,P]=l,S=an(w);m===this.userId&&s.path.isEqual(S)?r=r.add(P):p.done()});i.push(c)}),C.waitFor(i).next(()=>this.kn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Tl(this.userId,r),o=IDBKeyRange.lowerBound(s),u=new ge(ee);return Es(e).Z({range:o},(c,l,f)=>{let[p,m,w]=c,P=an(m);p===this.userId&&r.isPrefixOf(P)?P.length===i&&(u=u.add(w)):f.done()}).next(()=>this.kn(e,u))}kn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(ur(e).get(s).next(o=>{if(o===null)throw q();H(o.userId===this.userId),r.push(ri(this.serializer,o))}))}),C.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return YD(e.ue,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.qn(t.batchId)}),C.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}qn(e){delete this.Bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return C.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Es(e).Z({range:r},(s,o,u)=>{if(s[0]===this.userId){let c=an(s[1]);i.push(c)}else u.done()}).next(()=>{H(i.length===0)})})}containsKey(e,t){return ZD(e,this.userId,t)}Qn(e){return XD(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:fr,lastStreamToken:""})}};function ZD(n,e,t){let r=Tl(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Es(n).Z({range:s,Y:!0},(u,c,l)=>{let[f,p,m]=u;f===e&&p===i&&(o=!0),l.done()}).next(()=>o)}function ur(n){return qe(n,$t)}function Es(n){return qe(n,Rs)}function XD(n){return qe(n,Ba)}var Bs=class n{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new n(0)}static Kn(){return new n(-1)}};var Mg=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Wn(e).next(t=>{let r=new Bs(t.highestTargetId);return t.highestTargetId=r.next(),this.Gn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Wn(e).next(t=>Y.fromTimestamp(new Ie(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Wn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Wn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Gn(e,i)))}addTargetData(e,t){return this.zn(e,t).next(()=>this.Wn(e).next(r=>(r.targetCount+=1,this.jn(t,r),this.Gn(e,r))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ms(e).delete(t.targetId)).next(()=>this.Wn(e)).next(r=>(H(r.targetCount>0),r.targetCount-=1,this.Gn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return ms(e).Z((o,u)=>{let c=Ma(u);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>C.waitFor(s)).next(()=>i)}forEachTarget(e,t){return ms(e).Z((r,i)=>{let s=Ma(i);t(s)})}Wn(e){return pT(e).get(Vl).next(t=>(H(t!==null),t))}Gn(e,t){return pT(e).put(Vl,t)}zn(e,t){return ms(e).put(HD(this.serializer,t))}jn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Wn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=di(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return ms(e).Z({range:i,index:QT},(o,u,c)=>{let l=Ma(u);hu(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=lr(e);return t.forEach(o=>{let u=ot(o.path);i.push(s.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,o))}),C.waitFor(i)}removeMatchingKeys(e,t,r){let i=lr(e);return C.forEach(t,s=>{let o=ot(s.path);return C.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=lr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=lr(e),s=ne();return i.Z({range:r,Y:!0},(o,u,c)=>{let l=an(o[1]),f=new B(l);s=s.add(f)}).next(()=>s)}containsKey(e,t){let r=ot(t.path),i=IDBKeyRange.bound([r],[jT(r)],!1,!0),s=0;return lr(e).Z({index:Gm,Y:!0,range:i},([o,u],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}lt(e,t){return ms(e).get(t).next(r=>r?Ma(r):null)}};function ms(n){return qe(n,Ps)}function pT(n){return qe(n,ci)}function lr(n){return qe(n,Ms)}var gT="LruGarbageCollector",sN=1048576;function mT([n,e],[t,r]){let i=ee(n,t);return i===0?ee(e,r):i}var Ng=class{constructor(e){this.Hn=e,this.buffer=new ge(mT),this.Jn=0}Yn(){return++this.Jn}Zn(e){let t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();mT(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},rh=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){F(gT,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>R(this,null,function*(){this.Xn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Cr(t)?F(gT,"Ignoring IndexedDB error during garbage collection: ",t):yield br(t)}yield this.er(3e5)}))}},kg=class{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return C.resolve(bt.ae);let r=new Ng(t);return this.tr.forEachTarget(e,i=>r.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>r.Zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.tr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(F("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(fT)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(F("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fT):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let r,i,s,o,u,c,l,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(F("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,u=Date.now(),this.removeTargets(e,r,t))).next(p=>(s=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),ys()<=Jt.DEBUG&&F("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(c-u)+`ms
	Removed ${p} documents in `+(l-c)+`ms
Total Duration: ${l-f}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}};function JD(n,e){return new kg(n,e)}var xg=class{constructor(e,t){this.db=e,this.garbageCollector=JD(this,t)}nr(e){let t=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}sr(e){let t=0;return this.rr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,t){return this._r(e,(r,i)=>t(i))}addReference(e,t,r){return vl(e,r)}removeReference(e,t,r){return vl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return vl(e,t)}ar(e,t){return function(i,s){let o=!1;return XD(i).X(u=>ZD(i,u,s).next(c=>(c&&(o=!0),C.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this._r(e,(o,u)=>{if(u<=t){let c=this.ar(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Y.min()),lr(e).delete(function(p){return[0,ot(p.path)]}(o))))});i.push(c)}}).next(()=>C.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return vl(e,t)}_r(e,t){let r=lr(e),i,s=bt.ae;return r.Z({index:Gm},([o,u],{path:c,sequenceNumber:l})=>{o===0?(s!==bt.ae&&t(new B(an(i)),s),s=l,i=c):s=bt.ae}).next(()=>{s!==bt.ae&&t(new B(an(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function vl(n,e){return lr(n).put(function(r,i){return{targetId:0,path:ot(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var ih=class{constructor(){this.changes=new Gt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ve.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?C.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Fg=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Jr(e).put(r)}removeEntry(e,t,r){return Jr(e).delete(function(s,o){let u=s.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],Zl(o),u[u.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.ur(e,r)))}getEntry(e,t){let r=Ve.newInvalidDocument(t);return Jr(e).Z({index:Dl,range:IDBKeyRange.only(Sa(t))},(i,s)=>{r=this.cr(t,s)}).next(()=>r)}lr(e,t){let r={size:0,document:Ve.newInvalidDocument(t)};return Jr(e).Z({index:Dl,range:IDBKeyRange.only(Sa(t))},(i,s)=>{r={document:this.cr(t,s),size:th(s)}}).next(()=>r)}getEntries(e,t){let r=_t();return this.hr(e,t,(i,s)=>{let o=this.cr(i,s);r=r.insert(i,o)}).next(()=>r)}Pr(e,t){let r=_t(),i=new ve(B.comparator);return this.hr(e,t,(s,o)=>{let u=this.cr(s,o);r=r.insert(s,u),i=i.insert(s,th(o))}).next(()=>({documents:r,Tr:i}))}hr(e,t,r){if(t.isEmpty())return C.resolve();let i=new ge(vT);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Sa(i.first()),Sa(i.last())),o=i.getIterator(),u=o.getNext();return Jr(e).Z({index:Dl,range:s},(c,l,f)=>{let p=B.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;u&&vT(u,p)<0;)r(u,null),u=o.getNext();u&&u.isEqual(p)&&(r(u,l),u=o.hasNext()?o.getNext():null),u?f.W(Sa(u)):f.done()}).next(()=>{for(;u;)r(u,null),u=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,u=[o.popLast().toArray(),o.lastSegment(),Zl(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Jr(e).G(IDBKeyRange.bound(u,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let f=_t();for(let p of l){let m=this.cr(B.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(fu(t,m)||i.has(m.key))&&(f=f.insert(m.key,m))}return f})}getAllFromCollectionGroup(e,t,r,i){let s=_t(),o=_T(t,r),u=_T(t,kt.max());return Jr(e).Z({index:KT,range:IDBKeyRange.bound(o,u,!0)},(c,l,f)=>{let p=this.cr(B.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(p.key,p),s.size===i&&f.done()}).next(()=>s)}newChangeBuffer(e){return new Og(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return yT(e).get(Wp).next(t=>(H(!!t),t))}ur(e,t){return yT(e).put(Wp,t)}cr(e,t){if(t){let r=nN(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Y.min())))return r}return Ve.newInvalidDocument(e)}};function eI(n){return new Fg(n)}var Og=class extends ih{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new Gt(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new ge((s,o)=>ee(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let u=this.Er.get(s);if(t.push(this.Ir.removeEntry(e,s,u.readTime)),o.isValidDocument()){let c=nT(this.Ir.serializer,o);i=i.add(s.path.popLast());let l=th(c);r+=l-u.size,t.push(this.Ir.addEntry(e,s,c))}else if(r-=u.size,this.trackRemovals){let c=nT(this.Ir.serializer,o.convertToNoDocument(Y.min()));t.push(this.Ir.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.Ir.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.Ir.updateMetadata(e,r)),C.waitFor(t)}getFromCache(e,t){return this.Ir.lr(e,t).next(r=>(this.Er.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next(({documents:r,Tr:i})=>(i.forEach((s,o)=>{this.Er.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function yT(n){return qe(n,ja)}function Jr(n){return qe(n,Ol)}function Sa(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function _T(n,e){let t=e.documentKey.path.toArray();return[n,Zl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function vT(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=ee(t[s],r[s]),i)return i;return i=ee(t.length,r.length),i||(i=ee(t[t.length-2],r[r.length-2]),i||ee(t[t.length-1],r[r.length-1]))}var Vg=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var sh=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Fa(r.mutation,i,Ct.empty(),Ie.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ne()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ne()){let i=un();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Pa();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=un();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ne()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{t.set(o,u)})})}computeViews(e,t,r,i){let s=_t(),o=xa(),u=function(){return xa()}();return t.forEach((c,l)=>{let f=r.get(l.key);i.has(l.key)&&(f===void 0||f.mutation instanceof Ht)?s=s.insert(l.key,l):f!==void 0?(o.set(l.key,f.mutation.getFieldMask()),Fa(f.mutation,l,f.mutation.getFieldMask(),Ie.now())):o.set(l.key,Ct.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,f)=>o.set(l,f)),t.forEach((l,f)=>{var p;return u.set(l,new Vg(f,(p=o.get(l))!==null&&p!==void 0?p:null))}),u))}recalculateAndSaveOverlays(e,t){let r=xa(),i=new ve((o,u)=>o-u),s=ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let u of o)u.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let f=r.get(c)||Ct.empty();f=u.applyToLocalView(l,f),r.set(c,f);let p=(i.get(u.batchId)||ne()).add(c);i=i.insert(u.batchId,p)})}).next(()=>{let o=[],u=i.getReverseIterator();for(;u.hasNext();){let c=u.getNext(),l=c.key,f=c.value,p=DD();f.forEach(m=>{if(!s.has(m)){let w=PD(t.get(m),r.get(m));w!==null&&p.set(m,w),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,p))}return C.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return B.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Xm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):C.resolve(un()),u=Cs,c=s;return o.next(l=>C.forEach(l,(f,p)=>(u<p.largestBatchId&&(u=p.largestBatchId),s.get(f)?C.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,ne())).next(f=>({batchId:u,changes:TD(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=Pa();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Pa();return this.indexManager.getCollectionParents(e,s).next(u=>C.forEach(u,c=>{let l=function(p,m){return new qt(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(f=>{f.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let f=l.getKey();o.get(f)===null&&(o=o.insert(f,Ve.newInvalidDocument(f)))});let u=Pa();return o.forEach((c,l)=>{let f=s.get(c);f!==void 0&&Fa(f.mutation,l,Ct.empty(),Ie.now()),fu(t,l)&&(u=u.insert(c,l))}),u})}};var Lg=class{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return C.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Me(i.createTime)}}(t)),C.resolve()}getNamedQuery(e,t){return C.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:ny(i.bundledQuery),readTime:Me(i.readTime)}}(t)),C.resolve()}};var Ug=class{constructor(){this.overlays=new ve(B.comparator),this.Rr=new Map}getOverlay(e,t){return C.resolve(this.overlays.get(t))}getOverlays(e,t){let r=un();return C.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.Et(e,t,s)}),C.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Rr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Rr.delete(r)),C.resolve()}getOverlaysForCollection(e,t,r){let i=un(),s=t.length+1,o=new B(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){let c=u.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return C.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new ve((l,f)=>l-f),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let f=s.get(l.largestBatchId);f===null&&(f=un(),s=s.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}let u=un(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>u.set(l,f)),!(u.size()>=i)););return C.resolve(u)}Et(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Rr.get(i.largestBatchId).delete(r.key);this.Rr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Qa(t,r));let s=this.Rr.get(t);s===void 0&&(s=ne(),this.Rr.set(t,s)),this.Rr.set(t,s.add(r.key))}};var Bg=class{constructor(){this.sessionToken=Ne.EMPTY_BYTE_STRING}getSessionToken(e){return C.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,C.resolve()}};var tu=class{constructor(){this.Vr=new ge(Fe.mr),this.gr=new ge(Fe.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){let r=new Fe(e,t);this.Vr=this.Vr.add(r),this.gr=this.gr.add(r)}yr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.wr(new Fe(e,t))}Sr(e,t){e.forEach(r=>this.removeReference(r,t))}br(e){let t=new B(new ae([])),r=new Fe(t,e),i=new Fe(t,e+1),s=[];return this.gr.forEachInRange([r,i],o=>{this.wr(o),s.push(o.key)}),s}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){let t=new B(new ae([])),r=new Fe(t,e),i=new Fe(t,e+1),s=ne();return this.gr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Fe(e,0),r=this.Vr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Fe=class{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return B.comparator(e.key,t.key)||ee(e.Cr,t.Cr)}static pr(e,t){return ee(e.Cr,t.Cr)||B.comparator(e.key,t.key)}};var jg=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new ge(Fe.mr)}checkEmpty(e){return C.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Ka(s,t,r,i);this.mutationQueue.push(o);for(let u of i)this.Mr=this.Mr.add(new Fe(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return C.resolve(o)}lookupMutationBatch(e,t){return C.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Nr(r),s=i<0?0:i;return C.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(this.mutationQueue.length===0?fr:this.Fr-1)}getAllMutationBatches(e){return C.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Fe(t,0),i=new Fe(t,Number.POSITIVE_INFINITY),s=[];return this.Mr.forEachInRange([r,i],o=>{let u=this.Or(o.Cr);s.push(u)}),C.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ge(ee);return t.forEach(i=>{let s=new Fe(i,0),o=new Fe(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([s,o],u=>{r=r.add(u.Cr)})}),C.resolve(this.Br(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;B.isDocumentKey(s)||(s=s.child(""));let o=new Fe(new B(s),0),u=new ge(ee);return this.Mr.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(u=u.add(c.Cr)),!0)},o),C.resolve(this.Br(u))}Br(e){let t=[];return e.forEach(r=>{let i=this.Or(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){H(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Mr;return C.forEach(t.mutations,i=>{let s=new Fe(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=r})}qn(e){}containsKey(e,t){let r=new Fe(t,0),i=this.Mr.firstAfterOrEqual(r);return C.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,C.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){let t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var $g=class{constructor(e){this.kr=e,this.docs=function(){return new ve(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.kr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return C.resolve(r?r.document.mutableCopy():Ve.newInvalidDocument(t))}getEntries(e,t){let r=_t();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ve.newInvalidDocument(i))}),C.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=_t(),o=t.path,u=new B(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){let{key:l,value:{document:f}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||zm(zT(f),r)<=0||(i.has(f.key)||fu(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return C.resolve(s)}getAllFromCollectionGroup(e,t,r,i){q()}qr(e,t){return C.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new zg(this)}getSize(e){return C.resolve(this.size)}},zg=class extends ih{constructor(e){super(),this.Ir=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(r)}),C.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}};var qg=class{constructor(e){this.persistence=e,this.Qr=new Gt(t=>di(t),hu),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.$r=0,this.Ur=new tu,this.targetCount=0,this.Kr=Bs.Un()}forEachTarget(e,t){return this.Qr.forEach((r,i)=>t(i)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.$r&&(this.$r=t),C.resolve()}zn(e){this.Qr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Kr=new Bs(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.zn(t),C.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Qr.forEach((o,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Qr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),C.waitFor(s).next(()=>i)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){let r=this.Qr.get(t)||null;return C.resolve(r)}addMatchingKeys(e,t,r){return this.Ur.yr(t,r),C.resolve()}removeMatchingKeys(e,t,r){this.Ur.Sr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),C.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),C.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Ur.vr(t);return C.resolve(r)}containsKey(e,t){return C.resolve(this.Ur.containsKey(t))}};var nu=class{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new bt(0),this.zr=!1,this.zr=!0,this.jr=new Bg,this.referenceDelegate=e(this),this.Hr=new qg(this),this.indexManager=new Rg,this.remoteDocumentCache=function(i){return new $g(i)}(r=>this.referenceDelegate.Jr(r)),this.serializer=new Yl(t),this.Yr=new Lg(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ug,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Wr[e.toKey()];return r||(r=new jg(t,this.referenceDelegate),this.Wr[e.toKey()]=r),r}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,r){F("MemoryPersistence","Starting transaction:",e);let i=new Gg(this.Gr.next());return this.referenceDelegate.Zr(),r(i).next(s=>this.referenceDelegate.Xr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}ei(e,t){return C.or(Object.values(this.Wr).map(r=>()=>r.containsKey(e,t)))}},Gg=class extends kl{constructor(e){super(),this.currentSequenceNumber=e}},oh=class n{constructor(e){this.persistence=e,this.ti=new tu,this.ni=null}static ri(e){return new n(e)}get ii(){if(this.ni)return this.ni;throw q()}addReference(e,t,r){return this.ti.addReference(r,t),this.ii.delete(r.toString()),C.resolve()}removeReference(e,t,r){return this.ti.removeReference(r,t),this.ii.add(r.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),C.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach(i=>this.ii.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.ii.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.ii,r=>{let i=B.fromPath(r);return this.si(e,i).next(s=>{s||t.removeEntry(i,Y.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(r=>{r?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return C.or([()=>C.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}},ah=class n{constructor(e,t){this.persistence=e,this.oi=new Gt(r=>ot(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=JD(this,t)}static ri(e,t){return new n(e,t)}Zr(){}Xr(e){return C.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){let t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}sr(e){let t=0;return this.rr(e,r=>{t++}).next(()=>t)}rr(e,t){return C.forEach(this.oi,(r,i)=>this.ar(e,r,i).next(s=>s?C.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.qr(e,o=>this.ar(e,o,t).next(u=>{u||(r++,s.removeEntry(o,Y.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),C.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.oi.set(r,e.currentSequenceNumber),C.resolve()}removeReference(e,t,r){return this.oi.set(r,e.currentSequenceNumber),C.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),C.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Al(e.data.value)),t}ar(e,t,r){return C.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.oi.get(t);return C.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Hg=class{constructor(e){this.serializer=e}B(e,t,r,i){let s=new xl("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore(lu)}(e),function(c){c.createObjectStore(Ba,{keyPath:rM}),c.createObjectStore($t,{keyPath:k0,autoIncrement:!0}).createIndex(oi,x0,{unique:!0}),c.createObjectStore(Rs)}(e),wT(e),function(c){c.createObjectStore(ti)}(e));let o=C.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore(Ms),c.deleteObjectStore(Ps),c.deleteObjectStore(ci)}(e),wT(e)),o=o.next(()=>function(c){let l=c.store(ci),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Y.min().toTimestamp(),targetCount:0};return l.put(Vl,f)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store($t).G().next(p=>{c.deleteObjectStore($t),c.createObjectStore($t,{keyPath:k0,autoIncrement:!0}).createIndex(oi,x0,{unique:!0});let m=l.store($t),w=p.map(P=>m.put(P));return C.waitFor(w)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore(Ns,{keyPath:dM})})(e)})),r<5&&i>=5&&(o=o.next(()=>this._i(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore(ja)}(e),this.ai(s)))),r<7&&i>=7&&(o=o.next(()=>this.ui(s))),r<8&&i>=8&&(o=o.next(()=>this.ci(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.li(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(kh,{keyPath:fM})})(e),function(c){c.createObjectStore(xh,{keyPath:pM})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore(Fh,{keyPath:EM});l.createIndex(Qp,TM,{unique:!1}),l.createIndex(XT,DM,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore(Ol,{keyPath:sM});l.createIndex(Dl,oM),l.createIndex(KT,aM)}(e)).next(()=>this.hi(e,s)).next(()=>e.deleteObjectStore(ti))),r<14&&i>=14&&(o=o.next(()=>this.Pi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore(Hm,{keyPath:gM,autoIncrement:!0}).createIndex(Kp,mM,{unique:!1}),c.createObjectStore(Ll,{keyPath:yM}).createIndex(YT,_M,{unique:!1}),c.createObjectStore(Ul,{keyPath:vM}).createIndex(ZT,wM,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore(Ll).clear()}).next(()=>{t.objectStore(Ul).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(Wm,{keyPath:IM})})(e)})),o}ai(e){let t=0;return e.store(ti).Z((r,i)=>{t+=th(i)}).next(()=>{let r={byteSize:t};return e.store(ja).put(Wp,r)})}_i(e){let t=e.store(Ba),r=e.store($t);return t.G().next(i=>C.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,fr],[s.userId,s.lastAcknowledgedBatchId]);return r.G(oi,o).next(u=>C.forEach(u,c=>{H(c.userId===s.userId);let l=ri(this.serializer,c);return YD(e,s.userId,l).next(()=>{})}))}))}ui(e){let t=e.store(Ms),r=e.store(ti);return e.store(ci).get(Vl).next(i=>{let s=[];return r.Z((o,u)=>{let c=new ae(o),l=function(p){return[0,ot(p)]}(c);s.push(t.get(l).next(f=>f?C.resolve():(p=>t.put({targetId:0,path:ot(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>C.waitFor(s))})}ci(e,t){e.createObjectStore($a,{keyPath:hM});let r=t.store($a),i=new eu,s=o=>{if(i.add(o)){let u=o.lastSegment(),c=o.popLast();return r.put({collectionId:u,parent:ot(c)})}};return t.store(ti).Z({Y:!0},(o,u)=>{let c=new ae(o);return s(c.popLast())}).next(()=>t.store(Rs).Z({Y:!0},([o,u,c],l)=>{let f=an(u);return s(f.popLast())}))}li(e){let t=e.store(Ps);return t.Z((r,i)=>{let s=Ma(i),o=HD(this.serializer,s);return t.put(o)})}hi(e,t){let r=t.store(ti),i=[];return r.Z((s,o)=>{let u=t.store(Ol),c=function(p){return p.document?new B(ae.fromString(p.document.name).popFirst(5)):p.noDocument?B.fromSegments(p.noDocument.path):p.unknownDocument?B.fromSegments(p.unknownDocument.path):q()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(u.put(l))}).next(()=>C.waitFor(i))}Pi(e,t){let r=t.store($t),i=eI(this.serializer),s=new nu(oh.ri,this.serializer.Tt);return r.G().next(o=>{let u=new Map;return o.forEach(c=>{var l;let f=(l=u.get(c.userId))!==null&&l!==void 0?l:ne();ri(this.serializer,c).keys().forEach(p=>f=f.add(p)),u.set(c.userId,f)}),C.forEach(u,(c,l)=>{let f=new Oe(l),p=Xl.It(this.serializer,f),m=s.getIndexManager(f),w=nh.It(f,this.serializer,m,s.referenceDelegate);return new sh(i,w,p,m).recalculateAndSaveOverlaysForDocumentKeys(new za(t,bt.ae),c).next()})})}};function wT(n){n.createObjectStore(Ms,{keyPath:cM}).createIndex(Gm,lM,{unique:!0}),n.createObjectStore(Ps,{keyPath:"targetId"}).createIndex(QT,uM,{unique:!0}),n.createObjectStore(ci)}var cr="IndexedDbPersistence",Rp=18e5,Pp=5e3,Mp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",tI="main",Wg=class n{constructor(e,t,r,i,s,o,u,c,l,f,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ti=s,this.window=o,this.document=u,this.Ii=l,this.Ei=f,this.di=p,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=m=>Promise.resolve(),!n.D())throw new x(M.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new xg(this,i),this.gi=t+tI,this.serializer=new Yl(c),this.pi=new mr(this.gi,this.di,new Hg(this.serializer)),this.jr=new Tg,this.Hr=new Mg(this.referenceDelegate,this.serializer),this.remoteDocumentCache=eI(this.serializer),this.Yr=new Eg,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,f===!1&&Re(cr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new x(M.FAILED_PRECONDITION,Mp);return this.Si(),this.bi(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Hr.getHighestSequenceNumber(e))}).then(e=>{this.Gr=new bt(e,this.Ii)}).then(()=>{this.zr=!0}).catch(e=>(this.pi&&this.pi.close(),Promise.reject(e)))}Ci(e){return this.fi=t=>R(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.pi.k(t=>R(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget(()=>R(this,null,function*(){this.started&&(yield this.wi())})))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>wl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Fi(e).next(t=>{t||(this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Mi(e)).next(t=>this.isPrimary&&!t?this.xi(e).next(()=>!1):!!t&&this.Oi(e).next(()=>!0))).catch(e=>{if(Cr(e))return F(cr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return F(cr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Fi(e){return Ra(e).get(hs).next(t=>C.resolve(this.Ni(t)))}Bi(e){return wl(e).delete(this.clientId)}Li(){return R(this,null,function*(){if(this.isPrimary&&!this.ki(this.mi,Rp)){this.mi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=qe(t,Ns);return r.G().next(i=>{let s=this.qi(i,Rp),o=i.filter(u=>s.indexOf(u)===-1);return C.forEach(o,u=>r.delete(u.clientId)).next(()=>o)})}).catch(()=>[]);if(this.yi)for(let t of e)this.yi.removeItem(this.Qi(t.clientId))}})}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.wi().then(()=>this.Li()).then(()=>this.Di()))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(e){return this.Ei?C.resolve(!0):Ra(e).get(hs).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,Pp)&&!this.$i(t.ownerId)){if(this.Ni(t)&&this.networkEnabled)return!0;if(!this.Ni(t)){if(!t.allowTabSynchronization)throw new x(M.FAILED_PRECONDITION,Mp);return!1}}return!(!this.networkEnabled||!this.inForeground)||wl(e).G().next(r=>this.qi(r,Pp).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(s||o&&u)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&F(cr,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return R(this,null,function*(){this.zr=!1,this.Ui(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ki(),this.Wi(),yield this.pi.runTransaction("shutdown","readwrite",[lu,Ns],e=>{let t=new za(e,bt.ae);return this.xi(t).next(()=>this.Bi(t))}),this.pi.close(),this.Gi()})}qi(e,t){return e.filter(r=>this.ki(r.updateTimeMs,t)&&!this.$i(r.clientId))}zi(){return this.runTransaction("getActiveClients","readonly",e=>wl(e).G().next(t=>this.qi(t,Rp).map(r=>r.clientId)))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return nh.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Pg(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return Xl.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(e,t,r){F(cr,"Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===17?CM:c===16?bM:c===15?Km:c===14?tD:c===13?eD:c===12?AM:c===11?JT:void q()}(this.di),o;return this.pi.runTransaction(e,i,s,u=>(o=new za(u,this.Gr?this.Gr.next():bt.ae),t==="readwrite-primary"?this.Fi(o).next(c=>!!c||this.Mi(o)).next(c=>{if(!c)throw Re(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)),new x(M.FAILED_PRECONDITION,qT);return r(o)}).next(c=>this.Oi(o).next(()=>c)):this.ji(o).next(()=>r(o)))).then(u=>(o.raiseOnCommittedEvent(),u))}ji(e){return Ra(e).get(hs).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,Pp)&&!this.$i(t.ownerId)&&!this.Ni(t)&&!(this.Ei||this.allowTabSynchronization&&t.allowTabSynchronization))throw new x(M.FAILED_PRECONDITION,Mp)})}Oi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ra(e).put(hs,t)}static D(){return mr.D()}xi(e){let t=Ra(e);return t.get(hs).next(r=>this.Ni(r)?(F(cr,"Releasing primary lease."),t.delete(hs)):C.resolve())}ki(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(Re(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Si(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ri=()=>{this.Ti.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.wi()))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground=this.document.visibilityState==="visible")}Ki(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}bi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ai=()=>{this.Ui();let t=/(?:Version|Mobile)\/1[456]/;ef()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{let r=((t=this.yi)===null||t===void 0?void 0:t.getItem(this.Qi(e)))!==null;return F(cr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Re(cr,"Failed to get zombied client id.",r),!1}}Ui(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){Re("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch{}}Qi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Ra(n){return qe(n,lu)}function wl(n){return qe(n,Ns)}function iy(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Kg=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Hi=r,this.Ji=i}static Yi(e,t){let r=ne(),i=ne();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Qg=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var uh=class{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return ef()?8:GT(Uo())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.rs(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ss(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Qg;return this._s(e,t,o).next(u=>{if(s.result=u,this.Xi)return this.us(e,t,o,u.size)})}).next(()=>s.result)}us(e,t,r,i){return r.documentReadCount<this.es?(ys()<=Jt.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",_s(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),C.resolve()):(ys()<=Jt.DEBUG&&F("QueryEngine","Query:",_s(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ts*i?(ys()<=Jt.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",_s(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dt(t))):C.resolve())}rs(e,t){if(H0(t))return C.resolve(null);let r=dt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Hl(t,null,"F"),r=dt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ne(...s);return this.ns.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.cs(t,u);return this.ls(t,l,o,c.readTime)?this.rs(e,Hl(t,null,"F")):this.hs(e,l,t,c)}))})))}ss(e,t,r,i){return H0(t)||i.isEqual(Y.min())?C.resolve(null):this.ns.getDocuments(e,r).next(s=>{let o=this.cs(t,s);return this.ls(t,o,r,i)?C.resolve(null):(ys()<=Jt.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),_s(t)),this.hs(e,o,t,$T(i,Cs)).next(u=>u))})}cs(e,t){let r=new ge(wD(e));return t.forEach((i,s)=>{fu(e,s)&&(r=r.add(s))}),r}ls(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}_s(e,t,r){return ys()<=Jt.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",_s(t)),this.ns.getDocumentsMatchingQuery(e,t,kt.min(),r)}hs(e,t,r,i){return this.ns.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var sy="LocalStore",oN=3e8,Yg=class{constructor(e,t,r,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new ve(ee),this.Is=new Gt(s=>di(s),hu),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(r)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sh(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}};function nI(n,e,t,r){return new Yg(n,e,t,r)}function rI(n,e){return R(this,null,function*(){let t=U(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.As(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],u=[],c=ne();for(let l of i){o.push(l.batchId);for(let f of l.mutations)c=c.add(f.key)}for(let l of s){u.push(l.batchId);for(let f of l.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(r,c).next(l=>({Rs:l,removedBatchIds:o,addedBatchIds:u}))})})})}function aN(n,e){let t=U(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.ds.newChangeBuffer({trackRemovals:!0});return function(u,c,l,f){let p=l.batch,m=p.keys(),w=C.resolve();return m.forEach(P=>{w=w.next(()=>f.getEntry(c,P)).next(S=>{let A=l.docVersions.get(P);H(A!==null),S.version.compareTo(A)<0&&(p.applyToRemoteDocument(S,l),S.isValidDocument()&&(S.setReadTime(l.commitVersion),f.addEntry(S)))})}),w.next(()=>u.mutationQueue.removeMutationBatch(c,p))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=ne();for(let l=0;l<u.mutationResults.length;++l)u.mutationResults[l].transformResults.length>0&&(c=c.add(u.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function iI(n){let e=U(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function uN(n,e){let t=U(n),r=e.snapshotVersion,i=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.ds.newChangeBuffer({trackRemovals:!0});i=t.Ts;let u=[];e.targetChanges.forEach((f,p)=>{let m=i.get(p);if(!m)return;u.push(t.Hr.removeMatchingKeys(s,f.removedDocuments,p).next(()=>t.Hr.addMatchingKeys(s,f.addedDocuments,p)));let w=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?w=w.withResumeToken(Ne.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):f.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(f.resumeToken,r)),i=i.insert(p,w),function(S,A,j){return S.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=oN?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0}(m,w,f)&&u.push(t.Hr.updateTargetData(s,w))});let c=_t(),l=ne();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),u.push(sI(s,o,e.documentUpdates).next(f=>{c=f.Vs,l=f.fs})),!r.isEqual(Y.min())){let f=t.Hr.getLastRemoteSnapshotVersion(s).next(p=>t.Hr.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(f)}return C.waitFor(u).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.Ts=i,s))}function sI(n,e,t){let r=ne(),i=ne();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=_t();return t.forEach((u,c)=>{let l=s.get(u);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(Y.min())?(e.removeEntry(u,c.readTime),o=o.insert(u,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(u,c)):F(sy,"Ignoring outdated watch update for ",u,". Current version:",l.version," Watch version:",c.version)}),{Vs:o,fs:i}})}function cN(n,e){let t=U(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=fr),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function js(n,e){let t=U(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Hr.getTargetData(r,e).next(s=>s?(i=s,C.resolve(i)):t.Hr.allocateTargetId(r).next(o=>(i=new Us(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Hr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ts.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(r.targetId,r),t.Is.set(e,r.targetId)),r})}function $s(n,e,t){return R(this,null,function*(){let r=U(n),i=r.Ts.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Cr(o))throw o;F(sy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ts=r.Ts.remove(e),r.Is.delete(i.target)})}function ch(n,e,t){let r=U(n),i=Y.min(),s=ne();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,f){let p=U(c),m=p.Is.get(f);return m!==void 0?C.resolve(p.Ts.get(m)):p.Hr.getTargetData(l,f)}(r,o,dt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Hr.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.Ps.getDocumentsMatchingQuery(o,e,t?i:Y.min(),t?s:ne())).next(u=>(uI(r,vD(e),u),{documents:u,gs:s})))}function oI(n,e){let t=U(n),r=U(t.Hr),i=t.Ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.lt(s,e).next(o=>o?o.target:null))}function aI(n,e){let t=U(n),r=t.Es.get(e)||Y.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ds.getAllFromCollectionGroup(i,e,$T(r,Cs),Number.MAX_SAFE_INTEGER)).then(i=>(uI(t,e,i),i))}function uI(n,e,t){let r=n.Es.get(e)||Y.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Es.set(e,r)}function lN(n,e,t,r){return R(this,null,function*(){let i=U(n),s=ne(),o=_t();for(let l of t){let f=e.ps(l.metadata.name);l.document&&(s=s.add(f));let p=e.ys(l);p.setReadTime(e.ws(l.metadata.readTime)),o=o.insert(f,p)}let u=i.ds.newChangeBuffer({trackRemovals:!0}),c=yield js(i,function(f){return dt(Ys(ae.fromString(`__bundle__/docs/${f}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>sI(l,u,o).next(f=>(u.apply(l),f)).next(f=>i.Hr.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Hr.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,f.Vs,f.fs)).next(()=>f.Vs)))})}function hN(r,i){return R(this,arguments,function*(n,e,t=ne()){let s=yield js(n,dt(ny(e.bundledQuery))),o=U(n);return o.persistence.runTransaction("Save named query","readwrite",u=>{let c=Me(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.Yr.saveNamedQuery(u,e);let l=s.withResumeToken(Ne.EMPTY_BYTE_STRING,c);return o.Ts=o.Ts.insert(l.targetId,l),o.Hr.updateTargetData(u,l).next(()=>o.Hr.removeMatchingKeysForTargetId(u,s.targetId)).next(()=>o.Hr.addMatchingKeys(u,t,s.targetId)).next(()=>o.Yr.saveNamedQuery(u,e))})})}var cI="firestore_clients";function ET(n,e){return`${cI}_${n}_${e}`}var lI="firestore_mutations";function TT(n,e,t){let r=`${lI}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}var hI="firestore_targets";function Np(n,e){return`${hI}_${n}_${e}`}var on="SharedClientState",lh=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Ss(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new x(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(Re(on,`Failed to parse mutation state for ID '${t}': ${r}`),null)}bs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Oa=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ss(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new x(r.error.code,r.error.message))),s?new n(e,r.state,i):(Re(on,`Failed to parse target state for ID '${e}': ${t}`),null)}bs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},hh=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ss(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Jm();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=HT(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(Re(on,`Failed to parse client data for instance '${e}': ${t}`),null)}},Zg=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Ss(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Re(on,`Failed to parse online state: ${e}`),null)}},ru=class{constructor(){this.activeTargetIds=Jm()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Va=class{constructor(e,t,r,i,s){this.window=e,this.Ti=t,this.persistenceKey=r,this.Cs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Fs=this.Ms.bind(this),this.xs=new ve(ee),this.started=!1,this.Os=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ns=ET(this.persistenceKey,this.Cs),this.Bs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.xs=this.xs.insert(this.Cs,new ru),this.Ls=new RegExp(`^${cI}_${o}_([^_]*)$`),this.ks=new RegExp(`^${lI}_${o}_(\\d+)(?:_(.*))?$`),this.qs=new RegExp(`^${hI}_${o}_(\\d+)$`),this.Qs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.$s=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Fs)}static D(e){return!(!e||!e.localStorage)}start(){return R(this,null,function*(){let e=yield this.syncEngine.zi();for(let r of e){if(r===this.Cs)continue;let i=this.getItem(ET(this.persistenceKey,r));if(i){let s=hh.Ss(r,i);s&&(this.xs=this.xs.insert(s.clientId,s))}}this.Us();let t=this.storage.getItem(this.Qs);if(t){let r=this.Ks(t);r&&this.Ws(r)}for(let r of this.Os)this.Ms(r);this.Os=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Bs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Gs(this.xs)}isActiveQueryTarget(e){let t=!1;return this.xs.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.zs(e,"pending")}updateMutationState(e,t,r){this.zs(e,t,r),this.js(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(Np(this.persistenceKey,e));if(i){let s=Oa.Ss(e,i);s&&(r=s.state)}}return t&&this.Hs.Ds(e),this.Us(),r}removeLocalQueryTarget(e){this.Hs.vs(e),this.Us()}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Np(this.persistenceKey,e))}updateQueryState(e,t,r){this.Js(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.js(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Ys(e)}notifyBundleLoaded(e){this.Zs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Fs),this.removeItem(this.Ns),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return F(on,"READ",e,t),t}setItem(e,t){F(on,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){F(on,"REMOVE",e),this.storage.removeItem(e)}Ms(e){let t=e;if(t.storageArea===this.storage){if(F(on,"EVENT",t.key,t.newValue),t.key===this.Ns)return void Re("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ti.enqueueRetryable(()=>R(this,null,function*(){if(this.started){if(t.key!==null){if(this.Ls.test(t.key)){if(t.newValue==null){let r=this.Xs(t.key);return this.eo(r,null)}{let r=this.no(t.key,t.newValue);if(r)return this.eo(r.clientId,r)}}else if(this.ks.test(t.key)){if(t.newValue!==null){let r=this.ro(t.key,t.newValue);if(r)return this.io(r)}}else if(this.qs.test(t.key)){if(t.newValue!==null){let r=this.so(t.key,t.newValue);if(r)return this.oo(r)}}else if(t.key===this.Qs){if(t.newValue!==null){let r=this.Ks(t.newValue);if(r)return this.Ws(r)}}else if(t.key===this.Bs){let r=function(s){let o=bt.ae;if(s!=null)try{let u=JSON.parse(s);H(typeof u=="number"),o=u}catch(u){Re(on,"Failed to read sequence number from WebStorage",u)}return o}(t.newValue);r!==bt.ae&&this.sequenceNumberHandler(r)}else if(t.key===this.$s){let r=this._o(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.ao(i)))}}}else this.Os.push(t)}))}}get Hs(){return this.xs.get(this.Cs)}Us(){this.setItem(this.Ns,this.Hs.bs())}zs(e,t,r){let i=new lh(this.currentUser,e,t,r),s=TT(this.persistenceKey,this.currentUser,e);this.setItem(s,i.bs())}js(e){let t=TT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ys(e){let t={clientId:this.Cs,onlineState:e};this.storage.setItem(this.Qs,JSON.stringify(t))}Js(e,t,r){let i=Np(this.persistenceKey,e),s=new Oa(e,t,r);this.setItem(i,s.bs())}Zs(e){let t=JSON.stringify(Array.from(e));this.setItem(this.$s,t)}Xs(e){let t=this.Ls.exec(e);return t?t[1]:null}no(e,t){let r=this.Xs(e);return hh.Ss(r,t)}ro(e,t){let r=this.ks.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return lh.Ss(new Oe(s),i,t)}so(e,t){let r=this.qs.exec(e),i=Number(r[1]);return Oa.Ss(i,t)}Ks(e){return Zg.Ss(e)}_o(e){return JSON.parse(e)}io(e){return R(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.uo(e.batchId,e.state,e.error);F(on,`Ignoring mutation for non-active user ${e.user.uid}`)})}oo(e){return this.syncEngine.co(e.targetId,e.state,e.error)}eo(e,t){let r=t?this.xs.insert(e,t):this.xs.remove(e),i=this.Gs(this.xs),s=this.Gs(r),o=[],u=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||u.push(c)}),this.syncEngine.lo(o,u).then(()=>{this.xs=r})}Ws(e){this.xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Gs(e){let t=Jm();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},dh=class{constructor(){this.ho=new ru,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,r){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new ru,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Xg=class{To(e){}shutdown(){}};var DT="ConnectivityMonitor",fh=class{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){F(DT,"Network connectivity changed: AVAILABLE");for(let e of this.Vo)e(0)}Ro(){F(DT,"Network connectivity changed: UNAVAILABLE");for(let e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var El=null;function Jg(){return El===null?El=function(){return 268435456+Math.round(2147483648*Math.random())}():El++,"0x"+El.toString(16)}var kp="RestConnection",dN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},em=class{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${r}/databases/${i}`,this.wo=this.databaseId.database===Zp?`project_id=${r}`:`project_id=${r}&database_id=${i}`}So(e,t,r,i,s){let o=Jg(),u=this.bo(e,t.toUriEncodedString());F(kp,`Sending RPC '${e}' ${o}:`,u,r);let c={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(c,i,s),this.vo(e,u,c,r).then(l=>(F(kp,`Received RPC '${e}' ${o}: `,l),l),l=>{throw zt(kp,`RPC '${e}' ${o} failed with error: `,l,"url: ",u,"request:",r),l})}Co(e,t,r,i,s,o){return this.So(e,t,r,i,s)}Do(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Qs}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}bo(e,t){let r=dN[e];return`${this.po}/v1/${t}:${r}`}terminate(){}};var tm=class{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}};var it="WebChannelConnection",nm=class extends em{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,r,i){let s=Jg();return new Promise((o,u)=>{let c=new Dp;c.setWithCredentials(!0),c.listenOnce(Ip.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Aa.NO_ERROR:let f=c.getResponseJson();F(it,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case Aa.TIMEOUT:F(it,`RPC '${e}' ${s} timed out`),u(new x(M.DEADLINE_EXCEEDED,"Request time out"));break;case Aa.HTTP_ERROR:let p=c.getStatus();if(F(it,`RPC '${e}' ${s} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);let w=m?.error;if(w&&w.status&&w.message){let P=function(A){let j=A.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(j)>=0?j:M.UNKNOWN}(w.status);u(new x(P,w.message))}else u(new x(M.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new x(M.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{F(it,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);F(it,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Wo(e,t,r){let i=Jg(),s=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Cp(),u=bp(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let f=s.join("");F(it,`Creating RPC '${e}' stream ${i}: ${f}`,c);let p=o.createWebChannel(f,c),m=!1,w=!1,P=new tm({Fo:A=>{w?F(it,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(m||(F(it,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),F(it,`RPC '${e}' stream ${i} sending:`,A),p.send(A))},Mo:()=>p.close()}),S=(A,j,G)=>{A.listen(j,k=>{try{G(k)}catch(z){setTimeout(()=>{throw z},0)}})};return S(p,ls.EventType.OPEN,()=>{w||(F(it,`RPC '${e}' stream ${i} transport opened.`),P.Qo())}),S(p,ls.EventType.CLOSE,()=>{w||(w=!0,F(it,`RPC '${e}' stream ${i} transport closed`),P.Uo())}),S(p,ls.EventType.ERROR,A=>{w||(w=!0,zt(it,`RPC '${e}' stream ${i} transport errored:`,A),P.Uo(new x(M.UNAVAILABLE,"The operation could not be completed")))}),S(p,ls.EventType.MESSAGE,A=>{var j;if(!w){let G=A.data[0];H(!!G);let k=G,z=k?.error||((j=k[0])===null||j===void 0?void 0:j.error);if(z){F(it,`RPC '${e}' stream ${i} received error:`,z);let Z=z.status,X=function(v){let T=xe[v];if(T!==void 0)return kD(T)}(Z),E=z.message;X===void 0&&(X=M.INTERNAL,E="Unknown error status: "+Z+" with message "+z.message),w=!0,P.Uo(new x(X,E)),p.close()}else F(it,`RPC '${e}' stream ${i} received:`,G),P.Ko(G)}}),S(u,Ap.STAT_EVENT,A=>{A.stat===ml.PROXY?F(it,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===ml.NOPROXY&&F(it,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.$o()},0),P}};function dI(){return typeof window<"u"?window:null}function Sl(){return typeof document<"u"?document:null}function pu(n){return new mg(n,!0)}var iu=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Ti=e,this.timerId=t,this.Go=r,this.zo=i,this.jo=s,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();let t=Math.floor(this.Ho+this.e_()),r=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-r);i>0&&F("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}};var IT="PersistentStream",ph=class{constructor(e,t,r,i,s,o,u,c){this.Ti=e,this.n_=r,this.r_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new iu(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}stop(){return R(this,null,function*(){this.u_()&&(yield this.close(0))})}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}T_(){return R(this,null,function*(){if(this.c_())return this.close(0)})}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}close(e,t){return R(this,null,function*(){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(Re(t.toString()),Re("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===M.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Lo(t)})}A_(){}auth(){this.state=1;let e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.i_===t&&this.V_(r,i)},r=>{e(()=>{let i=new x(M.UNKNOWN,"Fetching auth token failed: "+r.message);return this.m_(i)})})}V_(e,t){let r=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{r(()=>this.listener.xo())}),this.stream.No(()=>{r(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{r(()=>this.m_(i))}),this.stream.onMessage(i=>{r(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(()=>R(this,null,function*(){this.state=0,this.start()}))}m_(e){return F(IT,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(F(IT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},rm=class extends ph{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();let t=QM(this.serializer,e),r=function(s){if(!("targetChange"in s))return Y.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?Y.min():o.readTime?Me(o.readTime):Y.min()}(e);return this.listener.p_(t,r)}y_(e){let t={};t.database=vg(this.serializer),t.addTarget=function(s,o){let u,c=o.target;if(u=ql(c)?{documents:BD(s,c)}:{query:jD(s,c).ht},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=xD(s,o.resumeToken);let l=yg(s,o.expectedCount);l!==null&&(u.expectedCount=l)}else if(o.snapshotVersion.compareTo(Y.min())>0){u.readTime=Ls(s,o.snapshotVersion.toTimestamp());let l=yg(s,o.expectedCount);l!==null&&(u.expectedCount=l)}return u}(this.serializer,e);let r=ZM(this.serializer,e);r&&(t.labels=r),this.I_(t)}w_(e){let t={};t.database=vg(this.serializer),t.removeTarget=e,this.I_(t)}},im=class extends ph{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return H(!!e.streamToken),this.lastStreamToken=e.streamToken,H(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){H(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();let t=YM(e.writeResults,e.commitTime),r=Me(e.commitTime);return this.listener.v_(r,t)}C_(){let e={};e.database=vg(this.serializer),this.I_(e)}b_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Ja(this.serializer,r))};this.I_(t)}};var sm=class{},om=class extends sm{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new x(M.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,r,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,_g(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new x(M.UNKNOWN,s.toString())})}Co(e,t,r,i,s){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Co(e,_g(t,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new x(M.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}},am=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Re(t),this.N_=!1):F("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}};var mi="RemoteStore",um=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=s,this.z_.To(o=>{r.enqueueAndForget(()=>R(this,null,function*(){Rr(this)&&(F(mi,"Restarting streams for network reachability change."),yield function(c){return R(this,null,function*(){let l=U(c);l.W_.add(4),yield Zs(l),l.j_.set("Unknown"),l.W_.delete(4),yield gu(l)})}(this))}))}),this.j_=new am(r,i)}};function gu(n){return R(this,null,function*(){if(Rr(n))for(let e of n.G_)yield e(!0)})}function Zs(n){return R(this,null,function*(){for(let e of n.G_)yield e(!1)})}function Uh(n,e){let t=U(n);t.K_.has(e.targetId)||(t.K_.set(e.targetId,e),uy(t)?ay(t):Js(t).c_()&&oy(t,e))}function zs(n,e){let t=U(n),r=Js(t);t.K_.delete(e),r.c_()&&fI(t,e),t.K_.size===0&&(r.c_()?r.P_():Rr(t)&&t.j_.set("Unknown"))}function oy(n,e){if(n.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Js(n).y_(e)}function fI(n,e){n.H_.Ne(e),Js(n).w_(e)}function ay(n){n.H_=new gg({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>n.K_.get(e)||null,it:()=>n.datastore.serializer.databaseId}),Js(n).start(),n.j_.B_()}function uy(n){return Rr(n)&&!Js(n).u_()&&n.K_.size>0}function Rr(n){return U(n).W_.size===0}function pI(n){n.H_=void 0}function fN(n){return R(this,null,function*(){n.j_.set("Online")})}function pN(n){return R(this,null,function*(){n.K_.forEach((e,t)=>{oy(n,e)})})}function gN(n,e){return R(this,null,function*(){pI(n),uy(n)?(n.j_.q_(e),ay(n)):n.j_.set("Unknown")})}function mN(n,e,t){return R(this,null,function*(){if(n.j_.set("Online"),e instanceof Kl&&e.state===2&&e.cause)try{yield function(i,s){return R(this,null,function*(){let o=s.cause;for(let u of s.targetIds)i.K_.has(u)&&(yield i.remoteSyncer.rejectListen(u,o),i.K_.delete(u),i.H_.removeTarget(u))})}(n,e)}catch(r){F(mi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield gh(n,r)}else if(e instanceof As?n.H_.We(e):e instanceof Wl?n.H_.Ze(e):n.H_.je(e),!t.isEqual(Y.min()))try{let r=yield iI(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let u=s.H_.ot(o);return u.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let f=s.K_.get(l);f&&s.K_.set(l,f.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,l)=>{let f=s.K_.get(c);if(!f)return;s.K_.set(c,f.withResumeToken(Ne.EMPTY_BYTE_STRING,f.snapshotVersion)),fI(s,c);let p=new Us(f.target,c,l,f.sequenceNumber);oy(s,p)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){F(mi,"Failed to raise snapshot:",r),yield gh(n,r)}})}function gh(n,e,t){return R(this,null,function*(){if(!Cr(e))throw e;n.W_.add(1),yield Zs(n),n.j_.set("Offline"),t||(t=()=>iI(n.localStore)),n.asyncQueue.enqueueRetryable(()=>R(this,null,function*(){F(mi,"Retrying IndexedDB access"),yield t(),n.W_.delete(1),yield gu(n)}))})}function gI(n,e){return e().catch(t=>gh(n,t,e))}function Xs(n){return R(this,null,function*(){let e=U(n),t=Ir(e),r=e.U_.length>0?e.U_[e.U_.length-1].batchId:fr;for(;yN(e);)try{let i=yield cN(e.localStore,r);if(i===null){e.U_.length===0&&t.P_();break}r=i.batchId,_N(e,i)}catch(i){yield gh(e,i)}mI(e)&&yI(e)})}function yN(n){return Rr(n)&&n.U_.length<10}function _N(n,e){n.U_.push(e);let t=Ir(n);t.c_()&&t.S_&&t.b_(e.mutations)}function mI(n){return Rr(n)&&!Ir(n).u_()&&n.U_.length>0}function yI(n){Ir(n).start()}function vN(n){return R(this,null,function*(){Ir(n).C_()})}function wN(n){return R(this,null,function*(){let e=Ir(n);for(let t of n.U_)e.b_(t.mutations)})}function EN(n,e,t){return R(this,null,function*(){let r=n.U_.shift(),i=dg.from(r,e,t);yield gI(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Xs(n)})}function TN(n,e){return R(this,null,function*(){e&&Ir(n).S_&&(yield function(r,i){return R(this,null,function*(){if(function(o){return ND(o)&&o!==M.ABORTED}(i.code)){let s=r.U_.shift();Ir(r).h_(),yield gI(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Xs(r)}})}(n,e)),mI(n)&&yI(n)})}function AT(n,e){return R(this,null,function*(){let t=U(n);t.asyncQueue.verifyOperationInProgress(),F(mi,"RemoteStore received new credentials");let r=Rr(t);t.W_.add(3),yield Zs(t),r&&t.j_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),yield gu(t)})}function cm(n,e){return R(this,null,function*(){let t=U(n);e?(t.W_.delete(2),yield gu(t)):e||(t.W_.add(2),yield Zs(t),t.j_.set("Unknown"))})}function Js(n){return n.J_||(n.J_=function(t,r,i){let s=U(t);return s.M_(),new rm(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{xo:fN.bind(null,n),No:pN.bind(null,n),Lo:gN.bind(null,n),p_:mN.bind(null,n)}),n.G_.push(e=>R(this,null,function*(){e?(n.J_.h_(),uy(n)?ay(n):n.j_.set("Unknown")):(yield n.J_.stop(),pI(n))}))),n.J_}function Ir(n){return n.Y_||(n.Y_=function(t,r,i){let s=U(t);return s.M_(),new im(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{xo:()=>Promise.resolve(),No:vN.bind(null,n),Lo:TN.bind(null,n),D_:wN.bind(null,n),v_:EN.bind(null,n)}),n.G_.push(e=>R(this,null,function*(){e?(n.Y_.h_(),yield Xs(n)):(yield n.Y_.stop(),n.U_.length>0&&(F(mi,`Stopping write stream with ${n.U_.length} pending writes`),n.U_=[]))}))),n.Y_}var lm=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ze,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,u=new n(e,t,o,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function eo(n,e){if(Re("AsyncQueue",`${e}: ${n}`),Cr(n))return new x(M.UNAVAILABLE,`${e}: ${n}`);throw n}var mh=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=Pa(),this.sortedSet=new ve(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var yh=class{constructor(){this.Z_=new ve(B.comparator)}track(e){let t=e.doc.key,r=this.Z_.get(t);r?e.type!==0&&r.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&r.type!==1?this.Z_=this.Z_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Z_=this.Z_.remove(t):e.type===1&&r.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):q():this.Z_=this.Z_.insert(t,e)}X_(){let e=[];return this.Z_.inorderTraversal((t,r)=>{e.push(r)}),e}},qs=class n{constructor(e,t,r,i,s,o,u,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(u=>{o.push({type:0,doc:u})}),new n(e,t,mh.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&du(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var hm=class{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}},dm=class{constructor(){this.queries=bT(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,r){let i=U(t),s=i.queries;i.queries=bT(),s.forEach((o,u)=>{for(let c of u.ta)c.onError(r)})})(this,new x(M.ABORTED,"Firestore shutting down"))}};function bT(){return new Gt(n=>_D(n),du)}function cy(n,e){return R(this,null,function*(){let t=U(n),r=3,i=e.query,s=t.queries.get(i);s?!s.na()&&e.ra()&&(r=2):(s=new hm,r=e.ra()?0:1);try{switch(r){case 0:s.ea=yield t.onListen(i,!0);break;case 1:s.ea=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let u=eo(o,`Initialization of query '${_s(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.ta.push(e),e.sa(t.onlineState),s.ea&&e.oa(s.ea)&&hy(t)})}function ly(n,e){return R(this,null,function*(){let t=U(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.ta.indexOf(e);o>=0&&(s.ta.splice(o,1),s.ta.length===0?i=e.ra()?0:1:!s.na()&&e.ra()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function DN(n,e){let t=U(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let u of o.ta)u.oa(i)&&(r=!0);o.ea=i}}r&&hy(t)}function IN(n,e,t){let r=U(n),i=r.queries.get(e);if(i)for(let s of i.ta)s.onError(t);r.queries.delete(e)}function hy(n){n.ia.forEach(e=>{e.next()})}var fm,CT;(CT=fm||(fm={}))._a="default",CT.Cache="cache";var su=class{constructor(e,t,r){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=r||{}}oa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new qs(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;let r=t!=="Offline";return(!this.options.Ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;let t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=qs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==fm.Cache}};var pm=class{constructor(e,t){this.Ia=e,this.byteLength=t}Ea(){return"metadata"in this.Ia}};var _h=class{constructor(e){this.serializer=e}ps(e){return ln(this.serializer,e)}ys(e){return e.metadata.exists?UD(this.serializer,e.document,!1):Ve.newNoDocument(this.ps(e.metadata.name),this.ws(e.metadata.readTime))}ws(e){return Me(e)}},gm=class{constructor(e,t,r){this.da=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=_I(e)}Aa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Ia.namedQuery)this.queries.push(e.Ia.namedQuery);else if(e.Ia.documentMetadata){this.documents.push({metadata:e.Ia.documentMetadata}),e.Ia.documentMetadata.exists||++t;let r=ae.fromString(e.Ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Ia.document&&(this.documents[this.documents.length-1].document=e.Ia.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ra(e){let t=new Map,r=new _h(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.ps(i.metadata.name);for(let o of i.metadata.queries){let u=(t.get(o)||ne()).add(s);t.set(o,u)}}return t}complete(){return R(this,null,function*(){let e=yield lN(this.localStore,new _h(this.serializer),this.documents,this.da.id),t=this.Ra(this.documents);for(let r of this.queries)yield hN(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Va:this.collectionGroups,ma:e}})}};function _I(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var vh=class{constructor(e){this.key=e}},wh=class{constructor(e){this.key=e}},Eh=class{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=ne(),this.mutatedKeys=ne(),this.ya=wD(e),this.wa=new mh(this.ya)}get Sa(){return this.fa}ba(e,t){let r=t?t.Da:new yh,i=t?t.wa:this.wa,s=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,p)=>{let m=i.get(f),w=fu(this.query,p)?p:null,P=!!m&&this.mutatedKeys.has(m.key),S=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations),A=!1;m&&w?m.data.isEqual(w.data)?P!==S&&(r.track({type:3,doc:w}),A=!0):this.va(m,w)||(r.track({type:2,doc:w}),A=!0,(c&&this.ya(w,c)>0||l&&this.ya(w,l)<0)&&(u=!0)):!m&&w?(r.track({type:0,doc:w}),A=!0):m&&!w&&(r.track({type:1,doc:m}),A=!0,(c||l)&&(u=!0)),A&&(w?(o=o.add(w),s=S?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{wa:o,Da:r,ls:u,mutatedKeys:s}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;let o=e.Da.X_();o.sort((f,p)=>function(w,P){let S=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return S(w)-S(P)}(f.type,p.type)||this.ya(f.doc,p.doc)),this.Ca(r),i=i!=null&&i;let u=t&&!i?this.Fa():[],c=this.pa.size===0&&this.current&&!i?1:0,l=c!==this.ga;return this.ga=c,o.length!==0||l?{snapshot:new qs(this.query,e.wa,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ma:u}:{Ma:u}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new yh,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];let e=this.pa;this.pa=ne(),this.wa.forEach(r=>{this.xa(r.key)&&(this.pa=this.pa.add(r.key))});let t=[];return e.forEach(r=>{this.pa.has(r)||t.push(new wh(r))}),this.pa.forEach(r=>{e.has(r)||t.push(new vh(r))}),t}Oa(e){this.fa=e.gs,this.pa=ne();let t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return qs.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}},Pr="SyncEngine",mm=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},ym=class{constructor(e){this.key=e,this.Ba=!1}},_m=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new Gt(u=>_D(u),du),this.qa=new Map,this.Qa=new Set,this.$a=new ve(B.comparator),this.Ua=new Map,this.Ka=new tu,this.Wa={},this.Ga=new Map,this.za=Bs.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}};function AN(n,e,t=!0){return R(this,null,function*(){let r=Bh(n),i,s=r.ka.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Na()):i=yield vI(r,e,t,!0),i})}function bN(n,e){return R(this,null,function*(){let t=Bh(n);yield vI(t,e,!0,!1)})}function vI(n,e,t,r){return R(this,null,function*(){let i=yield js(n.localStore,dt(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),u;return r&&(u=yield dy(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Uh(n.remoteStore,i),u})}function dy(n,e,t,r,i){return R(this,null,function*(){n.Ha=(p,m,w)=>function(S,A,j,G){return R(this,null,function*(){let k=A.view.ba(j);k.ls&&(k=yield ch(S.localStore,A.query,!1).then(({documents:E})=>A.view.ba(E,k)));let z=G&&G.targetChanges.get(A.targetId),Z=G&&G.targetMismatches.get(A.targetId)!=null,X=A.view.applyChanges(k,S.isPrimaryClient,z,Z);return vm(S,A.targetId,X.Ma),X.snapshot})}(n,p,m,w);let s=yield ch(n.localStore,e,!0),o=new Eh(e,s.gs),u=o.ba(s.documents),c=Za.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(u,n.isPrimaryClient,c);vm(n,t,l.Ma);let f=new mm(e,t,o);return n.ka.set(e,f),n.qa.has(t)?n.qa.get(t).push(e):n.qa.set(t,[e]),l.snapshot})}function CN(n,e,t){return R(this,null,function*(){let r=U(n),i=r.ka.get(e),s=r.qa.get(i.targetId);if(s.length>1)return r.qa.set(i.targetId,s.filter(o=>!du(o,e))),void r.ka.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield $s(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&zs(r.remoteStore,i.targetId),Gs(r,i.targetId)}).catch(br))):(Gs(r,i.targetId),yield $s(r.localStore,i.targetId,!0))})}function SN(n,e){return R(this,null,function*(){let t=U(n),r=t.ka.get(e),i=t.qa.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),zs(t.remoteStore,r.targetId))})}function RN(n,e,t){return R(this,null,function*(){let r=my(n);try{let i=yield function(o,u){let c=U(o),l=Ie.now(),f=u.reduce((w,P)=>w.add(P.key),ne()),p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",w=>{let P=_t(),S=ne();return c.ds.getEntries(w,f).next(A=>{P=A,P.forEach((j,G)=>{G.isValidDocument()||(S=S.add(j))})}).next(()=>c.localDocuments.getOverlayedDocuments(w,P)).next(A=>{p=A;let j=[];for(let G of u){let k=$M(G,p.get(G.key).overlayedDocument);k!=null&&j.push(new Ht(G.key,k,hD(k.value.mapValue),Se.exists(!0)))}return c.mutationQueue.addMutationBatch(w,l,j,u)}).next(A=>{m=A;let j=A.applyToLocalDocumentSet(p,S);return c.documentOverlayCache.saveOverlays(w,A.batchId,j)})}).then(()=>({batchId:m.batchId,changes:TD(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,u,c){let l=o.Wa[o.currentUser.toKey()];l||(l=new ve(ee)),l=l.insert(u,c),o.Wa[o.currentUser.toKey()]=l}(r,i.batchId,t),yield Bn(r,i.changes),yield Xs(r.remoteStore)}catch(i){let s=eo(i,"Failed to persist write");t.reject(s)}})}function wI(n,e){return R(this,null,function*(){let t=U(n);try{let r=yield uN(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Ua.get(s);o&&(H(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ba=!0:i.modifiedDocuments.size>0?H(o.Ba):i.removedDocuments.size>0&&(H(o.Ba),o.Ba=!1))}),yield Bn(t,r,e)}catch(r){yield br(r)}})}function ST(n,e,t){let r=U(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.ka.forEach((s,o)=>{let u=o.view.sa(e);u.snapshot&&i.push(u.snapshot)}),function(o,u){let c=U(o);c.onlineState=u;let l=!1;c.queries.forEach((f,p)=>{for(let m of p.ta)m.sa(u)&&(l=!0)}),l&&hy(c)}(r.eventManager,e),i.length&&r.La.p_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function PN(n,e,t){return R(this,null,function*(){let r=U(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Ua.get(e),s=i&&i.key;if(s){let o=new ve(B.comparator);o=o.insert(s,Ve.newNoDocument(s,Y.min()));let u=ne().add(s),c=new Ya(Y.min(),new Map,new ve(ee),o,u);yield wI(r,c),r.$a=r.$a.remove(s),r.Ua.delete(e),gy(r)}else yield $s(r.localStore,e,!1).then(()=>Gs(r,e,t)).catch(br)})}function MN(n,e){return R(this,null,function*(){let t=U(n),r=e.batch.batchId;try{let i=yield aN(t.localStore,e);py(t,r,null),fy(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Bn(t,i)}catch(i){yield br(i)}})}function NN(n,e,t){return R(this,null,function*(){let r=U(n);try{let i=yield function(o,u){let c=U(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let f;return c.mutationQueue.lookupMutationBatch(l,u).next(p=>(H(p!==null),f=p.keys(),c.mutationQueue.removeMutationBatch(l,p))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,f,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,f)).next(()=>c.localDocuments.getDocuments(l,f))})}(r.localStore,e);py(r,e,t),fy(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Bn(r,i)}catch(i){yield br(i)}})}function kN(n,e){return R(this,null,function*(){let t=U(n);Rr(t.remoteStore)||F(Pr,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let u=U(o);return u.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>u.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===fr)return void e.resolve();let i=t.Ga.get(r)||[];i.push(e),t.Ga.set(r,i)}catch(r){let i=eo(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function fy(n,e){(n.Ga.get(e)||[]).forEach(t=>{t.resolve()}),n.Ga.delete(e)}function py(n,e,t){let r=U(n),i=r.Wa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Wa[r.currentUser.toKey()]=i}}function Gs(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.qa.get(e))n.ka.delete(r),t&&n.La.Ja(r,t);n.qa.delete(e),n.isPrimaryClient&&n.Ka.br(e).forEach(r=>{n.Ka.containsKey(r)||EI(n,r)})}function EI(n,e){n.Qa.delete(e.path.canonicalString());let t=n.$a.get(e);t!==null&&(zs(n.remoteStore,t),n.$a=n.$a.remove(e),n.Ua.delete(t),gy(n))}function vm(n,e,t){for(let r of t)r instanceof vh?(n.Ka.addReference(r.key,e),xN(n,r)):r instanceof wh?(F(Pr,"Document no longer in limbo: "+r.key),n.Ka.removeReference(r.key,e),n.Ka.containsKey(r.key)||EI(n,r.key)):q()}function xN(n,e){let t=e.key,r=t.path.canonicalString();n.$a.get(t)||n.Qa.has(r)||(F(Pr,"New document in limbo: "+t),n.Qa.add(r),gy(n))}function gy(n){for(;n.Qa.size>0&&n.$a.size<n.maxConcurrentLimboResolutions;){let e=n.Qa.values().next().value;n.Qa.delete(e);let t=new B(ae.fromString(e)),r=n.za.next();n.Ua.set(r,new ym(t)),n.$a=n.$a.insert(t,r),Uh(n.remoteStore,new Us(dt(Ys(t.path)),r,"TargetPurposeLimboResolution",bt.ae))}}function Bn(n,e,t){return R(this,null,function*(){let r=U(n),i=[],s=[],o=[];r.ka.isEmpty()||(r.ka.forEach((u,c)=>{o.push(r.Ha(c,e,t).then(l=>{var f;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(f=t?.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(l){i.push(l);let p=Kg.Yi(c.targetId,l);s.push(p)}}))}),yield Promise.all(o),r.La.p_(i),yield function(c,l){return R(this,null,function*(){let f=U(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>C.forEach(l,m=>C.forEach(m.Hi,w=>f.persistence.referenceDelegate.addReference(p,m.targetId,w)).next(()=>C.forEach(m.Ji,w=>f.persistence.referenceDelegate.removeReference(p,m.targetId,w)))))}catch(p){if(!Cr(p))throw p;F(sy,"Failed to update sequence numbers: "+p)}for(let p of l){let m=p.targetId;if(!p.fromCache){let w=f.Ts.get(m),P=w.snapshotVersion,S=w.withLastLimboFreeSnapshotVersion(P);f.Ts=f.Ts.insert(m,S)}}})}(r.localStore,s))})}function FN(n,e){return R(this,null,function*(){let t=U(n);if(!t.currentUser.isEqual(e)){F(Pr,"User change. New user:",e.toKey());let r=yield rI(t.localStore,e);t.currentUser=e,function(s,o){s.Ga.forEach(u=>{u.forEach(c=>{c.reject(new x(M.CANCELLED,o))})}),s.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Bn(t,r.Rs)}})}function ON(n,e){let t=U(n),r=t.Ua.get(e);if(r&&r.Ba)return ne().add(r.key);{let i=ne(),s=t.qa.get(e);if(!s)return i;for(let o of s){let u=t.ka.get(o);i=i.unionWith(u.view.Sa)}return i}}function VN(n,e){return R(this,null,function*(){let t=U(n),r=yield ch(t.localStore,e.query,!0),i=e.view.Oa(r);return t.isPrimaryClient&&vm(t,e.targetId,i.Ma),i})}function LN(n,e){return R(this,null,function*(){let t=U(n);return aI(t.localStore,e).then(r=>Bn(t,r))})}function UN(n,e,t,r){return R(this,null,function*(){let i=U(n),s=yield function(u,c){let l=U(u),f=U(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>f.Ln(p,c).next(m=>m?l.localDocuments.getDocuments(p,m):C.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Xs(i.remoteStore):t==="acknowledged"||t==="rejected"?(py(i,e,r||null),fy(i,e),function(u,c){U(U(u).mutationQueue).qn(c)}(i.localStore,e)):q(),yield Bn(i,s)):F(Pr,"Cannot apply mutation batch with id: "+e)})}function BN(n,e){return R(this,null,function*(){let t=U(n);if(Bh(t),my(t),e===!0&&t.ja!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield RT(t,r.toArray());t.ja=!0,yield cm(t.remoteStore,!0);for(let s of i)Uh(t.remoteStore,s)}else if(e===!1&&t.ja!==!1){let r=[],i=Promise.resolve();t.qa.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Gs(t,o),$s(t.localStore,o,!0))),zs(t.remoteStore,o)}),yield i,yield RT(t,r),function(o){let u=U(o);u.Ua.forEach((c,l)=>{zs(u.remoteStore,l)}),u.Ka.Dr(),u.Ua=new Map,u.$a=new ve(B.comparator)}(t),t.ja=!1,yield cm(t.remoteStore,!1)}})}function RT(n,e,t){return R(this,null,function*(){let r=U(n),i=[],s=[];for(let o of e){let u,c=r.qa.get(o);if(c&&c.length!==0){u=yield js(r.localStore,dt(c[0]));for(let l of c){let f=r.ka.get(l),p=yield VN(r,f);p.snapshot&&s.push(p.snapshot)}}else{let l=yield oI(r.localStore,o);u=yield js(r.localStore,l),yield dy(r,TI(l),o,!1,u.resumeToken)}i.push(u)}return r.La.p_(s),i})}function TI(n){return yD(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function jN(n){return function(t){return U(U(t).persistence).zi()}(U(n).localStore)}function $N(n,e,t,r){return R(this,null,function*(){let i=U(n);if(i.ja)return void F(Pr,"Ignoring unexpected query state notification.");let s=i.qa.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield aI(i.localStore,vD(s[0])),u=Ya.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ne.EMPTY_BYTE_STRING);yield Bn(i,o,u);break}case"rejected":yield $s(i.localStore,e,!0),Gs(i,e,r);break;default:q()}})}function zN(n,e,t){return R(this,null,function*(){let r=Bh(n);if(r.ja){for(let i of e){if(r.qa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){F(Pr,"Adding an already active target "+i);continue}let s=yield oI(r.localStore,i),o=yield js(r.localStore,s);yield dy(r,TI(s),o.targetId,!1,o.resumeToken),Uh(r.remoteStore,o)}for(let i of t)r.qa.has(i)&&(yield $s(r.localStore,i,!1).then(()=>{zs(r.remoteStore,i),Gs(r,i)}).catch(br))}})}function Bh(n){let e=U(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=wI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ON.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=PN.bind(null,e),e.La.p_=DN.bind(null,e.eventManager),e.La.Ja=IN.bind(null,e.eventManager),e}function my(n){let e=U(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=MN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NN.bind(null,e),e}function qN(n,e,t){let r=U(n);(function(s,o,u){return R(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(w,P){let S=U(w),A=Me(P.createTime);return S.persistence.runTransaction("hasNewerBundle","readonly",j=>S.Yr.getBundleMetadata(j,P.id)).then(j=>!!j&&j.createTime.compareTo(A)>=0)}(s.localStore,c))return yield o.close(),u._completeWith(function(w){return{taskState:"Success",documentsLoaded:w.totalDocuments,bytesLoaded:w.totalBytes,totalDocuments:w.totalDocuments,totalBytes:w.totalBytes}}(c)),Promise.resolve(new Set);u._updateProgress(_I(c));let l=new gm(c,s.localStore,o.serializer),f=yield o.Ya();for(;f;){let m=yield l.Aa(f);m&&u._updateProgress(m),f=yield o.Ya()}let p=yield l.complete();return yield Bn(s,p.ma,void 0),yield function(w,P){let S=U(w);return S.persistence.runTransaction("Save bundle","readwrite",A=>S.Yr.saveBundleMetadata(A,P))}(s.localStore,c),u._completeWith(p.progress),Promise.resolve(p.Va)}catch(c){return zt(Pr,`Loading bundle failed with ${c}`),u._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var yy=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return R(this,null,function*(){this.serializer=pu(t.databaseInfo.databaseId),this.sharedClientState=this.Za(t),this.persistence=this.Xa(t),yield this.persistence.start(),this.localStore=this.eu(t),this.gcScheduler=this.tu(t,this.localStore),this.indexBackfillerScheduler=this.nu(t,this.localStore)})}tu(t,r){return null}nu(t,r){return null}eu(t){return nI(this.persistence,new uh,t.initialUser,this.serializer)}Xa(t){return new nu(oh.ri,this.serializer)}Za(t){return new dh}terminate(){return R(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),wm=class extends yy{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){H(this.persistence.referenceDelegate instanceof ah);let r=this.persistence.referenceDelegate.garbageCollector;return new rh(r,e.asyncQueue,t)}Xa(e){let t=this.cacheSizeBytes!==void 0?yt.withCacheSize(this.cacheSizeBytes):yt.DEFAULT;return new nu(r=>ah.ri(r,t),this.serializer)}},Th=class n extends yy{constructor(e,t,r){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return R(this,null,function*(){yield Md(n.prototype,this,"initialize").call(this,e),yield this.ru.initialize(this,e),yield my(this.ru.syncEngine),yield Xs(this.ru.remoteStore),yield this.persistence.Ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}eu(e){return nI(this.persistence,new uh,e.initialUser,this.serializer)}tu(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new rh(r,e.asyncQueue,t)}nu(e,t){let r=new Hp(t,this.persistence);return new Gp(e.asyncQueue,r)}Xa(e){let t=iy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?yt.withCacheSize(this.cacheSizeBytes):yt.DEFAULT;return new Wg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,dI(),Sl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new dh}},Em=class n extends Th{constructor(e,t){super(e,t,!1),this.ru=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return R(this,null,function*(){yield Md(n.prototype,this,"initialize").call(this,e);let t=this.ru.syncEngine;this.sharedClientState instanceof Va&&(this.sharedClientState.syncEngine={uo:UN.bind(null,t),co:$N.bind(null,t),lo:zN.bind(null,t),zi:jN.bind(null,t),ao:LN.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.Ci(r=>R(this,null,function*(){yield BN(this.ru.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}Za(e){let t=dI();if(!Va.D(t))throw new x(M.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=iy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Va(t,e.asyncQueue,r,e.clientId,e.initialUser)}},_y=(()=>{class n{initialize(t,r){return R(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>ST(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=FN.bind(null,this.syncEngine),yield cm(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new dm}()}createDatastore(t){let r=pu(t.databaseInfo.databaseId),i=function(o){return new nm(o)}(t.databaseInfo);return function(o,u,c,l){return new om(o,u,c,l)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,o,u,c){return new um(i,s,o,u,c)}(this.localStore,this.datastore,t.asyncQueue,r=>ST(this.syncEngine,r,0),function(){return fh.D()?new fh:new Xg}())}createSyncEngine(t,r){return function(s,o,u,c,l,f,p){let m=new _m(s,o,u,c,l,f);return p&&(m.ja=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return R(this,null,function*(){var t,r;yield function(s){return R(this,null,function*(){let o=U(s);F(mi,"RemoteStore shutting down."),o.W_.add(5),yield Zs(o),o.z_.shutdown(),o.j_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();function PT(n,e=10240){let t=0;return{read(){return R(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return R(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Hs=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):Re("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Tm=class{constructor(e,t){this.ou=e,this.serializer=t,this.metadata=new ze,this.buffer=new Uint8Array,this._u=function(){return new TextDecoder("utf-8")}(),this.au().then(r=>{r&&r.Ea()?this.metadata.resolve(r.Ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.Ia)}`))},r=>this.metadata.reject(r))}close(){return this.ou.cancel()}getMetadata(){return R(this,null,function*(){return this.metadata.promise})}Ya(){return R(this,null,function*(){return yield this.getMetadata(),this.au()})}au(){return R(this,null,function*(){let e=yield this.uu();if(e===null)return null;let t=this._u.decode(e),r=Number(t);isNaN(r)&&this.cu(`length string (${t}) is not valid number`);let i=yield this.lu(r);return new pm(JSON.parse(i),e.length+r)})}hu(){return this.buffer.findIndex(e=>e===123)}uu(){return R(this,null,function*(){for(;this.hu()<0&&!(yield this.Pu()););if(this.buffer.length===0)return null;let e=this.hu();e<0&&this.cu("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}lu(e){return R(this,null,function*(){for(;this.buffer.length<e;)(yield this.Pu())&&this.cu("Reached the end of bundle when more is expected.");let t=this._u.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}cu(e){throw this.ou.cancel(),new Error(`Invalid bundle format: ${e}`)}Pu(){return R(this,null,function*(){let e=yield this.ou.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Dm=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return R(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new x(M.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return R(this,null,function*(){let o=U(i),u={documents:s.map(p=>Xa(o.serializer,p))},c=yield o.Co("BatchGetDocuments",o.serializer.databaseId,ae.emptyPath(),u,s.length),l=new Map;c.forEach(p=>{let m=KM(o.serializer,p);l.set(m.key.toString(),m)});let f=[];return s.forEach(p=>{let m=l.get(p.toString());H(!!m),f.push(m)}),f})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Dr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return R(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=B.fromPath(r);this.mutations.push(new Wa(i,this.precondition(i)))}),yield function(r,i){return R(this,null,function*(){let s=U(r),o={writes:i.map(u=>Ja(s.serializer,u))};yield s.So("Commit",s.serializer.databaseId,ae.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw q();t=Y.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new x(M.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Y.min())?Se.exists(!1):Se.updateTime(t):Se.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Y.min()))throw new x(M.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Se.updateTime(t)}return Se.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Im=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Tu=r.maxAttempts,this.a_=new iu(this.asyncQueue,"transaction_retry")}Iu(){this.Tu-=1,this.Eu()}Eu(){this.a_.Xo(()=>R(this,null,function*(){let e=new Dm(this.datastore),t=this.du(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Au(i)}))}).catch(r=>{this.Au(r)})}))}du(e){try{let t=this.updateFunction(e);return!cu(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Au(e){this.Tu>0&&this.Ru(e)?(this.Tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Eu(),Promise.resolve()))):this.deferred.reject(e)}Ru(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!ND(t)}return!1}};var Ar="FirestoreClient",Am=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Oe.UNAUTHENTICATED,this.clientId=Ml.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,o=>R(this,null,function*(){F(Ar,"Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(F(Ar,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ze;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=eo(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function xp(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),F(Ar,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>R(this,null,function*(){r.isEqual(i)||(yield rI(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function MT(n,e){return R(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield vy(n);F(Ar,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>AT(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>AT(e.remoteStore,i)),n._onlineComponents=e})}function vy(n){return R(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F(Ar,"Using user provided OfflineComponentProvider");try{yield xp(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===M.FAILED_PRECONDITION||i.code===M.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;zt("Error using user provided cache. Falling back to memory cache: "+t),yield xp(n,new yy)}}else F(Ar,"Using default OfflineComponentProvider"),yield xp(n,new wm(void 0));return n._offlineComponents})}function jh(n){return R(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(F(Ar,"Using user provided OnlineComponentProvider"),yield MT(n,n._uninitializedComponentsProvider._online)):(F(Ar,"Using default OnlineComponentProvider"),yield MT(n,new _y))),n._onlineComponents})}function DI(n){return vy(n).then(e=>e.persistence)}function wy(n){return vy(n).then(e=>e.localStore)}function II(n){return jh(n).then(e=>e.remoteStore)}function Ey(n){return jh(n).then(e=>e.syncEngine)}function GN(n){return jh(n).then(e=>e.datastore)}function Ws(n){return R(this,null,function*(){let e=yield jh(n),t=e.eventManager;return t.onListen=AN.bind(null,e.syncEngine),t.onUnlisten=CN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=bN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=SN.bind(null,e.syncEngine),t})}function HN(n){return n.asyncQueue.enqueue(()=>R(this,null,function*(){let e=yield DI(n),t=yield II(n);return e.setNetworkEnabled(!0),function(i){let s=U(i);return s.W_.delete(0),gu(s)}(t)}))}function WN(n){return n.asyncQueue.enqueue(()=>R(this,null,function*(){let e=yield DI(n),t=yield II(n);return e.setNetworkEnabled(!1),function(i){return R(this,null,function*(){let s=U(i);s.W_.add(0),yield Zs(s),s.j_.set("Offline")})}(t)}))}function KN(n,e){let t=new ze;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,s,o){return R(this,null,function*(){try{let u=yield function(l,f){let p=U(l);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,f))}(i,s);u.isFoundDocument()?o.resolve(u):u.isNoDocument()?o.resolve(null):o.reject(new x(M.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(u){let c=eo(u,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield wy(n),e,t)})),t.promise}function AI(n,e,t={}){let r=new ze;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(s,o,u,c,l){let f=new Hs({next:m=>{f.su(),o.enqueueAndForget(()=>ly(s,p));let w=m.docs.has(u);!w&&m.fromCache?l.reject(new x(M.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&m.fromCache&&c&&c.source==="server"?l.reject(new x(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new su(Ys(u.path),f,{includeMetadataChanges:!0,Ta:!0});return cy(s,p)}(yield Ws(n),n.asyncQueue,e,t,r)})),r.promise}function QN(n,e){let t=new ze;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,s,o){return R(this,null,function*(){try{let u=yield ch(i,s,!0),c=new Eh(s,u.gs),l=c.ba(u.documents),f=c.applyChanges(l,!1);o.resolve(f.snapshot)}catch(u){let c=eo(u,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield wy(n),e,t)})),t.promise}function bI(n,e,t={}){let r=new ze;return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(s,o,u,c,l){let f=new Hs({next:m=>{f.su(),o.enqueueAndForget(()=>ly(s,p)),m.fromCache&&c.source==="server"?l.reject(new x(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(m)},error:m=>l.reject(m)}),p=new su(u,f,{includeMetadataChanges:!0,Ta:!0});return cy(s,p)}(yield Ws(n),n.asyncQueue,e,t,r)})),r.promise}function YN(n,e){let t=new Hs(e);return n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,s){U(i).ia.add(s),s.next()}(yield Ws(n),t)})),()=>{t.su(),n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return function(i,s){U(i).ia.delete(s)}(yield Ws(n),t)}))}}function ZN(n,e,t,r){let i=function(o,u){let c;return c=typeof o=="string"?$m().encode(o):o,function(f,p){return new Tm(f,p)}(function(f,p){if(f instanceof Uint8Array)return PT(f,p);if(f instanceof ArrayBuffer)return PT(new Uint8Array(f),p);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),u)}(t,pu(e));n.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){qN(yield Ey(n),i,r)}))}function XN(n,e){return n.asyncQueue.enqueue(()=>R(this,null,function*(){return function(r,i){let s=U(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Yr.getNamedQuery(o,i))}(yield wy(n),e)}))}function CI(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var NT=new Map;function Ty(n,e,t){if(!t)throw new x(M.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Dy(n,e,t,r){if(e===!0&&r===!0)throw new x(M.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function kT(n){if(!B.isDocumentKey(n))throw new x(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function xT(n){if(B.isDocumentKey(n))throw new x(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function $h(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":q()}function ce(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=$h(n);throw new x(M.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function SI(n,e){if(e<=0)throw new x(M.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var RI="firestore.googleapis.com",FT=!0,Dh=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new x(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=RI,this.ssl=FT}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:FT;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=QD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<sN)throw new x(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Dy("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new x(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new x(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new x(M.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},yi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dh({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dh(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Fp;switch(r.type){case"firstParty":return new Up(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return R(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=NT.get(t);r&&(F("ComponentProvider","Removing Datastore"),NT.delete(t),r.terminate())}(this),Promise.resolve()}};function PI(n,e,t,r={}){var i;let s=(n=ce(n,yi))._getSettings(),o=Object.assign(Object.assign({},s),{emulatorOptions:n._getEmulatorOptions()}),u=`${e}:${t}`;s.host!==RI&&s.host!==u&&zt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let c=Object.assign(Object.assign({},s),{host:u,ssl:!1,emulatorOptions:r});if(!nc(c,o)&&(n._setSettings(c),r.mockUserToken)){let l,f;if(typeof r.mockUserToken=="string")l=r.mockUserToken,f=Oe.MOCK_USER;else{l=Ju(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new x(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Oe(p)}n._authCredentials=new Op(new Rl(l,f))}}var Ke=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ye=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},hn=class n extends Ke{constructor(e,t,r){super(e,t,Ys(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ye(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Iy(n,e,...t){if(n=ue(n),Ty("collection","path",e),n instanceof yi){let r=ae.fromString(e,...t);return xT(r),new hn(n,null,r)}{if(!(n instanceof ye||n instanceof hn))throw new x(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ae.fromString(e,...t));return xT(r),new hn(n.firestore,null,r)}}function MI(n,e){if(n=ce(n,yi),Ty("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new x(M.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ke(n,null,function(r){return new qt(ae.emptyPath(),r)}(e))}function mu(n,e,...t){if(n=ue(n),arguments.length===1&&(e=Ml.newId()),Ty("doc","path",e),n instanceof yi){let r=ae.fromString(e,...t);return kT(r),new ye(n,null,new B(r))}{if(!(n instanceof ye||n instanceof hn))throw new x(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ae.fromString(e,...t));return kT(r),new ye(n.firestore,n instanceof hn?n.converter:null,new B(r))}}function Ay(n,e){return n=ue(n),e=ue(e),(n instanceof ye||n instanceof hn)&&(e instanceof ye||e instanceof hn)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function by(n,e){return n=ue(n),e=ue(e),n instanceof Ke&&e instanceof Ke&&n.firestore===e.firestore&&du(n._query,e._query)&&n.converter===e.converter}var OT="AsyncQueue",Ih=class{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new iu(this,"async_queue_retry"),this.Su=()=>{let r=Sl();r&&F(OT,"Visibility state changed to "+r.visibilityState),this.a_.t_()},this.bu=e;let t=Sl();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;let t=Sl();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});let t=new ze;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}Cu(){return R(this,null,function*(){if(this.Vu.length!==0){try{yield this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Cr(e))throw e;F(OT,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}})}vu(e){let t=this.bu.then(()=>(this.pu=!0,e().catch(r=>{this.gu=r,this.pu=!1;let i=function(o){let u=o.message||"";return o.stack&&(u=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),u}(r);throw Re("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.pu=!1,r))));return this.bu=t,t}enqueueAfterDelay(e,t,r){this.Du(),this.wu.indexOf(e)>-1&&(t=0);let i=lm.createAndSchedule(this,e,t,r,s=>this.Fu(s));return this.fu.push(i),i}Du(){this.gu&&q()}verifyOperationInProgress(){}Mu(){return R(this,null,function*(){let e;do e=this.bu,yield e;while(e!==this.bu)})}xu(e){for(let t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){let t=this.fu.indexOf(e);this.fu.splice(t,1)}};function bm(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Cm=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ze,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var NI=-1,Ae=class extends yi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Ih,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return R(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Ih(e),this._firestoreClient=void 0,yield e}})}};function Qe(n){if(n._terminated)throw new x(M.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||kI(n),n._firestoreClient}function kI(n){var e,t,r;let i=n._freezeSettings(),s=function(u,c,l,f){return new Yp(u,c,l,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,CI(f.experimentalLongPollingOptions),f.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Am(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(u){let c=u?._online.build();return{_offline:u?._offline.build(c),_online:c}}(n._componentsProvider))}function xI(n,e){zt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return OI(n,_y.provider,{build:r=>new Th(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function FI(n){return R(this,null,function*(){zt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();OI(n,_y.provider,{build:t=>new Em(t,e.cacheSizeBytes)})})}function OI(n,e,t){if((n=ce(n,Ae))._firestoreClient||n._terminated)throw new x(M.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new x(M.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},kI(n)}function VI(n){if(n._initialized&&!n._terminated)throw new x(M.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ze;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>R(this,null,function*(){try{yield function(r){return R(this,null,function*(){if(!mr.D())return Promise.resolve();let i=r+tI;yield mr.delete(i)})}(iy(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function LI(n){return function(t){let r=new ze;return t.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return kN(yield Ey(t),r)})),r.promise}(Qe(n=ce(n,Ae)))}function UI(n){return HN(Qe(n=ce(n,Ae)))}function BI(n){return WN(Qe(n=ce(n,Ae)))}function jI(n,e){let t=Qe(n=ce(n,Ae)),r=new Cm;return ZN(t,n._databaseId,e,r),r}function $I(n,e){return XN(Qe(n=ce(n,Ae)),e).then(t=>t?new Ke(n,null,t.query):null)}var pn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ne.fromBase64String(e))}catch(t){throw new x(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ne.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Wt=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ln=class{constructor(e){this._methodName=e}};var _i=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var ou=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var JN=/^__.*__$/,Sm=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ht(e,this.data,this.fieldMask,t,this.fieldTransforms):new Tr(e,this.data,t,this.fieldTransforms)}},Ah=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ht(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function zI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}var bh=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Bu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:r,Qu:!1});return i.$u(e),i}Uu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.ku({path:r,Qu:!1});return i.Bu(),i}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return Ch(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(zI(this.Lu)&&JN.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}},Rm=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||pu(e)}ju(e,t,r,i=!1){return new bh({Lu:e,methodName:t,zu:r,path:Pe.emptyPath(),Qu:!1,Gu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Ei(n){let e=n._freezeSettings(),t=pu(n._databaseId);return new Rm(n._databaseId,!!e.ignoreUndefinedProperties,t)}function zh(n,e,t,r,i,s={}){let o=n.ju(s.merge||s.mergeFields?2:0,e,t,i);Ry("Data must be an object, but it was:",o,r);let u=HI(r,o),c,l;if(s.merge)c=new Ct(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let f=[];for(let p of s.mergeFields){let m=xm(e,p,t);if(!o.contains(m))throw new x(M.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);KI(f,m)||f.push(m)}c=new Ct(f),l=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,l=o.fieldTransforms;return new Sm(new st(u),c,l)}var au=class n extends Ln{_toFieldTransform(e){if(e.Lu!==2)throw e.Lu===1?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function qI(n,e,t){return new bh({Lu:3,zu:e.settings.zu,methodName:n._methodName,Qu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Pm=class n extends Ln{_toFieldTransform(e){return new fi(e.path,new wr)}isEqual(e){return e instanceof n}},Mm=class n extends Ln{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){let t=qI(this,e,!0),r=this.Hu.map(s=>Ti(s,t)),i=new On(r);return new fi(e.path,i)}isEqual(e){return e instanceof n&&nc(this.Hu,e.Hu)}},Nm=class n extends Ln{constructor(e,t){super(e),this.Hu=t}_toFieldTransform(e){let t=qI(this,e,!0),r=this.Hu.map(s=>Ti(s,t)),i=new Vn(r);return new fi(e.path,i)}isEqual(e){return e instanceof n&&nc(this.Hu,e.Hu)}},km=class n extends Ln{constructor(e,t){super(e),this.Ju=t}_toFieldTransform(e){let t=new Er(e.serializer,AD(e.serializer,this.Ju));return new fi(e.path,t)}isEqual(e){return e instanceof n&&this.Ju===e.Ju}};function Cy(n,e,t,r){let i=n.ju(1,e,t);Ry("Data must be an object, but it was:",i,r);let s=[],o=st.empty();Sr(r,(c,l)=>{let f=Py(e,c,t);l=ue(l);let p=i.Uu(f);if(l instanceof au)s.push(f);else{let m=Ti(l,p);m!=null&&(s.push(f),o.set(f,m))}});let u=new Ct(s);return new Ah(o,u,i.fieldTransforms)}function Sy(n,e,t,r,i,s){let o=n.ju(1,e,t),u=[xm(e,r,t)],c=[i];if(s.length%2!=0)throw new x(M.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)u.push(xm(e,s[m])),c.push(s[m+1]);let l=[],f=st.empty();for(let m=u.length-1;m>=0;--m)if(!KI(l,u[m])){let w=u[m],P=c[m];P=ue(P);let S=o.Uu(w);if(P instanceof au)l.push(w);else{let A=Ti(P,S);A!=null&&(l.push(w),f.set(w,A))}}let p=new Ct(l);return new Ah(f,p,o.fieldTransforms)}function GI(n,e,t,r=!1){return Ti(t,n.ju(r?4:3,e))}function Ti(n,e){if(WI(n=ue(n)))return Ry("Unsupported field value:",e,n),HI(n,e);if(n instanceof Ln)return function(r,i){if(!zI(i.Lu))throw i.Wu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Wu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let u of r){let c=Ti(u,i.Ku(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=ue(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return AD(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ie.fromDate(r);return{timestampValue:Ls(i.serializer,s)}}if(r instanceof Ie){let s=new Ie(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ls(i.serializer,s)}}if(r instanceof _i)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pn)return{bytesValue:xD(i.serializer,r._byteString)};if(r instanceof ye){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ty(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ou)return function(o,u){return{mapValue:{fields:{[Qm]:{stringValue:Ym},[ks]:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw u.Wu("VectorValues must only contain numeric values.");return ey(u.serializer,l)})}}}}}}(r,i);throw i.Wu(`Unsupported field value: ${$h(r)}`)}(n,e)}function HI(n,e){let t={};return nD(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Sr(n,(r,i)=>{let s=Ti(i,e.qu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function WI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ie||n instanceof _i||n instanceof pn||n instanceof ye||n instanceof Ln||n instanceof ou)}function Ry(n,e,t){if(!WI(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=$h(t);throw r==="an object"?e.Wu(n+" a custom object"):e.Wu(n+" "+r)}}function xm(n,e,t){if((e=ue(e))instanceof Wt)return e._internalPath;if(typeof e=="string")return Py(n,e);throw Ch("Field path arguments must be of type string or ",n,!1,void 0,t)}var ek=new RegExp("[~\\*/\\[\\]]");function Py(n,e,t){if(e.search(ek)>=0)throw Ch(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Wt(...e.split("."))._internalPath}catch{throw Ch(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ch(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new x(M.INVALID_ARGUMENT,u+n+c)}function KI(n,e){return n.some(t=>t.isEqual(e))}var vi=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Fm(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(qh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Fm=class extends vi{data(){return super.data()}};function qh(n,e){return typeof e=="string"?Py(n,e):e instanceof Wt?e._internalPath:e._delegate._internalPath}function QI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var uu=class{},wi=class extends uu{};function jn(n,e,...t){let r=[];e instanceof uu&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof Om).length,u=s.filter(c=>c instanceof Sh).length;if(o>1||o>0&&u>0)throw new x(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Sh=class n extends wi{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return sA(e._query,t),new Ke(e.firestore,e.converter,lg(e._query,t))}_parse(e){let t=Ei(e.firestore);return function(s,o,u,c,l,f,p){let m;if(l.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new x(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){LT(p,f);let P=[];for(let S of p)P.push(VT(c,s,S));m={arrayValue:{values:P}}}else m=VT(c,s,p)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||LT(p,f),m=GI(u,o,p,f==="in"||f==="not-in");return se.create(l,f,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function YI(n,e,t){let r=e,i=qh("where",n);return Sh._create(i,r,t)}var Om=class n extends uu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:pe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,u=s.getFlattenedFilters();for(let c of u)sA(o,c),o=lg(o,c)}(e._query,t),new Ke(e.firestore,e.converter,lg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Vm=class n extends wi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new x(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new x(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new hi(s,o)}(e._query,this._field,this._direction);return new Ke(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new qt(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function ZI(n,e="asc"){let t=e,r=qh("orderBy",n);return Vm._create(r,t)}var Rh=class n extends wi{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Ke(e.firestore,e.converter,Hl(e._query,this._limit,this._limitType))}};function XI(n){return SI("limit",n),Rh._create("limit",n,"F")}function JI(n){return SI("limitToLast",n),Rh._create("limitToLast",n,"L")}var Ph=class n extends wi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=iA(e,this.type,this._docOrFields,this._inclusive);return new Ke(e.firestore,e.converter,function(i,s){return new qt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function eA(...n){return Ph._create("startAt",n,!0)}function tA(...n){return Ph._create("startAfter",n,!1)}var Mh=class n extends wi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=iA(e,this.type,this._docOrFields,this._inclusive);return new Ke(e.firestore,e.converter,function(i,s){return new qt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function nA(...n){return Mh._create("endBefore",n,!1)}function rA(...n){return Mh._create("endAt",n,!0)}function iA(n,e,t,r){if(t[0]=ue(t[0]),t[0]instanceof vi)return function(s,o,u,c,l){if(!c)throw new x(M.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${u}().`);let f=[];for(let p of Is(s))if(p.field.isKeyField())f.push(li(o,c.key));else{let m=c.data.field(p.field);if(Oh(m))throw new x(M.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){let w=p.field.canonicalString();throw new x(M.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${w}' (used as the orderBy) does not exist.`)}f.push(m)}return new fn(f,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=Ei(n.firestore);return function(o,u,c,l,f,p){let m=o.explicitOrderBy;if(f.length>m.length)throw new x(M.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let w=[];for(let P=0;P<f.length;P++){let S=f[P];if(m[P].field.isKeyField()){if(typeof S!="string")throw new x(M.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof S}`);if(!Xm(o)&&S.indexOf("/")!==-1)throw new x(M.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${S}' contains a slash.`);let A=o.path.child(ae.fromString(S));if(!B.isDocumentKey(A))throw new x(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${A}' is not because it contains an odd number of segments.`);let j=new B(A);w.push(li(u,j))}else{let A=GI(c,l,S);w.push(A)}}return new fn(w,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function VT(n,e,t){if(typeof(t=ue(t))=="string"){if(t==="")throw new x(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xm(e)&&t.indexOf("/")!==-1)throw new x(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ae.fromString(t));if(!B.isDocumentKey(r))throw new x(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return li(n,new B(r))}if(t instanceof ye)return li(n,t._key);throw new x(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$h(t)}.`)}function LT(n,e){if(!Array.isArray(n)||n.length===0)throw new x(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sA(n,e){let t=function(i,s){for(let o of i)for(let u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new x(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new x(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Ks=class{convertValue(e,t="none"){switch(_r(e)){case 0:return null;case 1:return e.booleanValue;case 2:return we(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Sr(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[ks].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>we(o.doubleValue));return new ou(s)}convertGeoPoint(e){return new _i(we(e.latitude),we(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Vh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(qa(e));default:return null}}convertTimestamp(e){let t=xn(e);return new Ie(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ae.fromString(e);H(GD(r));let i=new yr(r.get(1),r.get(3)),s=new B(r.popFirst(5));return i.isEqual(t)||Re(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Gh(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Lm=class extends Ks{constructor(e){super(),this.firestore=e}convertBytes(e){return new pn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ye(this.firestore,null,t)}};var kn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},xt=class extends vi{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new pr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(qh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},pr=class extends xt{data(e={}){return super.data(e)}},Kt=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new kn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new pr(this._firestore,this._userDataWriter,r.key,r,new kn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{let c=new pr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new kn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let c=new pr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new kn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,f=-1;return u.type!==0&&(l=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),f=o.indexOf(u.doc.key)),{type:tk(u.type),doc:c,oldIndex:l,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function tk(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}function My(n,e){return n instanceof xt&&e instanceof xt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Kt&&e instanceof Kt&&n._firestore===e._firestore&&by(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function oA(n){n=ce(n,ye);let e=ce(n.firestore,Ae);return AI(Qe(e),n._key).then(t=>Fy(e,n,t))}var Un=class extends Ks{constructor(e){super(),this.firestore=e}convertBytes(e){return new pn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ye(this.firestore,null,t)}};function aA(n){n=ce(n,ye);let e=ce(n.firestore,Ae),t=Qe(e),r=new Un(e);return KN(t,n._key).then(i=>new xt(e,r,n._key,i,new kn(i!==null&&i.hasLocalMutations,!0),n.converter))}function uA(n){n=ce(n,ye);let e=ce(n.firestore,Ae);return AI(Qe(e),n._key,{source:"server"}).then(t=>Fy(e,n,t))}function cA(n){n=ce(n,Ke);let e=ce(n.firestore,Ae),t=Qe(e),r=new Un(e);return QI(n._query),bI(t,n._query).then(i=>new Kt(e,r,n,i))}function lA(n){n=ce(n,Ke);let e=ce(n.firestore,Ae),t=Qe(e),r=new Un(e);return QN(t,n._query).then(i=>new Kt(e,r,n,i))}function hA(n){n=ce(n,Ke);let e=ce(n.firestore,Ae),t=Qe(e),r=new Un(e);return bI(t,n._query,{source:"server"}).then(i=>new Kt(e,r,n,i))}function Ny(n,e,t){n=ce(n,ye);let r=ce(n.firestore,Ae),i=Gh(n.converter,e,t);return to(r,[zh(Ei(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Se.none())])}function ky(n,e,t,...r){n=ce(n,ye);let i=ce(n.firestore,Ae),s=Ei(i),o;return o=typeof(e=ue(e))=="string"||e instanceof Wt?Sy(s,"updateDoc",n._key,e,t,r):Cy(s,"updateDoc",n._key,e),to(i,[o.toMutation(n._key,Se.exists(!0))])}function dA(n){return to(ce(n.firestore,Ae),[new Dr(n._key,Se.none())])}function fA(n,e){let t=ce(n.firestore,Ae),r=mu(n),i=Gh(n.converter,e);return to(t,[zh(Ei(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Se.exists(!1))]).then(()=>r)}function xy(n,...e){var t,r,i;n=ue(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||bm(e[o])||(s=e[o],o++);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(bm(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,l,f;if(n instanceof ye)l=ce(n.firestore,Ae),f=Ys(n._key.path),c={next:p=>{e[o]&&e[o](Fy(l,n,p))},error:e[o+1],complete:e[o+2]};else{let p=ce(n,Ke);l=ce(p.firestore,Ae),f=p._query;let m=new Un(l);c={next:w=>{e[o]&&e[o](new Kt(l,m,p,w))},error:e[o+1],complete:e[o+2]},QI(n._query)}return function(m,w,P,S){let A=new Hs(S),j=new su(w,A,P);return m.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return cy(yield Ws(m),j)})),()=>{A.su(),m.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return ly(yield Ws(m),j)}))}}(Qe(l),f,u,c)}function pA(n,e){return YN(Qe(n=ce(n,Ae)),bm(e)?e:{next:e})}function to(n,e){return function(r,i){let s=new ze;return r.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){return RN(yield Ey(r),i,s)})),s.promise}(Qe(n),e)}function Fy(n,e,t){let r=t.docs.get(e._key),i=new Un(n);return new xt(n,i,e._key,r,new kn(t.hasPendingWrites,t.fromCache),e.converter)}var nk={maxAttempts:5};var Nh=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ei(e)}set(e,t,r){this._verifyNotCommitted();let i=dr(e,this._firestore),s=Gh(i.converter,t,r),o=zh(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Se.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=dr(e,this._firestore),o;return o=typeof(t=ue(t))=="string"||t instanceof Wt?Sy(this._dataReader,"WriteBatch.update",s._key,t,r,i):Cy(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Se.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=dr(e,this._firestore);return this._mutations=this._mutations.concat(new Dr(t._key,Se.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new x(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function dr(n,e){if((n=ue(n)).firestore!==e)throw new x(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var Um=class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ei(e)}get(e){let t=dr(e,this._firestore),r=new Lm(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return q();let s=i[0];if(s.isFoundDocument())return new vi(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new vi(this._firestore,r,t._key,null,t.converter);throw q()})}set(e,t,r){let i=dr(e,this._firestore),s=Gh(i.converter,t,r),o=zh(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,t,r,...i){let s=dr(e,this._firestore),o;return o=typeof(t=ue(t))=="string"||t instanceof Wt?Sy(this._dataReader,"Transaction.update",s._key,t,r,i):Cy(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){let t=dr(e,this._firestore);return this._transaction.delete(t._key),this}};var Bm=class extends Um{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=dr(e,this._firestore),r=new Un(this._firestore);return super.get(e).then(i=>new xt(this._firestore,r,t._key,i._document,new kn(!1,!1),t.converter))}};function gA(n,e,t){n=ce(n,Ae);let r=Object.assign(Object.assign({},nk),t);return function(s){if(s.maxAttempts<1)throw new x(M.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,u){let c=new ze;return s.asyncQueue.enqueueAndForget(()=>R(this,null,function*(){let l=yield GN(s);new Im(s.asyncQueue,l,u,o,c).Iu()})),c.promise}(Qe(n),i=>e(new Bm(n,i)),r)}function mA(){return new au("deleteField")}function yA(){return new Pm("serverTimestamp")}function _A(...n){return new Mm("arrayUnion",n)}function vA(...n){return new Nm("arrayRemove",n)}function wA(n){return new km("increment",n)}(function(e,t=!0){(function(i){Qs=i})(oc),$r(new bn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),u=new Ae(new Vp(r.getProvider("auth-internal")),new Bp(o,r.getProvider("app-check-internal")),function(l,f){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new x(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yr(l.options.projectId,f)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Nt(A0,b0,e),Nt(A0,b0,"esm2017")})();var rk="@firebase/firestore-compat",ik="0.3.45";function jy(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new x("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function EA(){if(typeof Uint8Array>"u")throw new x("unimplemented","Uint8Arrays are not available in this environment.")}function TA(){if(!rD())throw new x("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Hh=class n{constructor(e){this._delegate=e}static fromBase64String(e){return TA(),new n(pn.fromBase64String(e))}static fromUint8Array(e){return EA(),new n(pn.fromUint8Array(e))}toBase64(){return TA(),this._delegate.toBase64()}toUint8Array(){return EA(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Oy(n){return sk(n,["next","error","complete"])}function sk(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var Vy=class{enableIndexedDbPersistence(e,t){return xI(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return FI(e._delegate)}clearIndexedDbPersistence(e){return VI(e._delegate)}},Wh=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof yr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&zt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){PI(this._delegate,e,t,r)}enableNetwork(){return UI(this._delegate)}disableNetwork(){return BI(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Dy("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return LI(this._delegate)}onSnapshotsInSync(e){return pA(this._delegate,e)}get app(){if(!this._appCompat)throw new x("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new io(this,Iy(this._delegate,e))}catch(t){throw ft(t,"collection()","Firestore.collection()")}}doc(e){try{return new gn(this,mu(this._delegate,e))}catch(t){throw ft(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new bi(this,MI(this._delegate,e))}catch(t){throw ft(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return gA(this._delegate,t=>e(new Kh(this,t)))}batch(){return Qe(this._delegate),new Qh(new Nh(this._delegate,e=>to(this._delegate,e)))}loadBundle(e){return jI(this._delegate,e)}namedQuery(e){return $I(this._delegate,e).then(t=>t?new bi(this,t):null)}},no=class extends Ks{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hh(new pn(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return gn.forKey(t,this.firestore,null)}};function ok(n){UT(n)}var Kh=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new no(e)}get(e){let t=Di(e);return this._delegate.get(t).then(r=>new Ii(this._firestore,new xt(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=Di(e);return r?(jy("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Di(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Di(e);return this._delegate.delete(t),this}},Qh=class{constructor(e){this._delegate=e}set(e,t,r){let i=Di(e);return r?(jy("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=Di(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=Di(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},ro=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new pr(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ai(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new no(e),t),i.set(t,s)),s}};ro.INSTANCES=new WeakMap;var gn=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new no(e)}static forPath(e,t,r){if(e.length%2!==0)throw new x("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new ye(t._delegate,r,new B(e)))}static forKey(e,t,r){return new n(t,new ye(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new io(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new io(this.firestore,Iy(this._delegate,e))}catch(t){throw ft(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ue(e),e instanceof ye?Ay(this._delegate,e):!1}set(e,t){t=jy("DocumentReference.set",t);try{return t?Ny(this._delegate,e,t):Ny(this._delegate,e)}catch(r){throw ft(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?ky(this._delegate,e):ky(this._delegate,e,t,...r)}catch(i){throw ft(i,"updateDoc()","DocumentReference.update()")}}delete(){return dA(this._delegate)}onSnapshot(...e){let t=DA(e),r=IA(e,i=>new Ii(this.firestore,new xt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return xy(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=aA(this._delegate):e?.source==="server"?t=uA(this._delegate):t=oA(this._delegate),t.then(r=>new Ii(this.firestore,new xt(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(ro.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ft(n,e,t){return n.message=n.message.replace(e,t),n}function DA(n){for(let e of n)if(typeof e=="object"&&!Oy(e))return e;return{}}function IA(n,e){var t,r;let i;return Oy(n[0])?i=n[0]:Oy(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Ii=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new gn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return My(this._delegate,e._delegate)}},Ai=class extends Ii{data(e){let t=this._delegate.data(e);return this._delegate._converter||BT(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},bi=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new no(e)}where(e,t,r){try{return new n(this.firestore,jn(this._delegate,YI(e,t,r)))}catch(i){throw ft(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,jn(this._delegate,ZI(e,t)))}catch(r){throw ft(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,jn(this._delegate,XI(e)))}catch(t){throw ft(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,jn(this._delegate,JI(e)))}catch(t){throw ft(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,jn(this._delegate,eA(...e)))}catch(t){throw ft(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,jn(this._delegate,tA(...e)))}catch(t){throw ft(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,jn(this._delegate,nA(...e)))}catch(t){throw ft(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,jn(this._delegate,rA(...e)))}catch(t){throw ft(t,"endAt()","Query.endAt()")}}isEqual(e){return by(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=lA(this._delegate):e?.source==="server"?t=hA(this._delegate):t=cA(this._delegate),t.then(r=>new yu(this.firestore,new Kt(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=DA(e),r=IA(e,i=>new yu(this.firestore,new Kt(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return xy(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(ro.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Ly=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ai(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},yu=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new bi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ai(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Ly(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Ai(this._firestore,r))})}isEqual(e){return My(this._delegate,e._delegate)}},io=class n extends bi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new gn(this.firestore,e):null}doc(e){try{return e===void 0?new gn(this.firestore,mu(this._delegate)):new gn(this.firestore,mu(this._delegate,e))}catch(t){throw ft(t,"doc()","CollectionReference.doc()")}}add(e){return fA(this._delegate,e).then(t=>new gn(this.firestore,t))}isEqual(e){return Ay(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(ro.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Di(n){return ce(n,ye)}var Uy=class n{constructor(...e){this._delegate=new Wt(...e)}static documentId(){return new n(Pe.keyField().canonicalString())}isEqual(e){return e=ue(e),e instanceof Wt?this._delegate._internalPath.isEqual(e._internalPath):!1}};var By=class n{static serverTimestamp(){let e=yA();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=mA();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=_A(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=vA(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=wA(e);return t._methodName="FieldValue.increment",new n(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}};var ak={Firestore:Wh,GeoPoint:_i,Timestamp:Ie,Blob:Hh,Transaction:Kh,WriteBatch:Qh,DocumentReference:gn,DocumentSnapshot:Ii,Query:bi,QueryDocumentSnapshot:Ai,QuerySnapshot:yu,CollectionReference:io,FieldPath:Uy,FieldValue:By,setLogLevel:ok,CACHE_SIZE_UNLIMITED:NI};function uk(n,e){n.INTERNAL.registerComponent(new bn("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},ak)))}function ck(n){uk(n,(e,t)=>new Wh(e,t,new Vy)),n.registerVersion(rk,ik)}ck(ht);function lk(n,e=Bu){return new Rt(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function AA(n,e){return lk(n,e)}function hk(n,e){return AA(n,e).pipe(ki(void 0),$u(),J(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function qy(n,e){return AA(n,e).pipe(J(t=>({payload:t,type:"query"})))}var Yh=class{ref;afs;injector=L(nt);constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:s}=PA(r,t);return new Xh(i,s,this.afs)}snapshotChanges(){return hk(this.ref,this.afs.schedulers.outsideAngular).pipe(We(this.injector))}valueChanges(e={}){return this.snapshotChanges().pipe(J(({payload:t})=>e.idField?he($({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return de(this.ref.get(e)).pipe(We(this.injector))}};function Zh(n,e){return qy(n,e).pipe(ki(void 0),$u(),J(t=>{let[r,i]=t,s=i.payload.docChanges(),o=s.map(u=>({type:u.type,payload:u}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((u,c)=>{let l=s.find(p=>p.doc.ref.isEqual(u.ref)),f=r?.payload.docs.find(p=>p.ref.isEqual(u.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(u.metadata)||!l&&f&&JSON.stringify(f.metadata)===JSON.stringify(u.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:u}})}),o}))}function bA(n,e,t){return Zh(n,t).pipe(Ni((r,i)=>dk(r,i.map(s=>s.payload),e),[]),gv(),J(r=>r.map(i=>({type:i.type,payload:i}))))}function dk(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=fk(n,r))}),n}function $y(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function fk(n,e){switch(e.type){case"added":if(!n[e.newIndex]?.doc.ref.isEqual(e.doc.ref))return $y(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return $y(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]?.doc.ref.isEqual(e.doc.ref))return $y(n,e.oldIndex,1);break}return n}function CA(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var Xh=class{ref;query;afs;injector=L(nt);constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Zh(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(J(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(ki(void 0),$u(),lt(([r,i])=>i.length>0||!r),J(([,r])=>r),We(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(Ni((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=CA(e);return bA(this.query,t,this.afs.schedulers.outsideAngular).pipe(We(this.injector))}valueChanges(e={}){return qy(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.payload.docs.map(r=>e.idField?he($({},r.data()),{[e.idField]:r.id}):r.data())),We(this.injector))}get(e){return de(this.query.get(e)).pipe(We(this.injector))}add(e){return this.ref.add(e)}doc(e){return new Yh(this.ref.doc(e),this.afs)}},zy=class{query;afs;injector=L(nt);constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Zh(this.query,this.afs.schedulers.outsideAngular).pipe(We(this.injector)):Zh(this.query,this.afs.schedulers.outsideAngular).pipe(J(t=>t.filter(r=>e.indexOf(r.type)>-1)),lt(t=>t.length>0),We(this.injector))}auditTrail(e){return this.stateChanges(e).pipe(Ni((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=CA(e);return bA(this.query,t,this.afs.schedulers.outsideAngular).pipe(We(this.injector))}valueChanges(e={}){return qy(this.query,this.afs.schedulers.outsideAngular).pipe(J(r=>r.payload.docs.map(i=>e.idField?$({[e.idField]:i.id},i.data()):i.data())),We(this.injector))}get(e){return de(this.query.get(e)).pipe(We(this.injector))}},SA=new Q("angularfire2.enableFirestorePersistence"),RA=new Q("angularfire2.firestore.persistenceSettings"),pk=new Q("angularfire2.firestore.settings"),gk=new Q("angularfire2.firestore.use-emulator");function PA(n,e=t=>t){return{query:e(n),ref:n}}var _u=(()=>{class n{schedulers;firestore;persistenceEnabled$;ngZone=L(De);constructor(t,r,i,s,o,u,c,l,f,p,m,w,P,S,A,j,G){this.schedulers=c;let k=Ia(t,u,r),z=f;p&&wp(k,u,m,P,S,A,w,j),[this.firestore,this.persistenceEnabled$]=pl(`${k.name}.firestore`,"AngularFirestore",k.name,()=>{let Z=u.runOutsideAngular(()=>k.firestore());if(s&&Z.settings(s),z&&Z.useEmulator(...z),i&&!Jn(o)){let X=()=>{try{return de(Z.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(E){return typeof console<"u"&&console.warn(E),W(!1)}};return[Z,u.runOutsideAngular(X)]}else return[Z,W(!1)]},[s,z,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:o}=PA(i,r),u=this.ngZone.run(()=>s);return new Xh(u,o,this)}collectionGroup(t,r){let i=r||(o=>o),s=this.firestore.collectionGroup(t);return new zy(i(s),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.ngZone.run(()=>r);return new Yh(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(O(us),O(cs,8),O(SA,8),O(pk,8),O(gt),O(De),O(Xr),O(RA,8),O(gk,8),O(Ep,8),O(pp,8),O(gp,8),O(mp,8),O(yp,8),O(_p,8),O(vp,8),O(as,8))};static \u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),G2=(()=>{class n{constructor(){ht.registerVersion("angularfire",Rn.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:SA,useValue:!0},{provide:RA,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Ue({type:n});static \u0275inj=Le({providers:[_u]})}return n})();var NA=(()=>{class n{constructor(t){this.firestore=t}setCollection(t){this.collection=this.firestore.collection(t)}getDocuments(){if(!this.collection)throw new Error("Collection path not set.");return this.collection.snapshotChanges().pipe(J(t=>t.map(r=>{let i=r.payload.doc.data(),s=r.payload.doc.id;return he($({},i),{id:s})})),Ge(t=>{throw console.error("Error obtaining data from Firestore:",t),t}))}addDocument(t){return de(this.collection.add(t)).pipe(Te(r=>this.collection.doc(r.id).valueChanges()))}updateDocument(t,r){return de(this.collection.doc(t).update(r)).pipe(Ge(i=>{throw console.error("Error updating document in Firestore:",i),i}))}deleteDocument(t){return de(this.collection.doc(t).delete()).pipe(Ge(r=>{throw console.error("Error deleting document from Firestore:",r),r}))}getDocumentById(t){return this.collection.doc(t).get().pipe(Te(r=>{if(r.exists){let i=r.data();return W(i)}else return console.error("Document with provided ID does not exist:",t),W(void 0)}),Ge(r=>{throw console.error("Error getting document by ID:",r),r}))}static{this.\u0275fac=function(r){return new(r||n)(O(_u))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function mk(n,e){if(n&1){let t=Uv();Ot(0,"div",8),An("click",function(){let i=Tv(t).$implicit,s=Bv();return Dv(s.realizarAccion(i.label,i.value))}),Ot(1,"div",9),Ur(2,"img",10),In(),Ot(3,"span",11),Vo(4),In()()}if(n&2){let t=e.$implicit;Hu(2),Yd("src",t.icon,Rv),Hu(2),qv(t.value)}}var X2=(()=>{class n{constructor(t){this.firestore=t,this.personalInformation=[],this.firestoreService=new NA(this.firestore),this.firestoreService.setCollection("contact-Information")}ngOnInit(){this.firestoreService.getDocuments().subscribe({next:t=>{this.personalInformation=t},error:t=>{console.error("Error loading projects:",t)}})}realizarAccion(t,r){switch(t){case"phone":window.location.href=`tel:+${r}`;break;case"whatsapp":window.open("https://web.whatsapp.com/","_blank");break;case"email":window.location.href=`mailto:${r}`;break}}static{this.\u0275fac=function(r){return new(r||n)(ie(_u))}}static{this.\u0275cmp=Vi({type:n,selectors:[["shared-contact-information"]],standalone:!1,decls:9,vars:1,consts:[[1,"bg-gray-700","rounded-lg","overflow-hidden","transition-all","duration-200","group","relative"],[1,"p-4"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-lg","font-semibold","text-blue-400"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4","text-gray-400","group-hover:text-blue-400","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"space-y-3"],["class","flex items-center p-2 rounded hover:bg-gray-600 transition-colors cursor-pointer",3,"click",4,"ngFor","ngForOf"],[1,"flex","items-center","p-2","rounded","hover:bg-gray-600","transition-colors","cursor-pointer",3,"click"],[1,"h-8","w-8","mr-3","bg-gray-600","p-1.5","rounded-lg","flex","items-center","justify-center"],["alt","",1,"h-full","w-full","object-contain",3,"src"],[1,"text-sm","text-gray-300"]],template:function(r,i){r&1&&(Ot(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),Vo(4,"Informaci\xF3n de Contacto"),In(),zu(),Ot(5,"svg",4),Ur(6,"path",5),In()(),qu(),Ot(7,"div",6),xv(8,mk,5,2,"div",7),In()()()),r&2&&(Hu(8),Yd("ngForOf",i.personalInformation))},dependencies:[fc],encapsulation:2})}}return n})();var jA="firebasestorage.googleapis.com",$A="storageBucket",yk=2*60*1e3,_k=10*60*1e3,vk=1e3;var be=class n extends tc{constructor(e,t,r=0){super(Gy(e),`Firebase Storage: ${t} (${Gy(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Gy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Ee=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(Ee||{});function Gy(n){return"storage/"+n}function t_(){let n="An unknown error occurred, please check the error payload for server response.";return new be(Ee.UNKNOWN,n)}function wk(n){return new be(Ee.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function Ek(n){return new be(Ee.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Tk(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new be(Ee.UNAUTHENTICATED,n)}function Dk(){return new be(Ee.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Ik(n){return new be(Ee.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function zA(){return new be(Ee.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function qA(){return new be(Ee.CANCELED,"User canceled the upload/download.")}function Ak(n){return new be(Ee.INVALID_URL,"Invalid URL '"+n+"'.")}function bk(n){return new be(Ee.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Ck(){return new be(Ee.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+$A+"' property when initializing the app?")}function GA(){return new be(Ee.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Sk(){return new be(Ee.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function Rk(){return new be(Ee.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Pk(n){return new be(Ee.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Wy(n){return new be(Ee.INVALID_ARGUMENT,n)}function HA(){return new be(Ee.APP_DELETED,"The Firebase app was deleted.")}function Mk(n){return new be(Ee.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wu(n,e){return new be(Ee.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function vu(n){throw new be(Ee.INTERNAL_ERROR,"Internal error: "+n)}var St=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw bk(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}let o="(/(.*))?$",u=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(z){z.path_=decodeURIComponent(z.path)}let f="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",w=new RegExp(`^https?://${p}/${f}/b/${i}/o${m}`,"i"),P={bucket:1,path:3},S=t===jA?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",j=new RegExp(`^https?://${S}/${i}/${A}`,"i"),k=[{regex:u,indices:c,postModify:s},{regex:w,indices:P,postModify:l},{regex:j,indices:{bucket:1,path:2},postModify:l}];for(let z=0;z<k.length;z++){let Z=k[z],X=Z.regex.exec(e);if(X){let E=X[Z.indices.bucket],y=X[Z.indices.path];y||(y=""),r=new n(E,y),Z.postModify(r);break}}if(r==null)throw Ak(e);return r}},Ky=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function Nk(n,e,t){let r=1,i=null,s=null,o=!1,u=0;function c(){return u===2}let l=!1;function f(...A){l||(l=!0,e.apply(null,A))}function p(A){i=setTimeout(()=>{i=null,n(w,c())},A)}function m(){s&&clearTimeout(s)}function w(A,...j){if(l){m();return}if(A){m(),f.call(null,A,...j);return}if(c()||o){m(),f.call(null,A,...j);return}r<64&&(r*=2);let k;u===1?(u=2,k=0):k=(r+Math.random())*1e3,p(k)}let P=!1;function S(A){P||(P=!0,m(),!l&&(i!==null?(A||(u=2),clearTimeout(i),p(0)):A||(u=1)))}return p(0),s=setTimeout(()=>{o=!0,S(!0)},t),S}function kk(n){n(!1)}function xk(n){return n!==void 0}function Fk(n){return typeof n=="function"}function Ok(n){return typeof n=="object"&&!Array.isArray(n)}function nd(n){return typeof n=="string"||n instanceof String}function kA(n){return n_()&&n instanceof Blob}function n_(){return typeof Blob<"u"}function Qy(n,e,t,r){if(r<e)throw Wy(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Wy(`Invalid value for '${n}'. Expected ${t} or less.`)}function Mr(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function WA(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var ao=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(ao||{});function KA(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var Yy=class{constructor(e,t,r,i,s,o,u,c,l,f,p,m=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=u,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=f,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((w,P)=>{this.resolve_=w,this.reject_=P,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new oo(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=u=>{let c=u.loaded,l=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let u=s.getErrorCode()===ao.NO_ERROR,c=s.getStatus();if(!u||KA(c,this.additionalRetryCodes_)&&this.retry){let f=s.getErrorCode()===ao.ABORT;r(!1,new oo(!1,null,f));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new oo(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,u=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(u,u.getResponse());xk(c)?s(c):s()}catch(c){o(c)}else if(u!==null){let c=t_();c.serverResponse=u.getErrorText(),this.errorCallback_?o(this.errorCallback_(u,c)):o(c)}else if(i.canceled){let c=this.appDelete_?HA():qA();o(c)}else{let c=zA();o(c)}};this.canceled_?t(!1,new oo(!1,null,!0)):this.backoffId_=Nk(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&kk(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},oo=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function Vk(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Lk(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Uk(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Bk(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function jk(n,e,t,r,i,s,o=!0){let u=WA(n.urlParams),c=n.url+u,l=Object.assign({},n.headers);return Uk(l,e),Vk(l,t),Lk(l,s),Bk(l,r),new Yy(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function $k(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function zk(...n){let e=$k();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(n_())return new Blob(n);throw new be(Ee.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function qk(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function Gk(n){if(typeof atob>"u")throw Pk("base-64");return atob(n)}var yn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Eu=class{constructor(e,t){this.data=e,this.contentType=t||null}};function Hk(n,e){switch(n){case yn.RAW:return new Eu(QA(e));case yn.BASE64:case yn.BASE64URL:return new Eu(YA(n,e));case yn.DATA_URL:return new Eu(Kk(e),Qk(e))}throw t_()}function QA(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function Wk(n){let e;try{e=decodeURIComponent(n)}catch{throw wu(yn.DATA_URL,"Malformed data URL.")}return QA(e)}function YA(n,e){switch(n){case yn.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw wu(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case yn.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw wu(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Gk(e)}catch(i){throw i.message.includes("polyfill")?i:wu(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var ed=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw wu(yn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=Yk(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function Kk(n){let e=new ed(n);return e.base64?YA(yn.BASE64,e.rest):Wk(e.rest)}function Qk(n){return new ed(n).contentType}function Yk(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var td=class n{constructor(e,t){let r=0,i="";kA(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(kA(this.data_)){let r=this.data_,i=qk(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(n_()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(zk.apply(null,t))}else{let t=e.map(o=>nd(o)?Hk(yn.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let u=0;u<o.length;u++)i[s++]=o[u]}),new n(i,!0)}}uploadData(){return this.data_}};function r_(n){let e;try{e=JSON.parse(n)}catch{return null}return Ok(e)?e:null}function Zk(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Xk(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function ZA(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function Jk(n,e){return e}var Ye=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||Jk}},Jh=null;function e1(n){return!nd(n)||n.length<2?n:ZA(n)}function rd(){if(Jh)return Jh;let n=[];n.push(new Ye("bucket")),n.push(new Ye("generation")),n.push(new Ye("metageneration")),n.push(new Ye("name","fullPath",!0));function e(s,o){return e1(o)}let t=new Ye("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new Ye("size");return i.xform=r,n.push(i),n.push(new Ye("timeCreated")),n.push(new Ye("updated")),n.push(new Ye("md5Hash",null,!0)),n.push(new Ye("cacheControl",null,!0)),n.push(new Ye("contentDisposition",null,!0)),n.push(new Ye("contentEncoding",null,!0)),n.push(new Ye("contentLanguage",null,!0)),n.push(new Ye("contentType",null,!0)),n.push(new Ye("metadata","customMetadata",!0)),Jh=n,Jh}function t1(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new St(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function n1(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return t1(r,n),r}function XA(n,e,t){let r=r_(e);return r===null?null:n1(n,r,t)}function r1(n,e,t,r){let i=r_(e);if(i===null||!nd(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let f=n.bucket,p=n.fullPath,m="/b/"+o(f)+"/o/"+o(p),w=Mr(m,t,r),P=WA({alt:"media",token:l});return w+P})[0]}function i_(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var xA="prefixes",FA="items";function i1(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[xA])for(let i of t[xA]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new St(e,s));r.prefixes.push(o)}if(t[FA])for(let i of t[FA]){let s=n._makeStorageReference(new St(e,i.name));r.items.push(s)}return r}function s1(n,e,t){let r=r_(t);return r===null?null:i1(n,e,r)}var Qt=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function _n(n){if(!n)throw t_()}function id(n,e){function t(r,i){let s=XA(n,i,e);return _n(s!==null),s}return t}function o1(n,e){function t(r,i){let s=s1(n,e,i);return _n(s!==null),s}return t}function a1(n,e){function t(r,i){let s=XA(n,i,e);return _n(s!==null),r1(s,i,n.host,n._protocol)}return t}function lo(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=Dk():i=Tk():t.getStatus()===402?i=Ek(n.bucket):t.getStatus()===403?i=Ik(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function sd(n){let e=lo(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=wk(n.path)),s.serverResponse=i.serverResponse,s}return t}function JA(n,e,t){let r=e.fullServerUrl(),i=Mr(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,u=new Qt(i,s,id(n,t),o);return u.errorHandler=sd(e),u}function u1(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),u=Mr(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,f=new Qt(u,c,o1(n,e.bucket),l);return f.urlParams=s,f.errorHandler=lo(e),f}function c1(n,e,t){let r=e.fullServerUrl(),i=Mr(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,u=new Qt(i,s,a1(n,t),o);return u.errorHandler=sd(e),u}function l1(n,e,t,r){let i=e.fullServerUrl(),s=Mr(i,n.host,n._protocol),o="PATCH",u=i_(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,f=new Qt(s,o,id(n,r),l);return f.headers=c,f.body=u,f.errorHandler=sd(e),f}function h1(n,e){let t=e.fullServerUrl(),r=Mr(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let u=new Qt(r,i,o,s);return u.successCodes=[200,204],u.errorHandler=sd(e),u}function d1(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function eb(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=d1(null,e)),r}function f1(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function u(){let k="";for(let z=0;z<2;z++)k=k+Math.random().toString().slice(2);return k}let c=u();o["Content-Type"]="multipart/related; boundary="+c;let l=eb(e,r,i),f=i_(l,t),p="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+f+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,m=`\r
--`+c+"--",w=td.getBlob(p,r,m);if(w===null)throw GA();let P={name:l.fullPath},S=Mr(s,n.host,n._protocol),A="POST",j=n.maxUploadRetryTime,G=new Qt(S,A,id(n,t),j);return G.urlParams=P,G.headers=o,G.body=w.uploadData(),G.errorHandler=lo(e),G}var uo=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function s_(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{_n(!1)}return _n(!!t&&(e||["active"]).indexOf(t)!==-1),t}function p1(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=eb(e,r,i),u={name:o.fullPath},c=Mr(s,n.host,n._protocol),l="POST",f={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},p=i_(o,t),m=n.maxUploadRetryTime;function w(S){s_(S);let A;try{A=S.getResponseHeader("X-Goog-Upload-URL")}catch{_n(!1)}return _n(nd(A)),A}let P=new Qt(c,l,w,m);return P.urlParams=u,P.headers=f,P.body=p,P.errorHandler=lo(e),P}function g1(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let f=s_(l,["active","final"]),p=null;try{p=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{_n(!1)}p||_n(!1);let m=Number(p);return _n(!isNaN(m)),new uo(m,r.size(),f==="final")}let o="POST",u=n.maxUploadRetryTime,c=new Qt(t,o,s,u);return c.headers=i,c.errorHandler=lo(e),c}var OA=256*1024;function m1(n,e,t,r,i,s,o,u){let c=new uo(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw Sk();let l=c.total-c.current,f=l;i>0&&(f=Math.min(f,i));let p=c.current,m=p+f,w="";f===0?w="finalize":l===f?w="upload, finalize":w="upload";let P={"X-Goog-Upload-Command":w,"X-Goog-Upload-Offset":`${c.current}`},S=r.slice(p,m);if(S===null)throw GA();function A(z,Z){let X=s_(z,["active","final"]),E=c.current+f,y=r.size(),v;return X==="final"?v=id(e,s)(z,Z):v=null,new uo(E,y,X==="final",v)}let j="POST",G=e.maxUploadRetryTime,k=new Qt(t,j,A,G);return k.headers=P,k.body=S.uploadData(),k.progressCallback=u||null,k.errorHandler=lo(n),k}var rU={STATE_CHANGED:"state_changed"},vt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Hy(n){switch(n){case"running":case"pausing":case"canceling":return vt.RUNNING;case"paused":return vt.PAUSED;case"success":return vt.SUCCESS;case"canceled":return vt.CANCELED;case"error":return vt.ERROR;default:return vt.ERROR}}var Zy=class{constructor(e,t,r){if(Fk(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function so(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var VA=null,Xy=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ao.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ao.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ao.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw vu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw vu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw vu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw vu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw vu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},Jy=class extends Xy{initXhr(){this.xhr_.responseType="text"}};function mn(){return VA?VA():new Jy}var e_=class{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=rd(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(Ee.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(KA(i.status,[]))if(s)i=zA();else{this.sleepTime=Math.max(this.sleepTime*2,vk),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(Ee.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=p1(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,mn,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=g1(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,mn,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=OA*this._chunkMultiplier,t=new uo(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=m1(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let u=this._ref.storage._makeRequest(o,mn,i,s,!1);this._request=u,u.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){OA*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=JA(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,mn,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=f1(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,mn,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=qA(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=Hy(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new Zy(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Hy(this._state)){case vt.SUCCESS:so(this._resolve.bind(null,this.snapshot))();break;case vt.CANCELED:case vt.ERROR:let t=this._reject;so(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Hy(this._state)){case vt.RUNNING:case vt.PAUSED:e.next&&so(e.next.bind(e,this.snapshot))();break;case vt.SUCCESS:e.complete&&so(e.complete.bind(e))();break;case vt.CANCELED:case vt.ERROR:e.error&&so(e.error.bind(e,this._error))();break;default:e.error&&so(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var co=class n{constructor(e,t){this._service=e,t instanceof St?this._location=t:this._location=St.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new St(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return ZA(this._location.path)}get storage(){return this._service}get parent(){let e=Zk(this._location.path);if(e===null)return null;let t=new St(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Mk(e)}};function y1(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new e_(n,new td(e),t)}function _1(n){let e={prefixes:[],items:[]};return tb(n,e).then(()=>e)}function tb(n,e,t){return R(this,null,function*(){let i=yield nb(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield tb(n,e,i.nextPageToken))})}function nb(n,e){e!=null&&typeof e.maxResults=="number"&&Qy("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=u1(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,mn)}function v1(n){n._throwIfRoot("getMetadata");let e=JA(n.storage,n._location,rd());return n.storage.makeRequestWithTokens(e,mn)}function w1(n,e){n._throwIfRoot("updateMetadata");let t=l1(n.storage,n._location,e,rd());return n.storage.makeRequestWithTokens(t,mn)}function E1(n){n._throwIfRoot("getDownloadURL");let e=c1(n.storage,n._location,rd());return n.storage.makeRequestWithTokens(e,mn).then(t=>{if(t===null)throw Rk();return t})}function T1(n){n._throwIfRoot("deleteObject");let e=h1(n.storage,n._location);return n.storage.makeRequestWithTokens(e,mn)}function rb(n,e){let t=Xk(n._location.path,e),r=new St(n._location.bucket,t);return new co(n.storage,r)}function D1(n){return/^[A-Za-z]+:\/\//.test(n)}function I1(n,e){return new co(n,e)}function ib(n,e){if(n instanceof Tu){let t=n;if(t._bucket==null)throw Ck();let r=new co(t,t._bucket);return e!=null?ib(r,e):r}else return e!==void 0?rb(n,e):n}function A1(n,e){if(e&&D1(e)){if(n instanceof Tu)return I1(n,e);throw Wy("To use ref(service, url), the first argument must be a Storage instance.")}else return ib(n,e)}function LA(n,e){let t=e?.[$A];return t==null?null:St.makeFromBucketSpec(t,n)}function b1(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:Ju(i,n.app.options.projectId))}var Tu=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=jA,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=yk,this._maxUploadRetryTime=_k,this._requests=new Set,i!=null?this._bucket=St.makeFromBucketSpec(i,this._host):this._bucket=LA(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=St.makeFromBucketSpec(this._url,e):this._bucket=LA(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Qy("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Qy("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return R(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return R(this,null,function*(){if(sc(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new co(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new Ky(HA());{let o=jk(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return R(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},UA="@firebase/storage",BA="0.13.7";var sb="storage";function C1(n,e,t){return n=ue(n),y1(n,e,t)}function S1(n){return n=ue(n),v1(n)}function R1(n,e){return n=ue(n),w1(n,e)}function P1(n,e){return n=ue(n),nb(n,e)}function M1(n){return n=ue(n),_1(n)}function ob(n){return n=ue(n),E1(n)}function N1(n){return n=ue(n),T1(n)}function ab(n,e){return n=ue(n),A1(n,e)}function iU(n,e){return rb(n,e)}function ub(n=ac(),e){n=ue(n);let r=ic(n,sb).getImmediate({identifier:e}),i=Xd("storage");return i&&cb(r,...i),r}function cb(n,e,t,r={}){b1(n,e,t,r)}function k1(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Tu(t,r,i,e,oc)}function x1(){$r(new bn(sb,k1,"PUBLIC").setMultipleInstances(!0)),Nt(UA,BA,""),Nt(UA,BA,"esm2017")}x1();var lb=Ea(ob,!0);var hb=Ea(ub,!0);var db=Ea(ab,!0,2);var fb=(()=>{class n{constructor(){this.storage=hb()}getFileUrl(t){return R(this,null,function*(){let r=db(this.storage,t);try{return yield lb(r)}catch(i){throw console.error(`Archivo no encontrado: ${t}`,i),new Error("Archivo no encontrado")}})}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var EU=(()=>{class n{constructor(t){this.storageService=t}downloadPDF(){return R(this,null,function*(){let t=yield this.storageService.getFileUrl("portfolio/cv/cv_max_poblete.pdf"),r=document.createElement("a");r.href=t,r.target="_blank";let i=new Date().toISOString().split("T")[0];r.download=`cv_max_poblete_${i}.pdf`,document.body.appendChild(r),r.click(),document.body.removeChild(r)})}static{this.\u0275fac=function(r){return new(r||n)(ie(fb))}}static{this.\u0275cmp=Vi({type:n,selectors:[["app-download-cv"]],standalone:!1,decls:5,vars:0,consts:[[1,"w-full","flex","items-center","justify-center","gap-2","bg-gray-600","hover:bg-gray-500","text-blue-400","py-2","px-4","rounded-lg","transition-colors","mb-6",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"]],template:function(r,i){r&1&&(Ot(0,"button",0),An("click",function(){return i.downloadPDF()}),zu(),Ot(1,"svg",1),Ur(2,"path",2),In(),qu(),Ot(3,"span"),Vo(4,"Descargar CV"),In()())},styles:[".btn-download[_ngcontent-%COMP%]{background-color:#124670;color:#fff;font-size:16px;font-weight:700;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;display:flex;align-items:center;gap:8px;transition:background .3s;margin:22px}.btn-download[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px}.btn-download[_ngcontent-%COMP%]:hover{background-color:#125185}"]})}}return n})();var kU=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=Ue({type:n})}static{this.\u0275inj=Le({imports:[$o,op,cE]})}}return n})();var pb=(()=>{class n{constructor(t,r){this.http=t,this.apiUrl=r}create(t){let r=new Ut({"Content-Type":"application/json"});return this.http.post(this.apiUrl,t,{headers:r}).pipe(Ge(this.handleError))}getAll(){return this.http.get(this.apiUrl).pipe(Ge(this.handleError))}getById(t){return this.http.get(`${this.apiUrl}/${t}`).pipe(Ge(this.handleError))}update(t,r){let i=new Ut({"Content-Type":"application/json"});return this.http.put(`${this.apiUrl}/${t}`,r,{headers:i}).pipe(Ge(this.handleError))}delete(t){return this.http.delete(`${this.apiUrl}/${t}`).pipe(Ge(this.handleError))}handleError(t){return console.error("An error occurred:",t),Vr(()=>new Error("Something bad happened; please try again later."))}static{this.\u0275fac=function(r){return new(r||n)(O(zi),O("API_URL"))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var BU=(()=>{class n extends pb{constructor(t,r){super(t,r)}static{this.\u0275fac=function(r){return new(r||n)(O(zi),O("PERSONAL_API_URL"))}}static{this.\u0275prov=K({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{ke as a,fc as b,Xb as c,$o as d,ff as e,mC as f,vC as g,zi as h,$C as i,zC as j,Sn as k,Yf as l,sn as m,ll as n,tP as o,op as p,pb as q,Ie as r,qw as s,kw as t,JO as u,eV as v,nV as w,ES as x,DS as y,bS as z,rV as A,cE as B,We as C,Rn as D,Xr as E,as as F,us as G,cs as H,Ia as I,WL as J,pl as K,c2 as L,_u as M,G2 as N,NA as O,X2 as P,BU as Q,Wy as R,Mk as S,St as T,yn as U,Hk as V,td as W,rU as X,vt as Y,e_ as Z,C1 as _,S1 as $,R1 as aa,P1 as ba,M1 as ca,ob as da,N1 as ea,ab as fa,iU as ga,cb as ha,EU as ia,kU as ja};
